<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Superlova</title>
  
  <subtitle>Welcome...</subtitle>
  <link href="https://superlova.github.io/atom.xml" rel="self"/>
  
  <link href="https://superlova.github.io/"/>
  <updated>2022-11-27T18:20:04.759Z</updated>
  <id>https://superlova.github.io/</id>
  
  <author>
    <name>Superlova</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘é€šè¿‡æ–‡å­—æ£€ç´¢è§†é¢‘ç‰‡æ®µï¼šVCEDä¹‹æ‹“å±•ä¼˜åŒ–</title>
    <link href="https://superlova.github.io/2022/11/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E4%B9%8B%E6%8B%93%E5%B1%95%E4%BC%98%E5%8C%96/"/>
    <id>https://superlova.github.io/2022/11/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E4%B9%8B%E6%8B%93%E5%B1%95%E4%BC%98%E5%8C%96/</id>
    <published>2022-11-27T15:36:31.000Z</published>
    <updated>2022-11-27T18:20:04.759Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« æ˜¯è·¨æ¨¡æ€æ£€ç´¢å·¥å…· VCED ä»‹ç»çš„ç¬¬å…­ç¯‡ã€‚ä»‹ç»å®Œ VCED çš„æ ¸å¿ƒæœºåˆ¶ä¸å‰åç«¯ï¼Œæœ¬æ¬¡è®°å½•ä¸‹å¯ä»¥ä¼˜åŒ–çš„ç‚¹ã€‚</p><!--more---><h2 id="1-ç›®å‰å‘é‡æ£€ç´¢ä½¿ç”¨çš„æ˜¯æœ€ç®€å•çš„æš´åŠ›æœç´¢ï¼Œæ‰€ä»¥å‘é‡æ£€ç´¢èŠ±è´¹çš„æ—¶é—´å¾ˆæ…¢ï¼Œè¿™é‡Œå¯ä»¥ä¼˜åŒ–æˆä»¥-Faiss-å®ç°çš„é«˜æ€§èƒ½æ£€ç´¢åº“ï¼›"><a href="#1-ç›®å‰å‘é‡æ£€ç´¢ä½¿ç”¨çš„æ˜¯æœ€ç®€å•çš„æš´åŠ›æœç´¢ï¼Œæ‰€ä»¥å‘é‡æ£€ç´¢èŠ±è´¹çš„æ—¶é—´å¾ˆæ…¢ï¼Œè¿™é‡Œå¯ä»¥ä¼˜åŒ–æˆä»¥-Faiss-å®ç°çš„é«˜æ€§èƒ½æ£€ç´¢åº“ï¼›" class="headerlink" title="1. ç›®å‰å‘é‡æ£€ç´¢ä½¿ç”¨çš„æ˜¯æœ€ç®€å•çš„æš´åŠ›æœç´¢ï¼Œæ‰€ä»¥å‘é‡æ£€ç´¢èŠ±è´¹çš„æ—¶é—´å¾ˆæ…¢ï¼Œè¿™é‡Œå¯ä»¥ä¼˜åŒ–æˆä»¥ Faiss å®ç°çš„é«˜æ€§èƒ½æ£€ç´¢åº“ï¼›"></a>1. ç›®å‰å‘é‡æ£€ç´¢ä½¿ç”¨çš„æ˜¯æœ€ç®€å•çš„æš´åŠ›æœç´¢ï¼Œæ‰€ä»¥å‘é‡æ£€ç´¢èŠ±è´¹çš„æ—¶é—´å¾ˆæ…¢ï¼Œè¿™é‡Œå¯ä»¥ä¼˜åŒ–æˆä»¥ Faiss å®ç°çš„é«˜æ€§èƒ½æ£€ç´¢åº“ï¼›</h2><p>Faissæ˜¯Facebook AIå›¢é˜Ÿå¼€æºçš„é’ˆå¯¹èšç±»å’Œç›¸ä¼¼æ€§æœç´¢åº“ï¼Œä¸ºç¨ å¯†å‘é‡æä¾›é«˜æ•ˆç›¸ä¼¼åº¦æœç´¢å’Œèšç±»ï¼Œæ”¯æŒåäº¿çº§åˆ«å‘é‡çš„æœç´¢ã€‚Faissç”¨C++ç¼–å†™ï¼Œå¹¶æä¾› Numpy é£æ ¼çš„ Python æ¥å£ã€‚</p><p>ä¸ºäº†å®ç° Faiss çš„é«˜æ•ˆæ£€ç´¢åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦æ”¹å†™ SimpleIndexer ç±»ï¼š</p><p>ç´¢å¼•åˆå§‹åŒ–æ—¶ï¼Œé»˜è®¤æ˜¯ä»æœ¬åœ° sqlite ä¸­è¿›è¡Œè¯»å–ï¼Œå¯ä»¥æ›´æ”¹ä¸ºä»¥ä¸‹è¯»å–æ–¹æ³•ï¼š</p><pre><code class="lang-py">if cls is DocumentArray:    if storage == &#39;memory&#39;:        from docarray.array.memory import DocumentArrayInMemory        instance = super().__new__(DocumentArrayInMemory)    elif storage == &#39;sqlite&#39;:        from docarray.array.sqlite import DocumentArraySqlite        instance = super().__new__(DocumentArraySqlite)    elif storage == &#39;annlite&#39;:        from docarray.array.annlite import DocumentArrayAnnlite        instance = super().__new__(DocumentArrayAnnlite)    elif storage == &#39;weaviate&#39;:        from docarray.array.weaviate import DocumentArrayWeaviate        instance = super().__new__(DocumentArrayWeaviate)    elif storage == &#39;qdrant&#39;:        from docarray.array.qdrant import DocumentArrayQdrant        instance = super().__new__(DocumentArrayQdrant)    elif storage == &#39;elasticsearch&#39;:        from docarray.array.elastic import DocumentArrayElastic        instance = super().__new__(DocumentArrayElastic)    elif storage == &#39;redis&#39;:        from .redis import DocumentArrayRedis        instance = super().__new__(DocumentArrayRedis)    else:        raise ValueError(f&#39;storage=`&#123;storage&#125;` is not supported.&#39;)</code></pre><p>åœ¨ Faiss é‡Œæœ‰ä¸åŒçš„ç´¢å¼•ç±»å‹å¯ä¾›é€‰æ‹©ï¼š</p><p>IndexFlatL2ã€IndexFlatIPã€IndexHNSWFlatã€IndexIVFFlatã€IndexLSHã€IndexScalarQuantizerã€IndexPQã€IndexIVFScalarQuantizerã€IndexIVFPQã€IndexIVFPQRç­‰ã€‚</p><h2 id="2-ç›®å‰è·¨æ¨¡æ€æ¨¡å‹è¿™é‡Œä½¿ç”¨äº†æ¯”è¾ƒå¤§ä¼—çš„æ¨¡å‹ï¼Œæ–‡æœ¬ä¸è§†é¢‘çš„åŒ¹é…åº¦æœ‰å¾…æå‡ï¼Œè¿™é‡Œå¯ä»¥ä¼˜åŒ–æˆæ›´åŠ ä¼˜ç§€çš„æ¨¡å‹ï¼›"><a href="#2-ç›®å‰è·¨æ¨¡æ€æ¨¡å‹è¿™é‡Œä½¿ç”¨äº†æ¯”è¾ƒå¤§ä¼—çš„æ¨¡å‹ï¼Œæ–‡æœ¬ä¸è§†é¢‘çš„åŒ¹é…åº¦æœ‰å¾…æå‡ï¼Œè¿™é‡Œå¯ä»¥ä¼˜åŒ–æˆæ›´åŠ ä¼˜ç§€çš„æ¨¡å‹ï¼›" class="headerlink" title="2. ç›®å‰è·¨æ¨¡æ€æ¨¡å‹è¿™é‡Œä½¿ç”¨äº†æ¯”è¾ƒå¤§ä¼—çš„æ¨¡å‹ï¼Œæ–‡æœ¬ä¸è§†é¢‘çš„åŒ¹é…åº¦æœ‰å¾…æå‡ï¼Œè¿™é‡Œå¯ä»¥ä¼˜åŒ–æˆæ›´åŠ ä¼˜ç§€çš„æ¨¡å‹ï¼›"></a>2. ç›®å‰è·¨æ¨¡æ€æ¨¡å‹è¿™é‡Œä½¿ç”¨äº†æ¯”è¾ƒå¤§ä¼—çš„æ¨¡å‹ï¼Œæ–‡æœ¬ä¸è§†é¢‘çš„åŒ¹é…åº¦æœ‰å¾…æå‡ï¼Œè¿™é‡Œå¯ä»¥ä¼˜åŒ–æˆæ›´åŠ ä¼˜ç§€çš„æ¨¡å‹ï¼›</h2><p>TBC</p><h2 id="3-ç›®å‰-VCED-é¡¹ç›®ä»…èƒ½å¤Ÿå¤„ç†å¯¹å•ä¸ªè§†é¢‘çš„æ£€ç´¢ï¼Œéœ€è¦å¯¹é¡¹ç›®æ”¹é€ æ¥å®ç°å¯¹å¤šä¸ªè§†é¢‘ç‰‡æ®µçš„æ£€ç´¢ã€‚"><a href="#3-ç›®å‰-VCED-é¡¹ç›®ä»…èƒ½å¤Ÿå¤„ç†å¯¹å•ä¸ªè§†é¢‘çš„æ£€ç´¢ï¼Œéœ€è¦å¯¹é¡¹ç›®æ”¹é€ æ¥å®ç°å¯¹å¤šä¸ªè§†é¢‘ç‰‡æ®µçš„æ£€ç´¢ã€‚" class="headerlink" title="3. ç›®å‰ VCED é¡¹ç›®ä»…èƒ½å¤Ÿå¤„ç†å¯¹å•ä¸ªè§†é¢‘çš„æ£€ç´¢ï¼Œéœ€è¦å¯¹é¡¹ç›®æ”¹é€ æ¥å®ç°å¯¹å¤šä¸ªè§†é¢‘ç‰‡æ®µçš„æ£€ç´¢ã€‚"></a>3. ç›®å‰ VCED é¡¹ç›®ä»…èƒ½å¤Ÿå¤„ç†å¯¹å•ä¸ªè§†é¢‘çš„æ£€ç´¢ï¼Œéœ€è¦å¯¹é¡¹ç›®æ”¹é€ æ¥å®ç°å¯¹å¤šä¸ªè§†é¢‘ç‰‡æ®µçš„æ£€ç´¢ã€‚</h2><p>TBC</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬ç¯‡æ–‡ç« æ˜¯è·¨æ¨¡æ€æ£€ç´¢å·¥å…· VCED ä»‹ç»çš„ç¬¬å…­ç¯‡ã€‚ä»‹ç»å®Œ VCED çš„æ ¸å¿ƒæœºåˆ¶ä¸å‰åç«¯ï¼Œæœ¬æ¬¡è®°å½•ä¸‹å¯ä»¥ä¼˜åŒ–çš„ç‚¹ã€‚&lt;/p&gt;
&lt;!--more---&gt;
&lt;h2 id=&quot;1-ç›®å‰å‘é‡æ£€ç´¢ä½¿ç”¨çš„æ˜¯æœ€ç®€å•çš„æš´åŠ›æœç´¢ï¼Œæ‰€ä»¥å‘é‡æ£€ç´¢èŠ±è´¹çš„æ—¶é—´å¾ˆæ…¢ï¼Œè¿™é‡Œå¯ä»¥ä¼˜åŒ–æˆä»¥-Faiss-å®ç°çš„é«˜æ€§</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="VCED" scheme="https://superlova.github.io/tags/VCED/"/>
    
    <category term="multimodal" scheme="https://superlova.github.io/tags/multimodal/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æœºå™¨å­¦ä¹ ä¹‹XGBoostã€LightGBMã€CatBoost</title>
    <link href="https://superlova.github.io/2022/11/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B9%8BXGBoost%E3%80%81LightGBM%E3%80%81CatBoost/"/>
    <id>https://superlova.github.io/2022/11/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B9%8BXGBoost%E3%80%81LightGBM%E3%80%81CatBoost/</id>
    <published>2022-11-27T00:09:26.000Z</published>
    <updated>2022-11-27T01:40:23.906Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¼šè®°å½• XGBoostã€LightGBMã€CatBoost çš„åŸç†ã€åŒºåˆ«å’Œä½¿ç”¨æ–¹æ³•ã€‚</p><!--more---><h2 id="XGBoost"><a href="#XGBoost" class="headerlink" title="XGBoost"></a>XGBoost</h2><p>XGBoost æ˜¯ GBDT ç®—æ³•çš„ä¸€ç§é«˜æ•ˆå®ç°æ–¹å¼ã€‚</p><h3 id="XGBoost-çš„åŸç†"><a href="#XGBoost-çš„åŸç†" class="headerlink" title="XGBoost çš„åŸç†"></a>XGBoost çš„åŸç†</h3><p>åŸå§‹çš„ GBDT ç®—æ³•åŸºäºç»éªŒæŸå¤±å‡½æ•°çš„è´Ÿæ¢¯åº¦æ¥æ„é€ æ–°çš„å†³ç­–æ ‘ï¼Œæ„é€ å®Œæˆåå†è¿›è¡Œåå‰ªæã€‚XGBoost æ·»åŠ äº†é¢„å‰ªææ“ä½œï¼Œå®ƒåœ¨ç›®æ ‡å‡½æ•°ä¸­æ·»åŠ äº†æ­£åˆ™é¡¹ã€‚</p><script type="math/tex; mode=display">L_t=\sum_i L(y_i, F_{t-1}(x_i)+f_t(x_i)) + \Omega(f_t)</script><p>å…¶ä¸­ï¼š</p><script type="math/tex; mode=display">\Omega(f_t)=\gamma T+\frac{1}{2}\lambda \sum_{j=1}^{T}w_{j}^2</script><p>å…¶ä¸­ T ä¸ºè¿™æ£µæ ‘çš„å¶å­ç»“ç‚¹ä¸ªæ•°ï¼Œ$w_j$è¡¨ç¤ºç¬¬ j ä¸ªå¶å­ç»“ç‚¹çš„é¢„æµ‹å€¼ã€‚è¿™æ˜¯ä¸€ä¸ªæ­£åˆ™é¡¹ï¼Œè¯¥å€¼èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šä»£è¡¨ä¸€æ£µæ ‘çš„å¤æ‚ç¨‹åº¦ã€‚å› æ­¤åœ¨å»ºæ ‘æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´è¶…å‚æ•°ï¼Œè¾¾åˆ°é¢„å‰ªæçš„æ•ˆæœï¼Œ $\gamma$ è¶Šå¤§åˆ™ä¸å®¹æ˜“åˆ†å‰ï¼Œè¾ƒå°åˆ™å®¹æ˜“åˆ†å‰ã€‚XGBoost æ·»åŠ æ­¤é¡¹çš„ç›®çš„åœ¨äºæ§åˆ¶ä¸è¦ç”Ÿæˆè¿‡äºå¤æ‚çš„å­æ ‘ç»“æ„ã€‚</p><p>è¦æƒ³ä¼˜åŒ–è¯¥ç›®æ ‡å‡½æ•°ï¼Œä½†æ˜¯ f æœ¬èº«ä¸æ˜¯æ•°å€¼å‹çš„å‡½æ•°ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™è¿›è¡Œä¼˜åŒ–ã€‚å› æ­¤åœ¨è¿™é‡Œå¯¹æŸå¤±å‡½æ•°è¿›è¡ŒäºŒé˜¶æ³°å‹’å±•å¼€ï¼Œç”¨ä½œå‡½æ•°çš„è¿‘ä¼¼ï¼š</p><script type="math/tex; mode=display">\begin{aligned}L_t &=\sum_i L(y_i, F_{t-1}(x_i)+f_t(x_i)) + \Omega(f_t) \\&= \sum_i [L(y_i, F_{t-1}(x_i)) + g_if_t(x_i) + \frac{1}{2}h_if_t^2(x_i)] + \Omega(f_t)\end{aligned}</script><p>å…¶ä¸­ $ g<em>i=\frac{\partial L(y_i, F</em>{t-1}(x<em>i))}{\partial F</em>{t-1}(x<em>i)} $ï¼Œ$ h_i=\frac{\partial^2 L(y_i, F</em>{t-1}(x<em>i))}{\partial^2 F</em>{t-1}(x_i)} $ï¼Œåˆ†åˆ«ä¸ºf çš„ä¸€é˜¶å¯¼æ•°å’ŒäºŒé˜¶å¯¼æ•°</p><p>å¯¹ç¬¬ t æ¬¡è¿­ä»£æ¥è¯´ï¼Œ$ L(y<em>i, F</em>{t-1}(x_i)) $ æ˜¯ä¸ªå¸¸æ•°ï¼Œå› æ­¤ç›®æ ‡å‡½æ•°å¯è¿›ä¸€æ­¥ç®€åŒ–ä¸ºï¼š</p><script type="math/tex; mode=display">L_t=\sum_i [g_if_t(x_i) + \frac{1}{2}h_if_t^2(x_i)] + \Omega(f_t)</script><p>è¿™æ ·åšï¼Œåªéœ€çŸ¥é“æ¯ä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°ã€äºŒé˜¶å¯¼æ•°ï¼Œæ¯ä¸ªæ ·æœ¬åœ¨ç¬¬ t ä¸ªåˆ†ç±»å™¨çš„é¢„æµ‹ç»“æœï¼Œå¶å­ç»“ç‚¹çš„ä¸ªæ•°ï¼Œå¶å­ç»“ç‚¹çš„è¾“å‡ºå€¼ï¼Œå°±çŸ¥é“ç¬¬ t æ­¥çš„æŸå¤±å‡½æ•°å€¼äº†ã€‚</p><p>ä¸Šé¢çš„å…¬å¼ï¼Œæœ‰ä¸¤ä¸ª $\sum$ ï¼Œåœ¨æ•°å­¦ä¸Šä¸å¥½å¤„ç†ï¼šå·¦è¾¹çš„ $\sum$ æ˜¯é€æ ·æœ¬ç´¯åŠ ï¼Œå³è¾¹çš„ $\sum$ æ˜¯é€å¶å­ç´¯åŠ ï¼Œéœ€è¦æŠŠä»–ä»¬åˆå¹¶èµ·æ¥ã€‚</p><p>å¦‚æœæˆ‘ä»¬æŠŠæŸä¸ªå¶å­ç»“ç‚¹ j ä¸Šé¢æ‰€æœ‰æ ·æœ¬çš„æŸå¤±å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°ä¹‹å’Œè®°ä½œ Gï¼ŒäºŒé˜¶å¯¼æ•°ä¹‹å’Œè®°ä½œ Hï¼Œåˆ™ä¸Šå¼å¯ç®€åŒ–ã€‚å…·ä½“åœ°ï¼Œå¦‚æœå¶å­ç»“ç‚¹ j ä¸Šé¢çš„æ ·æœ¬é›†åˆä¸º $I_j={q(x_i)=j}$ ï¼ˆq(x) æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œèƒ½è¾“å…¥ä¸€ä¸ªæ ·æœ¬ï¼Œè¾“å‡ºè¯¥æ ·æœ¬åœ¨æ ‘ä¸Šçš„èŠ‚ç‚¹çš„ä¸‹æ ‡ï¼‰ï¼Œåˆ™ Gã€H çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">G_j=\sum_{i\in I_j}g_i \\H_j=\sum_{i\in I_j}h_i</script><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹å˜æ¢ï¼š</p><script type="math/tex; mode=display">\begin{aligned}L_t&=\sum_{i=1}^{N} [g_if_t(x_i) + \frac{1}{2}h_if_t^2(x_i)] + \gamma T + \frac{1}{2}\lambda\sum^{T}_{j=1}w^2_j \\&=\sum_{i=1}^N [g_iw_{q(x_i)}+\frac{1}{2}h_iw^2_{q(x_i)}] + \gamma T + \frac{1}{2}\lambda\sum^{T}_{j=1}w^2_j \\&=\sum_{j=1}^T [\sum_{i\in I_j}g_iw_j+\frac{1}{2}\sum_{i\in I_j}h_iw_j^2] + \gamma T + \frac{1}{2}\lambda\sum^{T}_{j=1}w^2_j \\&=\sum_{j=1}^T(G_jw_j+\frac{1}{2}(H_j+\lambda)w_j^2)+\gamma T\end{aligned}</script><p>è¿™å°±æ˜¯ç›®æ ‡å‡½æ•°çš„æœ€ç»ˆç»“æœã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿä¼˜åŒ–è¯¥ç›®æ ‡å‡½æ•°ï¼Œè®¡ç®—ç¬¬ t è½®æ—¶ä½¿ç›®æ ‡å‡½æ•°æœ€å°çš„å¶èŠ‚ç‚¹çš„è¾“å‡ºåˆ†æ•° wã€‚æˆ‘ä»¬ç›´æ¥å¯¹ w è¿›è¡Œæ±‚å¯¼å¹¶ä»¤å¯¼æ•°ä¸º 0ï¼Œæ­¤æ—¶çš„ w ä¸ºï¼š</p><script type="math/tex; mode=display">w_j=-\frac{G_j}{H_j+\lambda}</script><p>æœ€ç»ˆå¾—åˆ°æŸå¤±å‡½æ•°å½¢å¼ï¼š</p><script type="math/tex; mode=display">L_t=-\frac{1}{2}\sum_{j=1}^T (\frac{G^2_j}{H_j + \lambda}) + \gamma T</script><p>è¯¥å€¼è¶Šå°ï¼Œç›®æ ‡å‡½æ•°è¶Šå°ã€‚</p><p>XGBoost åœ¨åˆ†è£‚æ—¶ï¼Œä¼šéå†è¯¥ç‰¹å¾çš„æ‰€æœ‰å–å€¼ï¼Œå°è¯•è®¡ç®—åˆ†è£‚å‰çš„æŸå¤±å’Œåˆ†è£‚åçš„æŸå¤±ã€‚</p><script type="math/tex; mode=display">\text{Gain}=\frac{1}{2}[\frac{G^2_L}{H_L + \lambda}+\frac{G^2_R}{H_R + \lambda}-\frac{(G_L + G_R)^2}{H_L + H_R + \lambda}] - \gamma</script><p>å…¶ä¸­ç¬¬ä¸€é¡¹æ˜¯å·¦å­æ ‘åˆ†æ•°ï¼Œç¬¬äºŒé¡¹æ˜¯å³å­æ ‘åˆ†æ•°ï¼Œç¬¬ä¸‰é¡¹æ˜¯åˆ†è£‚å‰çš„åˆ†æ•°ï¼Œæœ€åçš„ gamma æ˜¯æ–°å¶å­ç»“ç‚¹çš„å¤æ‚åº¦ã€‚</p><p>gain å€¼è¶Šå¤§ï¼Œè¯´æ˜åˆ†è£‚åèƒ½å¤Ÿæ›´å¤šåœ°è®©æŸå¤±å‡½æ•°å‡å°ï¼Œä¹Ÿå°±æ˜¯è¶Šå¥½ã€‚</p><h3 id="XGBoost-è‡ªå®šä¹‰æŸå¤±å‡½æ•°"><a href="#XGBoost-è‡ªå®šä¹‰æŸå¤±å‡½æ•°" class="headerlink" title="XGBoost è‡ªå®šä¹‰æŸå¤±å‡½æ•°"></a>XGBoost è‡ªå®šä¹‰æŸå¤±å‡½æ•°</h3><p>XGBoost èƒ½å¤Ÿè§£å†³äºŒå…ƒåˆ†ç±»ã€å¤šå…ƒåˆ†ç±»ã€å›å½’é—®é¢˜ã€‚å¯¹äºäºŒå…ƒåˆ†ç±»é—®é¢˜ï¼Œæœ€ç»ˆçš„é¢„æµ‹å€¼ä¼šç»è¿‡ sigmoid å‡½æ•°åæ¯”è¾ƒè¾“å‡ºä¸ 0 æˆ– 1 çš„æ¥è¿‘ç¨‹åº¦ï¼›å¯¹äºå¤šå…ƒåˆ†ç±»é—®é¢˜ï¼Œæœ€ç»ˆçš„é¢„æµ‹å€¼ä¼šç»è¿‡ softmax å‡½æ•°åå¾—åˆ°æŸä¸€ç±»å‹çš„æœ€å¤§æ¦‚ç‡ï¼Œè¾“å‡ºæŸä¸€ç±»å‹çš„å€¼ã€‚</p><p>äºŒå…ƒåˆ†ç±»å™¨çš„ç›®æ ‡å‡½æ•°ï¼š</p><script type="math/tex; mode=display">sigmoid=\frac{1}{1+e^{-x}}</script><pre><code class="lang-py">def sigmoid(x):    return 1.0 / 1 + np.exp(-x)</code></pre><p>æŸå¤±å‡½æ•°ï¼š</p><script type="math/tex; mode=display">logloss=-(y\log(p)+(1-y)\log(1-p))</script><p>å°†æŸå¤±å‡½æ•°ä»£å…¥ sigmoidï¼š</p><script type="math/tex; mode=display">logloss(y_i,\hat{y_i})=(y\ln(1+e^{-\hat{y_i}})+(1-y_i)\ln(1+e^{\hat{y_i}}))</script><p>æŸå¤±å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°å’ŒäºŒé˜¶å¯¼æ•°ï¼š</p><script type="math/tex; mode=display">g_i=p_i^{t-1}-y_i \\h_i=p^{t-1}_i (1-p^{t-1}_i)</script><p>å¤šå…ƒåˆ†ç±»å™¨çš„ç›®æ ‡å‡½æ•°ï¼š</p><script type="math/tex; mode=display">\text{softmax}=\frac{e^{\hat{y_i}}}{\sum_j e^{\hat{y_i}}}</script><pre><code class="lang-py">def softmax(x):    e = np.exp(x)    return e / np.sum(e)</code></pre><p>æŸå¤±å‡½æ•°ï¼š</p><script type="math/tex; mode=display">logloss=-\frac{1}{N}\sum_{i=1}^N\sum_{j=1}^M y_{ij}\log(p_{i,j})</script><p>å…¶ä¸­ N ä¸ºæ ·æœ¬æ•°ï¼ŒM ä¸ºç±»åˆ«æ•°ã€‚ $y<em>{ij}$ ä»£è¡¨ç¬¬ i ä¸ªæ ·æœ¬åˆ†ç±»ä¸º j æ—¶åˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0ï¼› $p</em>{i,j}$ ä»£è¡¨ç¬¬ i ä¸ªæ ·æœ¬è¢«é¢„æµ‹ä¸ºç¬¬ j ç±»çš„æ¦‚ç‡ã€‚</p><p>æŸå¤±å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°å’ŒäºŒé˜¶å¯¼æ•°ï¼Œå…¶æ•´ä½“å½¢å¼ä»ä¸äºŒåˆ†ç±»ä¸€è‡´.</p><p>å¦‚æœæˆ‘ä»¬æƒ³è‡ªå®šä¹‰æŸå¤±å‡½æ•°ï¼Œæ¯”å¦‚åœ¨äºŒåˆ†ç±»é—®é¢˜ä¸Šï¼Œæˆ‘ä»¬å¯¹æ•°æ®è¾ƒå°‘çš„é‚£ä¸ªç±»åˆ«äºˆä»¥æ›´å¤šæƒ©ç½šï¼Œå°±å¯ä»¥è¿™æ ·å®ç°ï¼š</p><pre><code class="lang-py">def weighted_binary_cross_entropy(pred, dtrain, imbalance_alpha=10):    label = dtrain.get_label()    sigmoid_pred = 1.0 / (1.0 + np.exp(-pred))    # ä¸€é˜¶å¯¼æ•°    grad = -(imbalance_alpha ** label) * (label - sigmoid_pred)    # äºŒé˜¶å¯¼æ•°    hessian = (imbalance_alpha ** label) * sigmoid_pred* ï¼ˆ1.0 - sigmoid_predï¼‰    return grad, hessian</code></pre><h3 id="XGBoost-å€™é€‰åˆ†è£‚ç‚¹é€‰å–ç­–ç•¥"><a href="#XGBoost-å€™é€‰åˆ†è£‚ç‚¹é€‰å–ç­–ç•¥" class="headerlink" title="XGBoost å€™é€‰åˆ†è£‚ç‚¹é€‰å–ç­–ç•¥"></a>XGBoost å€™é€‰åˆ†è£‚ç‚¹é€‰å–ç­–ç•¥</h3><h3 id="XGBoost-åœ¨å·¥ç¨‹ä¸Šçš„ä¼˜åŒ–"><a href="#XGBoost-åœ¨å·¥ç¨‹ä¸Šçš„ä¼˜åŒ–" class="headerlink" title="XGBoost åœ¨å·¥ç¨‹ä¸Šçš„ä¼˜åŒ–"></a>XGBoost åœ¨å·¥ç¨‹ä¸Šçš„ä¼˜åŒ–</h3><p>XGBoost åœ¨é€‰æ‹©åˆ†è£‚åˆ‡åˆ†ç‚¹æ—¶ï¼Œä¸ä¼šä¸€ä¸ªä¸€ä¸ªåœ°éå†ï¼Œè€Œæ˜¯é€‰æ‹©åˆ†ä½æ•°ç‚¹ã€‚</p><p>XGBoost åœ¨ç”Ÿæˆä¸‹ä¸€æ£µæ ‘æ—¶ï¼Œæ‰€æœ‰æ ·æœ¬çš„æƒé‡ g å’Œ h å¯ä»¥é€šè¿‡å½“å‰æ ‘çš„é¢„æµ‹å€¼å’Œå®é™…å€¼å¾—åˆ°ã€‚å› æ­¤è¦ç¡®å®šæœ€ä½³åˆ†å‰²ç‚¹ï¼Œéœ€è¦æå‰å¯¹ç‰¹å¾å€¼è¿›è¡Œæ’åºã€‚xgboostå¯ä»¥åœ¨è®­ç»ƒä¸‹ä¸€æ£µæ ‘å‰é¢„å…ˆè®¡ç®—å¥½æ¯ä¸ªç‰¹å¾åœ¨ä¸åŒåˆ‡åˆ†ç‚¹çš„å¢ç›Šï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œä¿å­˜ä¸ºblockçš„ç»“æ„ï¼Œè¿­ä»£ä¸­é‡å¤ä½¿ç”¨è¿™ä¸ªç»“æ„ï¼Œå› æ­¤å„ä¸ªç‰¹å¾çš„å¢ç›Šè®¡ç®—å°±å¯ä»¥å¤šçº¿ç¨‹å¹¶è¡Œè¿›è¡Œã€‚</p><h3 id="XGBoost-ä¸-GBDT-çš„åŒºåˆ«"><a href="#XGBoost-ä¸-GBDT-çš„åŒºåˆ«" class="headerlink" title="XGBoost ä¸ GBDT çš„åŒºåˆ«"></a>XGBoost ä¸ GBDT çš„åŒºåˆ«</h3><ol><li><p>åŸºåˆ†ç±»å™¨ä¸åŒã€‚XGBoost ç›®å‰æ”¯æŒä¸‰ç§åŸºåˆ†ç±»å™¨ï¼Œåˆ†åˆ«æ˜¯ gbtreeï¼Œgblinear å’Œ dartï¼Œå¯ä»¥ä½¿ç”¨ <strong>booster</strong> å‚æ•°ä¿®æ”¹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ gbtree å°±æ˜¯åŸºäº CART å›å½’æ ‘çš„ XGBoostï¼Œgblinear æ˜¯é€»è¾‘å›å½’çº¿æ€§åˆ†ç±»å™¨ï¼Œdart æ˜¯ç”¨äº† dropout çš„æ ‘åˆ†ç±»å™¨ã€‚</p></li><li><p>å¯¼æ•°ä¿¡æ¯ä¸åŒï¼ŒæŸå¤±å‡½æ•°ä¹Ÿä¸åŒã€‚XGBoost å¯¹æŸå¤±å‡½æ•°åšäº†äºŒé˜¶æ³°å‹’å±•å¼€ï¼ŒGBDT åªç”¨äº†ä¸€é˜¶å¯¼æ•°ä¿¡æ¯ã€‚</p></li></ol><p>XGBoost æ²¡æœ‰å®šä¹‰æŸå¤±å‡½æ•°æœ¬èº«ï¼Œåªè¦è¯¥æŸå¤±å‡½æ•°èƒ½å¤Ÿè¿›è¡ŒäºŒé˜¶æ³°å‹’å±•å¼€å³å¯ï¼Œå› æ­¤åŸºå­¦ä¹ å™¨å¯ä»¥æ›´æ¢ã€‚</p><p>XGBoost é»˜è®¤ä½¿ç”¨ CART å›å½’æ ‘ç”¨ä½œåŸºå­¦ä¹ å™¨ï¼Œä½†æ˜¯å¯ä»¥æ›´æ¢ä¸ºå…¶ä»–å­¦ä¹ å™¨ï¼Œæ¯”å¦‚çº¿æ€§æ¨¡å‹ã€‚æ­¤æ—¶çš„æŸå¤±å‡½æ•°éœ€è¦æ›´æ¢ã€‚</p><p>æ¯”å¦‚åˆ†ç±»é—®é¢˜ï¼ŒæŸå¤±å‡½æ•°ä¸€èˆ¬ä¸º logistics æŸå¤±å‡½æ•°</p><ol><li>XGBoost åœ¨æ¯è½®è¿­ä»£æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å…¨éƒ¨æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªåŠ©é‡‡æ ·çš„æ•°æ®ã€‚</li></ol><p>è¿™é‡Œçš„æ€æƒ³ç±»ä¼¼éšæœºæ£®æ—ï¼Œæ¯æ¬¡èŠ‚ç‚¹åˆ†è£‚å¹¶æ²¡æœ‰æ¯”è¾ƒæ‰€æœ‰ç‰¹å¾çš„å¥½åï¼Œè€Œæ˜¯å…ˆéšæœºåœˆå®šä¸€éƒ¨åˆ†ç‰¹å¾ï¼Œåªä½¿ç”¨è¿™éƒ¨åˆ†ç‰¹å¾è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œåœ¨ç”Ÿæˆæ ‘æ—¶å¼•å…¥äº†éšæœºæ€§ã€‚</p><p>åˆ—é‡‡æ ·æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯å±‚å†…éšæœºï¼Œä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½ä½¿ç”¨éšæœºåœˆå®šçš„ç‰¹å¾ï¼›å¦ä¸€ç§æ˜¯æ•´é¢—æ ‘éšæœºï¼Œå³å»ºæ ‘ä¼Šå§‹å°±ä½¿ç”¨éšæœºåœˆå®šçš„ç‰¹å¾ã€‚</p><p>å¦å¤– XGBoost åœ¨å†³å®šç‰¹å¾çš„åˆ†è£‚ç‚¹æ˜¯ï¼Œå¹¶æ²¡æœ‰é€ä¸ªæ¯”è¾ƒæ‰€æœ‰æƒ…å†µï¼Œè€Œæ˜¯é€‰ç”¨äº†äºŒé˜¶æ¢¯åº¦åˆ†ä½ç‚¹ã€‚</p><ol><li>XGBoost èƒ½å¤Ÿè‡ªåŠ¨å­¦ä¹ å‡ºç¼ºå¤±å€¼çš„å¤„ç†ç­–ç•¥ã€‚</li></ol><p>ç¼ºå¤±å€¼å¤„ç†ç­–ç•¥ç›¸å¯¹ç®€å•ï¼Œå³åˆ†åˆ«å°è¯•æŠŠæ‰€æœ‰ç¼ºå¤±è¯¥ç‰¹å¾çš„æ•°æ®æ”¾åœ¨å·¦å­æ ‘å’Œå³å­æ ‘ï¼Œåˆ†åˆ«è®¡ç®—å¢ç›Šï¼Œæ¥å†³å®šç¼ºå¤±æ•°æ®çš„å½’å®¿ã€‚è¿™ä¹Ÿå°±å†³å®šäº† XGBoost æ— æ³•åº”å¯¹ OneHot ç¼–ç è¿™ç§å¤§éƒ¨åˆ†éƒ½ä¸º 0 çš„ç‰¹å¾ã€‚</p><ol><li>XGBoost åœ¨å·¥ç¨‹å®ç°ä¸Šçš„ä¼˜åŒ–</li></ol><p>åœ¨é€‰æ‹©åˆ†è£‚ç‚¹æ—¶ï¼ŒXGBoost ä¼šé¦–å…ˆå°†æ ·æœ¬æŒ‰ç…§ç‰¹å¾è¿›è¡Œæ’åºã€‚æ’åºçš„è¿™ä¸ªæ­¥éª¤å¯ä»¥è¿›è¡Œä¼˜åŒ–ã€‚</p><h2 id="LightGBM"><a href="#LightGBM" class="headerlink" title="LightGBM"></a>LightGBM</h2><h2 id="CatBoost"><a href="#CatBoost" class="headerlink" title="CatBoost"></a>CatBoost</h2><h2 id="LambdaMART"><a href="#LambdaMART" class="headerlink" title="LambdaMART"></a>LambdaMART</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.jianshu.com/p/bac6a0dfac2c">https://www.jianshu.com/p/bac6a0dfac2c</a></p><p><a href="https://blog.csdn.net/zwqjoy/article/details/109311133">https://blog.csdn.net/zwqjoy/article/details/109311133</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬æ–‡ä¼šè®°å½• XGBoostã€LightGBMã€CatBoost çš„åŸç†ã€åŒºåˆ«å’Œä½¿ç”¨æ–¹æ³•ã€‚&lt;/p&gt;
&lt;!--more---&gt;
&lt;h2 id=&quot;XGBoost&quot;&gt;&lt;a href=&quot;#XGBoost&quot; class=&quot;headerlink&quot; title=&quot;XGBoost&quot;&gt;&lt;/a&gt;</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="XGBoost" scheme="https://superlova.github.io/tags/XGBoost/"/>
    
    <category term="LightGBM" scheme="https://superlova.github.io/tags/LightGBM/"/>
    
    <category term="CatBoost" scheme="https://superlova.github.io/tags/CatBoost/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘é€šè¿‡æ–‡å­—æ£€ç´¢è§†é¢‘ç‰‡æ®µï¼šVCEDä¹‹åç«¯é€»è¾‘</title>
    <link href="https://superlova.github.io/2022/11/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E4%B9%8B%E5%90%8E%E7%AB%AF%E9%80%BB%E8%BE%91/"/>
    <id>https://superlova.github.io/2022/11/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E4%B9%8B%E5%90%8E%E7%AB%AF%E9%80%BB%E8%BE%91/</id>
    <published>2022-11-23T13:49:27.000Z</published>
    <updated>2022-11-23T17:50:38.259Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« æ˜¯è·¨æ¨¡æ€æ£€ç´¢å·¥å…· VCED ä»‹ç»çš„ç¬¬äº”ç¯‡ï¼Œå‰é¢ä»‹ç»äº†å‰ç«¯éƒ¨åˆ†ï¼Œæœ¬ç¯‡æ¥ç ”ç©¶åç«¯éƒ¨åˆ†ã€‚</p><!--more---><h2 id="ä¸€ã€æ¦‚è§ˆ"><a href="#ä¸€ã€æ¦‚è§ˆ" class="headerlink" title="ä¸€ã€æ¦‚è§ˆ"></a>ä¸€ã€æ¦‚è§ˆ</h2><p>é¡¹ç›®åç«¯å…±ç”±å››ä¸ªæ–‡ä»¶ç»„æˆï¼Œå…¶ä¸­ VideoLoader è´Ÿè´£å¯¹ä¸Šä¼ çš„è§†é¢‘è¿›è¡Œå…³é”®å¸§æå–ï¼ŒCustomClipText è´Ÿè´£å°†ä¸Šä¼ çš„å›¾ç‰‡è½¬æ¢ä¸ºå‘é‡æ•°æ®ï¼ŒCustomClipImage è´Ÿè´£å°†æå–çš„å…³é”®å¸§è½¬æ¢ä¸ºå‘é‡æ•°æ®ï¼ŒSimpleIndexer è´Ÿè´£å‘é‡æ•°æ®çš„æ£€ç´¢ã€‚</p><ul><li>VideoLoader</li><li>CustomClipText</li><li>CustomClipImage</li><li>SimpleIndexer</li></ul><h2 id="äºŒã€VideoLoader"><a href="#äºŒã€VideoLoader" class="headerlink" title="äºŒã€VideoLoader"></a>äºŒã€VideoLoader</h2><p>VideoLoader ç»§æ‰¿è‡ª Executorï¼Œåœ¨æ•´ä¸ªåç«¯ä¸­æ‰§è¡ŒæŠ½å¸§æ“ä½œã€‚</p><p>è¿™é‡Œç®€å•ä»‹ç»ä¸‹æ ¸å¿ƒä»£ç ï¼š</p><pre><code class="lang-py"># å°†æå–å‡½æ•°æ³¨å†Œåœ¨è·¯ç”±çš„ /extract é‡Œ@requests(on=&#39;/extract&#39;)def extract(self, docs: DocumentArray, parameters: Dict, **kwargs):    &quot;&quot;&quot;    Load the video from the Document.uri, extract frames and audio. The extracted data are stored in chunks.    :param docs: the input Documents with either the video file name or data URI in the `uri` field    :param parameters: A dictionary that contains parameters to control        extractions and overrides default values.    Possible values are `ffmpeg_audio_args`, `ffmpeg_video_args`, `librosa_load_args`. Check out more description in the `__init__()`.    For example, `parameters=&#123;&#39;ffmpeg_video_args&#39;: &#123;&#39;s&#39;: &#39;512x320&#39;&#125;`.    &quot;&quot;&quot;    for doc in docs:        # æ¯ä¸ª doc å¯¹åº”ä¸€æ®µè§†é¢‘é“¾æ¥ï¼Œå…ˆæŠŠå®ƒå°è£…æˆä¸€ä¸ªå¯¹è±¡        with tempfile.TemporaryDirectory() as tmpdir:            source_fn = (                self._save_uri_to_tmp_file(doc.uri, tmpdir)                if self._is_datauri(doc.uri)                else doc.uri            )            # extract all the frames video            if &#39;image&#39; in self._modality:                ffmpeg_video_args = deepcopy(self._ffmpeg_video_args)                ffmpeg_video_args.update(parameters.get(&#39;ffmpeg_video_args&#39;, &#123;&#125;))                # è°ƒç”¨å†…éƒ¨å‡½æ•°ï¼ŒæŠŠè§†é¢‘å¸§æŠ½å‡ºæ¥å˜æˆ tensor                frame_tensors = self._convert_video_uri_to_frames(                    source_fn, doc.uri, ffmpeg_video_args                )                for idx, frame_tensor in enumerate(frame_tensors):                    self.logger.debug(f&#39;frame: &#123;idx&#125;&#39;)                    chunk = Document(modality=&#39;image&#39;)                    # chunk.blob = frame_tensor                    max_size = 240                    img = Image.fromarray(frame_tensor)                    if img.size[0] &gt; img.size[1]:                        width = max_size                        height = math.ceil(max_size / img.size[0] * img.size[1])                    else:                        height = max_size                        width = math.ceil(max_size / img.size[1] * img.size[0])                    img = img.resize((width, height))                    chunk.tensor = np.asarray(img).astype(&#39;uint8&#39;)                    print(chunk.tensor.shape)                    # chunk.tensor = np.array(frame_tensor).astype(&#39;uint8&#39;)                    chunk.location = (np.uint32(idx),)                    chunk.tags[&#39;timestamp&#39;] = idx / self._frame_fps                    if self._copy_uri:                        chunk.tags[&#39;video_uri&#39;] = doc.uri                    # åˆ°è¿™é‡Œè§†é¢‘å¸§éƒ½è¢«å­˜åœ¨ doc çš„ chunk é‡Œäº†ã€‚                    doc.chunks.append(chunk)</code></pre><p>VideoLoader çš„å­å‡½æ•°ä¸­ï¼Œæœ‰ä¸“é—¨è´Ÿè´£æå–è§†é¢‘å¸§çš„å‚æ•°ï¼Œæ¥å¾—åˆ°è§†é¢‘åˆ†è¾¨ç‡çš„ï¼›æœ‰è·å–éŸ³é¢‘é‡‡æ ·ç‡ç­‰ä¿¡æ¯çš„ï¼›ä¹Ÿæœ‰è·å–å­—å¹•æ–‡æœ¬çš„ï¼ˆå³å°è¯•æŸ¥æ‰¾ srtå­—å¹•æ–‡ä»¶ï¼‰ã€‚</p><h2 id="ä¸‰ã€CustomClipText"><a href="#ä¸‰ã€CustomClipText" class="headerlink" title="ä¸‰ã€CustomClipText"></a>ä¸‰ã€CustomClipText</h2><p>è¯¥æ¨¡å—è´Ÿè´£è°ƒç”¨ CLIP æ¥å®ç°æŠŠæ–‡æœ¬å˜æˆ embeddings çš„åŠŸèƒ½ã€‚å®ƒçš„å…³é”®ç®—æ³•æ˜¯ï¼š</p><pre><code class="lang-py">def encode(self, docs: DocumentArray, parameters: Dict, **kwargs):    print(&#39;clip_text encode&#39;)    for docs_batch in DocumentArray(        filter(            lambda x: bool(x.text),            docs[parameters.get(&#39;traversal_paths&#39;, self.traversal_paths)],        )    ).batch(batch_size=parameters.get(&#39;batch_size&#39;, self.batch_size)) :        text_batch = docs_batch.texts        t1 = time.time()        with torch.inference_mode():            input_tokens = [self.model.encode_text(clip.tokenize([t, &quot;unknown&quot;]).to(self.device)) for t in text_batch] # self._generate_input_tokens(text_batch)            embeddings = input_tokens # self.model.get_text_features(**input_tokens).cpu().numpy()            for doc, embedding in zip(docs_batch, embeddings):                doc.embedding = embedding                # doc.embedding = np.array(embedding).astype(&#39;float32&#39;)[0]        t2 = time.time()        print(&quot;encode text cost:&quot;, t2 - t1)        print(t1)        print(t2)</code></pre><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå®é™…ä¸Šå°±æ˜¯è°ƒç”¨äº†ä¸€ä¸ªæ¨¡å‹ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œäº†é¢„å¤„ç†ï¼Œæœ€åå¯¹æ–‡æœ¬æ•°æ®è¿›è¡Œç¼–ç ï¼Œä»¥ DocumentArray å½¢å¼å­˜å‚¨ï¼Œä¾¿äºåç»­ä¼ å€¼ã€‚</p><h2 id="å››ã€CustomClipImage"><a href="#å››ã€CustomClipImage" class="headerlink" title="å››ã€CustomClipImage"></a>å››ã€CustomClipImage</h2><p>ä¸ CustomClipText ç±»ä¼¼ï¼Œé€šè¿‡ CLIP æ¨¡å‹æŠŠå›¾ç‰‡å˜æˆ Embeddingã€‚åªè¦æœ‰ CLIP æ¨¡å‹ï¼Œå¯¹æ•°æ®è¿›è¡Œä¸å¤„ç†åå³å¯å¾—åˆ°å®ƒçš„ Embeddingã€‚</p><pre><code class="lang-py">def encode(self, docs: DocumentArray, parameters: dict, **kwargs):    t1 = time.time()    print(&#39;clip_image encode&#39;, t1)    document_batches_generator =  DocumentArray(        filter(            lambda x: x is not None,            docs[parameters.get(&#39;traversal_paths&#39;, self.traversal_paths)],        )    ).batch(batch_size=parameters.get(&#39;batch_size&#39;, self.batch_size))    with torch.inference_mode():        for batch_docs in document_batches_generator:            print(&#39;in for&#39;)            for d in batch_docs:                print(&#39;in clip image d.uri&#39;, d.uri, len(d.chunks))                # tensor = self._generate_input_features(tensors_batch)                tensors_batch = []                for c in d.chunks:                    if (c.modality == &#39;image&#39;):                        image_embedding = self.model.encode_image(self.preprocessor(Image.fromarray(c.tensor)).unsqueeze(0).to(self.device))                        # tensors_batch.append(image_embedding)                        tensors_batch.append(np.array(image_embedding).astype(&#39;float32&#39;))                embedding = tensors_batch                d.embedding = embedding    t2 = time.time()    print(&#39;clip_image encode end&#39;, t2 - t1, t2)</code></pre><p>æ³¨æ„è¿™é‡Œä¹Ÿå°†embedding ç¼–ç æˆäº† DocArrayå½¢å¼è¿›è¡Œå­˜å‚¨ã€‚</p><h2 id="äº”ã€SimpleIndexer"><a href="#äº”ã€SimpleIndexer" class="headerlink" title="äº”ã€SimpleIndexer"></a>äº”ã€SimpleIndexer</h2><p>è¿™é‡Œå®ç°äº†å…³é”®çš„æ£€ç´¢åŠŸèƒ½ï¼Œé¦–å…ˆéœ€è¦å°†æ‰€æœ‰èµ„æºè½¬åŒ–ä¸ºä»–ä»¬çš„ Embeddingï¼ˆå³ DocArrayï¼‰ï¼Œç„¶åä½¿ç”¨å‘é‡ç›¸ä¼¼åº¦æ¯”è¾ƒçš„æ–¹å¼è¿›è¡Œæ£€ç´¢ã€‚æ£€ç´¢çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="lang-py">    def search(        self,        docs: &#39;DocumentArray&#39;,        parameters: Optional[Dict] = None,        **kwargs,    ):        &quot;&quot;&quot;Perform a vector similarity search and retrieve the full Document match        :param docs: the Documents to search with        :param parameters: the runtime arguments to `DocumentArray`&#39;s match        function. They overwrite the original match_args arguments.        &quot;&quot;&quot;        match_args = (            &#123;**self._match_args, **parameters&#125;            if parameters is not None            else self._match_args        )        traversal_right = parameters.get(            &#39;traversal_right&#39;, self.default_traversal_right        )        traversal_left = parameters.get(&#39;traversal_left&#39;, self.default_traversal_left)        match_args = SimpleIndexer._filter_match_params(docs, match_args)        # print(&#39;in indexer&#39;,docs[traversal_left].embeddings.shape, self._index[traversal_right])        texts: DocumentArray = docs[traversal_left]        stored_docs: DocumentArray = self._index[traversal_right]        doc_ids = parameters.get(&quot;doc_ids&quot;)        t1 = time.time()        with torch.inference_mode():            t1_00 = time.time()            for text in texts:                result = []                text_features = text.embedding                text.embedding = None                for sd in stored_docs:                    if doc_ids is not None and sd.uri not in doc_ids:                        continue                    images_features = sd.embedding                    print(&#39;images len&#39;,len(images_features))                    t1_0 = time.time()                    tensor_images_features = [Tensor(image_features) for image_features in images_features]                    t1_1 = time.time()                    for i, image_features in enumerate(tensor_images_features):                        tensor = image_features                        probs = self.score(tensor, text_features)                        result.append(&#123;                            &quot;score&quot;: probs[0][0],                            &quot;index&quot;: i,                            &quot;uri&quot;: sd.uri,                            &quot;id&quot;: sd.id                        &#125;)                    t1_2 = time.time()                    print(&quot;tensor cost:&quot;, t1_1 - t1_0)                    print(&quot;part score cost:&quot;, t1_2 - t1_1)                    print(t1_0)                    print(t1_1)                    print(t1_2)                t2 = time.time()                print(&#39;score cost:&#39;, t2 - t1)                # print(parameters, type(parameters.get(&quot;thod&quot;)))                index_list = self.getMultiRange(result,0.1 if parameters.get(&quot;thod&quot;) is None else parameters.get(&#39;thod&#39;), parameters.get(&quot;maxCount&quot;))                t3 = time.time()                print(&#39;range cost:&#39;, t3 - t2)                print(t1)                print(t1_00)                print(t2)                print(t3)                # print(index_list)                docArr = DocumentArray.empty(len(index_list))                for i, doc in enumerate(docArr):                    doc.tags[&quot;leftIndex&quot;] = index_list[i][&quot;leftIndex&quot;]                    doc.tags[&quot;rightIndex&quot;] = index_list[i][&quot;rightIndex&quot;]                    # print(index_list[i])                    doc.tags[&quot;maxImageScore&quot;] = float(index_list[i][&quot;maxImage&quot;][&quot;score&quot;])                    doc.tags[&quot;uri&quot;] = index_list[i][&quot;maxImage&quot;][&quot;uri&quot;]                    doc.tags[&quot;maxIndex&quot;] = index_list[i][&quot;maxImage&quot;][&quot;index&quot;]                # print(docArr)                text.matches = docArr</code></pre><p>å¯¹äºæ¯æ®µåŒ¹é…çš„è§†é¢‘å¸§ï¼Œè¿˜ä¼šåœ¨æœ€ç»ˆæœ‰ä¸€ä¸ªæ‰“åˆ†æ’åºçš„æ“ä½œã€‚æ‰“åˆ†çš„è¿‡ç¨‹å…¶å®å°±æ˜¯å¯¹ç‰¹å¾è¿›è¡Œæ ‡å‡†åŒ–ï¼ŒæŒ‰ç…§ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—ï¼Œæœ€ç»ˆé€šè¿‡softmaxæ¨¡å‹å¾—å‡ºprobabilityã€‚å®é™…ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="lang-py">    def score(self, image_features, text_features):        logit_scale = self.model.logit_scale.exp()        # normalized features        image_features = image_features / image_features.norm(dim=1, keepdim=True)        text_features = text_features / text_features.norm(dim=1, keepdim=True)        # cosine similarity as logits        logits_per_image = logit_scale * image_features @ text_features.t()        probs = logits_per_image.softmax(dim=-1).cpu().detach().numpy()        # print(&quot; img Label probs:&quot;, probs)        return probs</code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥çœ‹ VCED çš„åç«¯éƒ¨åˆ†ä¸ç®—å¤æ‚ï¼Œåªæ˜¯å¿ å®åœ°ä½¿ç”¨äº† Jina æä¾›çš„æ¡†æ¶ï¼Œå°†å¤šæ¨¡æ€æ•°æ®æŠ½è±¡ä¸º Document ååˆ©ç”¨ Jina æä¾›çš„ api è¿›è¡Œå¤„ç†ç»§æ‰¿ Executor ç±»ï¼Œç„¶åè‡ªå®šä¹‰è‡ªå·±çš„æ“ä½œã€‚</p><p>å¦‚æœæƒ³è¦å®ç°è‡ªå·±çš„ Executorï¼Œä¹Ÿå¯ä»¥ç±»æ¯”ä¸Šé¢æåˆ°çš„æ¨¡å—æ¥ç»§æ‰¿ä¸€ä¸ªï¼›ä¸è¿‡å¤šæ•°ç”¨æˆ·å¯ä»¥æƒ³åˆ°çš„åŠŸèƒ½éƒ½å·²ç»è¢«ä¸Šä¼ åˆ°Jina Hubä¸Šï¼ŒVideoLoaderçš„ä¸»ä½“ä¹Ÿå¯ä»¥åœ¨hubä¸­è¿›è¡Œè®¿é—®ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨å°è£…å¥½çš„Executorï¼Œå®ç°è‡ªå·±çš„åŠŸèƒ½æ¨¡å—ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬ç¯‡æ–‡ç« æ˜¯è·¨æ¨¡æ€æ£€ç´¢å·¥å…· VCED ä»‹ç»çš„ç¬¬äº”ç¯‡ï¼Œå‰é¢ä»‹ç»äº†å‰ç«¯éƒ¨åˆ†ï¼Œæœ¬ç¯‡æ¥ç ”ç©¶åç«¯éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;!--more---&gt;
&lt;h2 id=&quot;ä¸€ã€æ¦‚è§ˆ&quot;&gt;&lt;a href=&quot;#ä¸€ã€æ¦‚è§ˆ&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€æ¦‚è§ˆ&quot;&gt;&lt;/a&gt;ä¸€ã€æ¦‚è§ˆ&lt;/h2</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="VCED" scheme="https://superlova.github.io/tags/VCED/"/>
    
    <category term="multimodal" scheme="https://superlova.github.io/tags/multimodal/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘é€šè¿‡æ–‡å­—æ£€ç´¢è§†é¢‘ç‰‡æ®µï¼šVCEDâ€”â€”Streamlitå‰ç«¯ç®€ä»‹</title>
    <link href="https://superlova.github.io/2022/11/21/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E2%80%94%E2%80%94Streamlit%E5%89%8D%E7%AB%AF%E7%AE%80%E4%BB%8B/"/>
    <id>https://superlova.github.io/2022/11/21/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E2%80%94%E2%80%94Streamlit%E5%89%8D%E7%AB%AF%E7%AE%80%E4%BB%8B/</id>
    <published>2022-11-20T17:12:30.000Z</published>
    <updated>2022-11-23T17:21:33.877Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« æ˜¯è·¨æ¨¡æ€æ£€ç´¢å·¥å…· VCED ä»‹ç»çš„ç¬¬å››ç¯‡ï¼Œå³å°†æ­æ™“ç¬¬ä¸€ç¯‡ä¸­ demo çš„å‰ç«¯éƒ¨åˆ†æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨ python + Streamlit å·¥å…·å¿«é€Ÿå¼€å‘ä¸€ä¸ªå‰ç«¯ç•Œé¢ã€‚</p><!--more---><p>Streamlit æ˜¯ä¸€ä¸ªåŸºäº Python çš„ Web åº”ç”¨ç¨‹åºæ¡†æ¶ã€‚Streamlit åŸºäº Pythonï¼Œå¼€å‘è€…æ— éœ€å­¦ä¹ å…¶ä»–å°±å¯ä»¥æ­å»ºä¸€ä¸ªè¾ƒä¸ºå®Œæ•´çš„ç³»ç»Ÿã€‚å› æ­¤æ­¤æ¬¡æ•™ç¨‹ï¼ŒVCEDé¡¹ç›®å°±é€šè¿‡ Streamlit + Jina æ„å»ºäº†ä¸€å¥—ç³»ç»Ÿã€‚</p><h2 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1. å®‰è£…"></a>1. å®‰è£…</h2><pre><code>pip install streamlit</code></pre><h2 id="2-ä½¿ç”¨-Streamlit-æ„å»º-Web-app"><a href="#2-ä½¿ç”¨-Streamlit-æ„å»º-Web-app" class="headerlink" title="2. ä½¿ç”¨ Streamlit æ„å»º Web app"></a>2. ä½¿ç”¨ Streamlit æ„å»º Web app</h2><pre><code class="lang-py">import pandas as pdimport numpy as npimport streamlit as stst.set_page_config(page_title=&quot;Hello Streamlit&quot;)st.title(&#39;This is your first Streamlit page!&#39;)  # æ ‡é¢˜st.markdown(&#39;Streamlit is **_really_ cool**.&#39;)  # markdowncode = &#39;&#39;&#39;def hello():     print(&quot;Hello, Streamlit!&quot;)&#39;&#39;&#39;st.code(code, language=&#39;python&#39;)  # codedf = pd.DataFrame(    np.random.randn(50, 20),    columns=(&#39;col %d&#39; % i for i in range(20)))st.dataframe(df)  # dataframest.latex(r&#39;&#39;&#39;     a + ar + a r^2 + a r^3 + \cdots + a r^&#123;n-1&#125; =     \sum_&#123;k=0&#125;^&#123;n-1&#125; ar^k =     a \left(\frac&#123;1-r^&#123;n&#125;&#125;&#123;1-r&#125;\right)     &#39;&#39;&#39;)  # latex</code></pre><p>æŒ‰ç…§ä»¥ä¸Šä»£ç å®ç°çš„ç½‘é¡µå¦‚ä¸‹ï¼š</p><p><img src="/2022/11/21/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E2%80%94%E2%80%94Streamlit%E5%89%8D%E7%AB%AF%E7%AE%80%E4%BB%8B/streamlit_demo.png" alt></p><h2 id="ä½¿ç”¨-Streamlit-å¤ç°-VCED-é¡¹ç›®çš„å‰ç«¯é¡µé¢"><a href="#ä½¿ç”¨-Streamlit-å¤ç°-VCED-é¡¹ç›®çš„å‰ç«¯é¡µé¢" class="headerlink" title="ä½¿ç”¨ Streamlit å¤ç° VCED é¡¹ç›®çš„å‰ç«¯é¡µé¢"></a>ä½¿ç”¨ Streamlit å¤ç° VCED é¡¹ç›®çš„å‰ç«¯é¡µé¢</h2><p>VCEDé¡¹ç›®å®ç°çš„æµç¨‹æœ‰ï¼šä¸Šä¼ è§†é¢‘ã€è¾“å…¥æè¿°ã€é™å®šæœç´¢ä¸ªæ•°ã€æœç´¢æŒ‰é’®ç­‰åŠŸèƒ½ã€‚</p><pre><code class="lang-py"># å¯¼å…¥éœ€è¦çš„åŒ…import streamlit as stfrom jina import Client, DocumentArray, Documentimport jsonimport osimport timeimport uuidVIDEO_PATH = f&quot;&#123;os.getcwd()&#125;/data&quot;# è§†é¢‘å­˜å‚¨çš„è·¯å¾„if not os.path.exists(VIDEO_PATH):    os.mkdir(VIDEO_PATH)# è§†é¢‘å‰ªè¾‘åå­˜å‚¨çš„è·¯å¾„if not os.path.exists(VIDEO_PATH + &quot;/videos/&quot;):    os.mkdir(VIDEO_PATH + &quot;/videos&quot;)# GRPC ç›‘å¬çš„ç«¯å£port = 45679# åˆ›å»º Jina å®¢æˆ·ç«¯c = Client(host=f&quot;grpc://localhost:&#123;port&#125;&quot;)# è®¾ç½®æ ‡ç­¾æ st.set_page_config(page_title=&quot;VCED&quot;, page_icon=&quot;ğŸ”&quot;)# è®¾ç½®æ ‡é¢˜st.title(&#39;Welcome to VCED!&#39;)# è§†é¢‘ä¸Šä¼ ç»„ä»¶uploaded_file = st.file_uploader(&quot;Choose a video&quot;)video_name = None  # name of the video# åˆ¤æ–­è§†é¢‘æ˜¯å¦ä¸Šä¼ æˆåŠŸif uploaded_file is not None:    # preview, delete and download the video    video_bytes = uploaded_file.read()    st.video(video_bytes)    # save file to disk for later process    video_name = uploaded_file.name    with open(f&quot;&#123;VIDEO_PATH&#125;/&#123;video_name&#125;&quot;, mode=&#39;wb&#39;) as f:        f.write(video_bytes)  # save video to diskvideo_file_path = f&quot;&#123;VIDEO_PATH&#125;/&#123;video_name&#125;&quot;uid = uuid.uuid1()# æ–‡æœ¬è¾“å…¥æ¡†text_prompt = st.text_input(    &quot;Description&quot;, placeholder=&quot;please input the description&quot;, help=&#39;The description of clips from the video&#39;)# top k è¾“å…¥æ¡†topn_value = st.text_input(    &quot;Top N&quot;, placeholder=&quot;please input an integer&quot;, help=&#39;The number of results. By default, n equals 1&#39;)# æ ¹æ®ç§’æ•°è¿˜åŸ ä¾‹å¦‚ 10829s è½¬æ¢ä¸º 03:04:05def getTime(t: int):    m,s = divmod(t, 60)    h, m = divmod(m, 60)    t_str = &quot;%02d:%02d:%02d&quot; % (h, m, s)    print (t_str)    return t_str# æ ¹æ®ä¼ å…¥çš„æ—¶é—´æˆ³ä½ç½®å¯¹è§†é¢‘è¿›è¡Œæˆªå–def cutVideo(start_t: str, length: int, input: str, output: str):    &quot;&quot;&quot;    start_t: èµ·å§‹ä½ç½®    length: æŒç»­æ—¶é•¿    input: è§†é¢‘è¾“å…¥ä½ç½®    output: è§†é¢‘è¾“å‡ºä½ç½®    &quot;&quot;&quot;    os.system(f&#39;ffmpeg -ss &#123;start_t&#125; -i &#123;input&#125; -t &#123;length&#125; -c:v copy -c:a copy -y &#123;output&#125;&#39;)# ä¸åç«¯äº¤äº’éƒ¨åˆ†def search_clip(uid, uri, text_prompt, topn_value):    video = DocumentArray([Document(uri=uri, id=str(uid) + uploaded_file.name)])    t1 = time.time()    c.post(&#39;/index&#39;, inputs=video) # é¦–å…ˆå°†ä¸Šä¼ çš„è§†é¢‘è¿›è¡Œå¤„ç†    text = DocumentArray([Document(text=text_prompt)])    print(topn_value)    resp = c.post(&#39;/search&#39;, inputs=text, parameters=&#123;&quot;uid&quot;: str(uid), &quot;maxCount&quot;:int(topn_value)&#125;) # å…¶æ¬¡æ ¹æ®ä¼ å…¥çš„æ–‡æœ¬å¯¹è§†é¢‘ç‰‡æ®µè¿›è¡Œæœç´¢    data = [&#123;&quot;text&quot;: doc.text,&quot;matches&quot;: doc.matches.to_dict()&#125; for doc in resp] # å¾—åˆ°æ¯ä¸ªæ–‡æœ¬å¯¹åº”çš„ç›¸ä¼¼è§†é¢‘ç‰‡æ®µèµ·å§‹ä½ç½®åˆ—è¡¨    return json.dumps(data)# searchsearch_button = st.button(&quot;Search&quot;)if search_button: # åˆ¤æ–­æ˜¯å¦ç‚¹å‡»æœç´¢æŒ‰é’®    if uploaded_file is not None: # åˆ¤æ–­æ˜¯å¦ä¸Šä¼ è§†é¢‘æ–‡ä»¶        if text_prompt == None or text_prompt == &quot;&quot;: # åˆ¤æ–­æ˜¯å¦è¾“å…¥æŸ¥è¯¢æ–‡æœ¬            st.warning(&#39;Please input the description first!&#39;)        else:            if topn_value == None or topn_value == &quot;&quot;: # å¦‚æœæ²¡æœ‰è¾“å…¥ top k åˆ™é»˜è®¤è®¾ç½®ä¸º1                topn_value = 1            with st.spinner(&quot;Processing...&quot;):                result = search_clip(uid, video_file_path, text_prompt, topn_value)                 result = json.loads(result) # è§£æå¾—åˆ°çš„ç»“æœ                for i in range(len(result)):                    matchLen = len(result[i][&#39;matches&#39;])                    for j in range(matchLen):                        print(j)                        left = result[i][&#39;matches&#39;][j][&#39;tags&#39;][&#39;leftIndex&#39;] # è§†é¢‘ç‰‡æ®µçš„å¼€å§‹ä½ç½®                        right = result[i][&#39;matches&#39;][j][&#39;tags&#39;][&#39;rightIndex&#39;] # è§†é¢‘ç‰‡æ®µçš„ç»“æŸä½ç½®                        print(left)                        print(right)                        start_t = getTime(left) # å°†å…¶è½¬æ¢ä¸ºæ ‡å‡†æ—¶é—´                        output = VIDEO_PATH + &quot;/videos/clip&quot; + str(j) +&quot;.mp4&quot;                        cutVideo(start_t,right-left, video_file_path, output) # å¯¹è§†é¢‘è¿›è¡Œåˆ‡åˆ†                        st.video(output) #å°†è§†é¢‘æ˜¾ç¤ºåˆ°å‰ç«¯ç•Œé¢                st.success(&quot;Done!&quot;)    else:        st.warning(&#39;Please upload video first!&#39;)</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬ç¯‡æ–‡ç« æ˜¯è·¨æ¨¡æ€æ£€ç´¢å·¥å…· VCED ä»‹ç»çš„ç¬¬å››ç¯‡ï¼Œå³å°†æ­æ™“ç¬¬ä¸€ç¯‡ä¸­ demo çš„å‰ç«¯éƒ¨åˆ†æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨ python + Streamlit å·¥å…·å¿«é€Ÿå¼€å‘ä¸€ä¸ªå‰ç«¯ç•Œé¢ã€‚&lt;/p&gt;
&lt;!--more---&gt;
&lt;p&gt;Streamlit æ˜¯ä¸€ä¸ªåŸºäº Python çš„ W</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="VCED" scheme="https://superlova.github.io/tags/VCED/"/>
    
    <category term="multimodal" scheme="https://superlova.github.io/tags/multimodal/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘Ernie æ¨¡å‹</title>
    <link href="https://superlova.github.io/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Ernie-%E6%A8%A1%E5%9E%8B/"/>
    <id>https://superlova.github.io/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Ernie-%E6%A8%A1%E5%9E%8B/</id>
    <published>2022-11-20T08:42:47.000Z</published>
    <updated>2022-11-20T17:38:52.854Z</updated>
    
    <content type="html"><![CDATA[<!--more---><p>æ–‡å¿ƒå¤§æ¨¡å‹ERNIEæ˜¯ç™¾åº¦å‘å¸ƒçš„äº§ä¸šçº§çŸ¥è¯†å¢å¼ºå¤§æ¨¡å‹ã€‚</p><p><a href="https://github.com/PaddlePaddle/ERNIE">https://github.com/PaddlePaddle/ERNIE</a></p><h2 id="Roadmap"><a href="#Roadmap" class="headerlink" title="Roadmap"></a>Roadmap</h2><div class="table-container"><table><thead><tr><th>æ—¶é—´</th><th>å‘å¸ƒæ¨¡å‹</th></tr></thead><tbody><tr><td>2019.3.16</td><td>ERNIE 1.0</td></tr><tr><td>2019.7.7</td><td>ERNIE 2.0</td></tr><tr><td>2021.5.20</td><td>å¤šç²’åº¦è¯­è¨€çŸ¥è¯†æ¨¡å‹ ERNIE-Gramã€è¶…é•¿æ–‡æœ¬åŒå‘å»ºæ¨¡é¢„è®­ç»ƒæ¨¡å‹ERNIE-Doc ï¼Œä»¥åŠå…¶ä»–å›¾æ–‡å¤šæ¨¡æ€æ¨¡å‹</td></tr><tr><td>2021.12.3</td><td>å¤šè¯­è¨€ ERNIE-M</td></tr><tr><td>2022.5.20</td><td>ERNIE 3.0 ç³»åˆ—: 110Må‚æ•°é€šç”¨æ¨¡å‹ERNIE 3.0 Baseã€280Må‚æ•°é‡é‡çº§é€šç”¨æ¨¡å‹ERNIE 3.0 XBaseã€74Mè½»é‡çº§é€šç”¨æ¨¡å‹ERNIE 3.0 Medium</td></tr></tbody></table></div><h2 id="Ernie-1-0"><a href="#Ernie-1-0" class="headerlink" title="Ernie 1.0"></a>Ernie 1.0</h2><p>Ernie: Enhanced representation through knowledge integration</p><p>ç›¸è¾ƒäº BERTï¼ŒErnie 1.0 åœ¨æ¨¡å‹ç»“æ„ä¸Šæ²¡æœ‰æ”¹åŠ¨ï¼Œéƒ½æ˜¯é‡‡ç”¨è‹¥å¹² Transformer çš„ Encoder ç»“æ„ã€‚</p><p>Ernie 1.0 çš„æ”¹åŠ¨åœ¨é¢„è®­ç»ƒä»»åŠ¡ã€‚</p><h3 id="1-Knowledge-Masking"><a href="#1-Knowledge-Masking" class="headerlink" title="1. Knowledge Masking"></a>1. Knowledge Masking</h3><p>BERT çš„é¢„è®­ç»ƒé‡‡ç”¨ masked language-modelï¼ˆMLMï¼‰çš„æ–¹æ³•ï¼Œå³åœ¨è®­ç»ƒçš„æ—¶å€™éšå³ä»è¾“å…¥é¢„æ–™ä¸Šmaskæ‰ä¸€äº›å•è¯ï¼Œç„¶åé€šè¿‡çš„ä¸Šä¸‹æ–‡é¢„æµ‹è¿™äº›å•è¯ï¼Œè¯¥ä»»åŠ¡éå¸¸åƒæˆ‘ä»¬åœ¨ä¸­å­¦æ—¶æœŸç»å¸¸åšçš„å®Œå½¢å¡«ç©ºï¼›ä»¥åŠNext Sentence Predictionï¼ˆNSPï¼‰çš„æ–¹æ³•ï¼Œå³åˆ¤æ–­è¿ä¸ªå¥å­æ˜¯å¦æ˜¯å…·æœ‰å‰åé¡ºæ‰¿å…³ç³»çš„ä¸¤å¥è¯ã€‚</p><p>ERNIEæå‡ºäº†<code>Knowledge Masking</code>çš„ç­–ç•¥ï¼Œå…¶åŒ…å«ä¸‰ä¸ªçº§åˆ«ï¼šERNIEå°†Knowledgeåˆ†æˆäº†ä¸‰ä¸ªç±»åˆ«ï¼š<code>tokençº§åˆ«(Basic-Level)</code>ã€<code>çŸ­è¯­çº§åˆ«(Phrase-Level)</code> å’Œ <code>å®ä½“çº§åˆ«(Entity-Level)</code>ã€‚é€šè¿‡å¯¹è¿™ä¸‰ä¸ªçº§åˆ«çš„å¯¹è±¡è¿›è¡ŒMaskingï¼Œæé«˜æ¨¡å‹å¯¹å­—è¯ã€çŸ­è¯­çš„çŸ¥è¯†ç†è§£ã€‚</p><p>Basic-Level Masking å°±æ˜¯æœ€åŸºç¡€çš„ masking ä»»åŠ¡ï¼Œå’Œ BERT ä¸€æ ·ï¼Œéšæœºé€‰å–æŸäº›å•è¯è¿›è¡Œ maskï¼Œä»¤æ¨¡å‹æ¥é¢„æµ‹è¿™äº› mask æ˜¯ä»€ä¹ˆè¯ã€‚</p><p>Phrase-Level Masking æ˜¯å¯¹è¯­å¥ä¸­çš„çŸ­è¯­è¿›è¡Œ maskingï¼Œå¦‚ a series ofï¼›</p><p>Entity-Level Masking æ˜¯å¯¹è¯­å¥ä¸­çš„å®ä½“è¯è¿›è¡Œ maskingï¼Œå¦‚äººå J. K. Rowlingã€‚</p><p><img src="/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Ernie-%E6%A8%A1%E5%9E%8B/knowledge_masking.png" alt></p><h3 id="2-Dialogue-Language-Model"><a href="#2-Dialogue-Language-Model" class="headerlink" title="2. Dialogue Language Model"></a>2. Dialogue Language Model</h3><p>åœ¨ Bert å·²æœ‰çš„é¢„è®­ç»ƒä»»åŠ¡ä¸­ï¼ŒåŠ å…¥äº† Dialogue Language Model ä»»åŠ¡ï¼Œä½¿ ERNIE å­¦ä¹ åˆ°å¯¹è¯ä¸­çš„éšå«å…³ç³»ï¼Œå¢åŠ æ¨¡å‹çš„è¯­ä¹‰è¡¨è¾¾èƒ½åŠ›ã€‚</p><p>åœ¨ç”Ÿæˆé¢„è®­ç»ƒæ•°æ®çš„æ—¶å€™ï¼Œæœ‰ä¸€å®šå‡ ç‡ç”¨å¦å¤–çš„å¥å­æ›¿ä»£é‡Œé¢çš„é—®é¢˜å’Œç­”æ¡ˆï¼Œæ‰€ä»¥æ¨¡å‹è¿˜è¦é¢„æµ‹æ˜¯å¦æ˜¯çœŸå®çš„é—®ç­”å¯¹ã€‚</p><p><img src="/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Ernie-%E6%A8%A1%E5%9E%8B/dialogue_language_model.png" alt></p><p>DLM ä¸­ï¼Œä¸å†æ„å»ºå¦‚åŒ â€œ[CLS] + Sentence_A + [SEP] + Sentence_B + [SEP]â€ çš„å¥å­å¯¹ï¼Œ</p><p>è€Œæ˜¯å¦‚åŒ â€œ[CLS] + Query + [SEP] + Response_A + [SEP] + Response_B + [SEP]â€ çš„å¯¹è¯ä¸‰å…ƒç»„ï¼›</p><p>æ˜¯å¦ä¸Šä¸‹æ–‡è¿ç»­çš„äºŒåˆ†ç±»è®­ç»ƒç›®æ ‡è½¬ä¸ºé¢„æµ‹è¯¥å¯¹è¯æ˜¯å¦çœŸå® (real/fake)ã€‚</p><p>ä¸‰å…ƒç»„éšæœºåœ°é‡‡ç”¨ QRQã€QRRã€QQR å…¶ä¸­ä¸€ç§æ„å»ºå½¢å¼ï¼Œä¸Šé¢çš„ä¾‹å­ä¾¿æ˜¯å…¶ä¸­çš„ QRRã€‚</p><p>ä¸ºäº†ç»™å¤„ç†åçš„æ•°æ®æ·»åŠ å™ªå£°ï¼Œéƒ¨åˆ†çš„ Query å’Œ Response ä½¿ç”¨ä¸ç›¸å…³çš„è¯­å¥è¿›è¡Œéšæœºæ›¿æ¢ï¼Œä»¥å¼ºåˆ¶æ¨¡å‹å­¦ä¹ å¯¹è¯ä¸­çš„è¯­å¢ƒå…³è”ã€‚</p><p>åœ¨è®­ç»ƒä¸€èˆ¬è¯­æ–™æ—¶ï¼ŒERNIE é‡‡ç”¨ Knowledge Masking Strategies æ”¹é€ åçš„ Masked LMï¼›è€Œåœ¨è®­ç»ƒå¯¹è¯å‹è¯­æ–™æ—¶ï¼ŒERNIE é‡‡ç”¨ DLMï¼›ä¸¤è€…äº¤æ›¿ä½¿ç”¨ã€‚</p><h3 id="3-æ·»åŠ æ•°æ®"><a href="#3-æ·»åŠ æ•°æ®" class="headerlink" title="3. æ·»åŠ æ•°æ®"></a>3. æ·»åŠ æ•°æ®</h3><p>Ernie è¿˜é‡‡ç”¨å¤šä¸ªæ¥è‡ªä¸åŒæºå¤´çš„æ•°æ®ï¼Œæ¯”å¦‚ç™¾åº¦è´´å§ï¼Œç™¾åº¦æ–°é—»ï¼Œç»´åŸºç™¾ç§‘ç­‰ç­‰å¸®åŠ©æ¨¡å‹è®­ç»ƒã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://blog.csdn.net/u011150266/article/details/116479149">https://blog.csdn.net/u011150266/article/details/116479149</a></p><p><a href="https://www.cnblogs.com/shona/p/11820492.html">https://www.cnblogs.com/shona/p/11820492.html</a></p><h2 id="Ernie-2-0"><a href="#Ernie-2-0" class="headerlink" title="Ernie 2.0"></a>Ernie 2.0</h2><p>Ernie 2.0: A continual pre-training framework for language understanding</p><h3 id="1-æ€»ä½“æ”¹åŠ¨"><a href="#1-æ€»ä½“æ”¹åŠ¨" class="headerlink" title="1. æ€»ä½“æ”¹åŠ¨"></a>1. æ€»ä½“æ”¹åŠ¨</h3><p>ERNIE 2.0 å°† 1.0 ç‰ˆæœ¬ä¸­çš„åŠŸèƒ½ç‰¹æ€§å…¨éƒ¨äºˆä»¥ä¿ç•™ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šåšæ›´ä¸ºä¸°å¯Œçš„æ‰©å±•å’Œå»¶ä¼¸ã€‚</p><p>Ernie 2.0 æ·»åŠ äº†å¾ˆå¤šå…¶ä»–çš„è‡ªç›‘ç£å­¦ä¹ æ–¹æ³•è¿›è¡Œè®­ç»ƒã€‚è¯¥æ€æƒ³ä¸ ALBERTï¼ˆSOPï¼‰ã€SpanBERTï¼ˆSBOï¼‰ç±»ä¼¼ã€‚</p><p>ä½†æ˜¯ä¸€å‘³å †å ä»»åŠ¡å¯èƒ½å¯¼è‡´å„ç§ä»»åŠ¡éƒ½å­¦ä¸å¥½ï¼ŒErnie 2.0 æå‡ºäº†ä¸€ä¸ªæŒç»­å­¦ä¹ çš„æ¡†æ¶ï¼Œæ¨¡å‹å¯ä»¥æŒç»­æ·»åŠ ä»»åŠ¡ä½†åˆä¸é™ä½ä¹‹å‰ä»»åŠ¡çš„ç²¾åº¦ã€‚</p><p>ç›®æ ‡æ˜¯èƒ½å¤Ÿæ›´å¥½æ›´æœ‰æ•ˆåœ°è·å¾—è¯æ³•lexicalï¼Œå¥æ³•syntacticï¼Œè¯­ä¹‰semanticä¸Šçš„è¡¨è¾¾ã€‚</p><p><img src="/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Ernie-%E6%A8%A1%E5%9E%8B/ernie2_0_structure.png" alt></p><h3 id="2-æ·»åŠ é¢„è®­ç»ƒä»»åŠ¡"><a href="#2-æ·»åŠ é¢„è®­ç»ƒä»»åŠ¡" class="headerlink" title="2. æ·»åŠ é¢„è®­ç»ƒä»»åŠ¡"></a>2. æ·»åŠ é¢„è®­ç»ƒä»»åŠ¡</h3><p><strong>1ï¼‰Word-aware Pretraining Tasks</strong>ï¼Œæ•æ‰è¯æ±‡ (lexical) çº§åˆ«çš„ä¿¡æ¯</p><p>Knowledge Masking Taskï¼šæ²¿è¢­ ERNIE 1.0 ä¸­çš„ Knowledge Masking Strategiesï¼Œé¢„æµ‹è¢« Mask çš„å¯¹è±¡ã€‚</p><p>Capitalization Prediction Taskï¼šé¢„æµ‹å¯¹è±¡æ˜¯å¦å¤§å°å†™ (cased/uncased)ï¼›ERNIE 2.0 è®¤ä¸ºå¤§å†™å¼€å¤´çš„è¯æ±‡å…·å¤‡ç‰¹å®šçš„å«ä¹‰ï¼Œä¾‹å¦‚äººåã€åœ°åã€æœºæ„åç­‰ï¼Œè¿™å°†å¯¹å‘½åå®ä½“è¯†åˆ«ä¸€ç±»çš„ä¸‹æ¸¸ä»»åŠ¡æœ‰æ‰€å¸®åŠ©ã€‚</p><p>Token-Document Relation Prediction Taskï¼šé¢„æµ‹å¯¹è±¡æ˜¯å¦åœ¨æ–‡æ¡£ä¸­å…¶ä»–æ–‡æ®µæœ‰å‡ºç°ï¼›æ­£æ¡ˆä¾‹é€šå¸¸åŒ…å«æ–‡æ¡£çš„å…³é”®è¯ä»¥åŠè¯­è¨€é€šç”¨è¯ï¼Œå› æ­¤æ·»åŠ è¿™ä¸€ä»»åŠ¡æœ‰åŠ©äºæ¨¡å‹å°†æ›´å¤šçš„æ³¨æ„åŠ›æ”¾åœ¨è¿™ä¸€ç±»è¯æ±‡ä¸Šã€‚</p><p><strong>2ï¼‰Structure-aware Pretraining Tasks</strong>ï¼Œæ•æ‰è¯­æ–™ä¸­è¯­æ³• (syntactic) çº§åˆ«çš„ä¿¡æ¯</p><p>Sentence Recording Taskï¼šé’ˆå¯¹æ–‡æ¡£ä¸­çš„æ¯ä¸€ä¸ªæ®µè½ï¼Œä»¥å¥å­ä¸ºå•ä½åˆ’åˆ†ä¸º 1~m æ®µï¼Œè€Œåå¯¹æ•´ä¸ªæ–‡æ¡£æ‰€æœ‰æ–‡æ®µè¿›è¡Œæ‰“ä¹±æ’åˆ—ï¼Œå¯¹æ¯ä¸€ä¸ªæ–‡æ®µé¢„æµ‹åŸå§‹ä½ç½®ï¼Œæˆä¸º k åˆ†ç±»é—®é¢˜ã€‚</p><p>Sentence Distance Taskï¼šå–ä»£ Next Sentence Predictionï¼Œé¢„æµ‹è¾“å…¥å¥å­å¯¹çš„ç›¸å¯¹è·ç¦»ï¼›ä¸‰åˆ†ç±»é—®é¢˜ï¼Œ0 ä»£è¡¨ä¸¤ä¸ªå¥å­åœ¨åŒä¸€ç¯‡æ–‡æ¡£ä¸”è·ç¦»ç›¸è¿‘ï¼Œ1 ä»£è¡¨ä¸¤ä¸ªå¥å­åœ¨åŒä¸€ç‰‡æ–‡æ¡£ä½†è·ç¦»è¾ƒè¿œï¼Œ2 ä»£è¡¨ä¸¤ä¸ªå¥å­åœ¨ä¸åŒæ–‡æ¡£ã€‚</p><p><strong>3ï¼‰Semantic-aware Pretraining Tasks</strong>ï¼Œæå–è¯­ä¹‰ (semantic) ç±»çš„ä¿¡æ¯</p><p>Discourse Relation Taskï¼šé¢„æµ‹ä¸¤ä¸ªå¥å­ä¹‹é—´çš„è¯­æ³•åŠä¿®è¾å…³è”ã€‚</p><p><img src="/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Ernie-%E6%A8%A1%E5%9E%8B/discourse_relation_task.png" alt></p><p>IR Relevance Taskï¼šä¸“é—¨ä¸ºç™¾åº¦æœç´¢å¼•æ“æ—¥å¿—è®¾è®¡çš„ä»»åŠ¡ï¼Œé¢„æµ‹ Query-Title å¯¹çš„ç›¸å…³æ€§ï¼›ä¸‰åˆ†ç±»é—®é¢˜ï¼Œ0ã€1ã€2 åˆ†åˆ«ä»£è¡¨å¼ºç›¸å…³ã€å¼±ç›¸å…³ä»¥åŠä¸ç›¸å…³ï¼›è¿™å°†æœ‰åŠ©äºæ ‡é¢˜è‡ªåŠ¨ç”Ÿæˆä»¥åŠæ–‡æœ¬æ‘˜è¦ç±»ä»»åŠ¡ã€‚</p><h3 id="3-é¢„è®­ç»ƒæ¡†æ¶"><a href="#3-é¢„è®­ç»ƒæ¡†æ¶" class="headerlink" title="3. é¢„è®­ç»ƒæ¡†æ¶"></a>3. é¢„è®­ç»ƒæ¡†æ¶</h3><p>ä»»åŠ¡å åŠ ï¼Œä¸æ˜¯ä¸€æ¬¡æ€§è¿›è¡Œçš„ï¼ˆMulti-task learningï¼‰ï¼Œè€Œæ˜¯æŒç»­å­¦ä¹ (Continual Pre-training)ï¼Œæ‰€ä»¥å¿…é¡»é¿å…æ¨¡å‹åœ¨å­¦äº†æ–°çš„ä»»åŠ¡ä¹‹åï¼Œå¿˜è®°æ—§çš„ä»»åŠ¡ï¼Œå³åœ¨æ—§çš„ä»»åŠ¡ä¸Šlosså˜é«˜ã€‚</p><p>ä¸ºæ­¤ï¼ŒERNIE 2.0 é¦–æ¬¡å¼•å…¥ è¿ç»­é¢„è®­ç»ƒæœºåˆ¶ â€”â€” ä»¥ä¸²è¡Œçš„æ–¹å¼è¿›è¡Œå¤šä»»åŠ¡å­¦ä¹ ã€‚</p><p>3ã€Sequential Multi-task Learningï¼šERNIE 2.0ä¸­æ–°æå‡ºçš„æ–¹æ³•ï¼Œæ¯å½“æœ‰æ–°ä»»åŠ¡å‡ºç°æ—¶ï¼Œä½¿ç”¨å…ˆå‰å­¦ä¹ çš„å‚æ•°æ¥åˆå§‹åŒ–æ¨¡å‹ï¼Œå¹¶åŒæ—¶è®­ç»ƒæ–°å¼•å…¥çš„ä»»åŠ¡å’ŒåŸå§‹ä»»åŠ¡ã€‚è¿™æ ·è§£å†³äº†å‰ä¸¤ç§æ–¹æ³•çš„é—®é¢˜ï¼Œå¯ä»¥éšæ—¶å¼•å…¥æ–°ä»»åŠ¡ï¼Œå¹¶ä¿ç•™å…ˆå‰å­¦åˆ°çš„çŸ¥è¯†ã€‚</p><p><img src="/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Ernie-%E6%A8%A1%E5%9E%8B/ernie2_0_framework.png" alt></p><h3 id="å‚è€ƒ-1"><a href="#å‚è€ƒ-1" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://blog.csdn.net/qq_35386727/article/details/105947650">https://blog.csdn.net/qq_35386727/article/details/105947650</a></p><p><a href="https://zhuanlan.zhihu.com/p/460151166">https://zhuanlan.zhihu.com/p/460151166</a></p><p><a href="https://blog.csdn.net/weixin_43269174/article/details/98437096">https://blog.csdn.net/weixin_43269174/article/details/98437096</a></p><p><a href="https://www.jiqizhixin.com/articles/2020-04-28-3">https://www.jiqizhixin.com/articles/2020-04-28-3</a></p><p><a href="https://aijishu.com/a/1060000000199742">https://aijishu.com/a/1060000000199742</a></p><h2 id="Ernie-gram-å’Œ-Ernie-doc"><a href="#Ernie-gram-å’Œ-Ernie-doc" class="headerlink" title="Ernie gram å’Œ Ernie doc"></a>Ernie gram å’Œ Ernie doc</h2><p>ERNIE-Gram: Pre-Training with Explicitly N-Gram Masked Language Modeling for Natural Language Understanding</p><p>ERNIE-Doc: A Retrospective Long-Document Modeling TransformerÂ¶</p><h3 id="1-Ernie-Gram-çš„æ”¹è¿›"><a href="#1-Ernie-Gram-çš„æ”¹è¿›" class="headerlink" title="1. Ernie-Gram çš„æ”¹è¿›"></a>1. Ernie-Gram çš„æ”¹è¿›</h3><p>å¾ˆç®€å•ï¼Œå³åœ¨ MLM ä»»åŠ¡ä¸­ï¼ŒæŠŠæœ€å° mask å•ä½ä»å­—ç²’åº¦å˜æˆ n-gram ç²’åº¦ã€‚è¿™æ ·åšçš„ç†ç”±æ˜¯åŸæœ‰çš„ masking ç²’åº¦å¤ªç»†äº†ï¼Œåˆ‡åˆ†çš„æ—¶å€™å®¹æ˜“ç ´åè¯­ä¹‰å®Œæ•´æ€§ã€‚</p><p>å› æ­¤ Ernie-Gram ç›´æ¥å»é¢„æµ‹ä¸€ä¸ªn-gramè¯ï¼Œè€Œä¸æ˜¯é¢„æµ‹ä¸€ç³»åˆ—è¿ç»­çš„tokenï¼Œä»è€Œä¿è¯n-gramè¯çš„è¯­ä¹‰å®Œæ•´æ€§ã€‚</p><p>ERNIE-Gramä¸»è¦æå‡ºäº†ä¸¤ç§èåˆæ–¹å¼ï¼šExplictly N-gram MLM å’Œ Comprehensive N-gram Predictionã€‚</p><p>æ­¤å¤–ï¼ŒErnie-Gram è¿˜ä½¿ç”¨äº†RTDé¢„è®­ç»ƒä»»åŠ¡ï¼Œæ¥è¯†åˆ«æ¯ä¸ªtokenæ˜¯å¦æ˜¯ç”Ÿæˆçš„ã€‚</p><h3 id="2-Ernie-Doc-çš„æ”¹è¿›"><a href="#2-Ernie-Doc-çš„æ”¹è¿›" class="headerlink" title="2. Ernie-Doc çš„æ”¹è¿›"></a>2. Ernie-Doc çš„æ”¹è¿›</h3><p>Ernie-Doc å¯ä»¥å¯¹æ›´é•¿çš„è¾“å…¥åºåˆ—è¿›è¡Œå»ºæ¨¡ã€‚</p><h3 id="å‚è€ƒ-2"><a href="#å‚è€ƒ-2" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://zhuanlan.zhihu.com/p/376000666">https://zhuanlan.zhihu.com/p/376000666</a></p><p><a href="https://blog.csdn.net/jokerxsy/article/details/116482035">https://blog.csdn.net/jokerxsy/article/details/116482035</a></p><p><a href="https://www.sohu.com/a/468508378_129720">https://www.sohu.com/a/468508378_129720</a></p><p><a href="https://paddlepedia.readthedocs.io/en/latest/tutorials/pretrain_model/ERNIE-Gram.html">https://paddlepedia.readthedocs.io/en/latest/tutorials/pretrain_model/ERNIE-Gram.html</a></p><h2 id="Ernie-3-0"><a href="#Ernie-3-0" class="headerlink" title="Ernie 3.0"></a>Ernie 3.0</h2><p>ERNIE 3.0: Large-scale Knowledge Enhanced Pre-training for Language Understanding and Generation</p><p>ERNIE 3.0åŒæ—¶ç»“åˆäº†å°†è‡ªå›å½’å’Œè‡ªç¼–ç ç½‘ç»œï¼Œä»è€Œæ¨¡å‹åœ¨æ–‡æœ¬ç”Ÿæˆå’Œè¯­è¨€ç†è§£ä»»åŠ¡è¡¨ç°å‡å¾ˆå¥½ã€‚å¦å¤–ï¼ŒERNiE 3.0åœ¨é¢„è®­ç»ƒé˜¶æ®µä¸­å¼•å…¥äº†çŸ¥è¯†å›¾è°±æ•°æ®ã€‚</p><h3 id="1-ç½‘ç»œç»“æ„æ”¹è¿›"><a href="#1-ç½‘ç»œç»“æ„æ”¹è¿›" class="headerlink" title="1. ç½‘ç»œç»“æ„æ”¹è¿›"></a>1. ç½‘ç»œç»“æ„æ”¹è¿›</h3><p>ERNIE 3.0è®¾è®¡äº†ä¸Šä¸‹ä¸¤å±‚ç½‘ç»œç»“æ„ï¼šUniversal Representation Module å’Œ Task-specific Representation Moduleã€‚</p><p><img src="/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Ernie-%E6%A8%A1%E5%9E%8B/ernie3_0_structure.png" alt></p><p>åœ¨æ¨¡å‹åº•å±‚ç»“æ„ä¸Šå…±äº«å‚æ•°ï¼Œç”¨äºè·å–è¯æ±‡ã€å¥æ³•ç­‰é€šç”¨çš„æŠ½è±¡ç‰¹å¾ï¼›åœ¨é¡¶å±‚å¯¹ä¸åŒä»»åŠ¡ä½¿ç”¨ç‹¬ç«‹å‚æ•°ï¼Œç”¨äºè·å–ç‰¹å®šä»»åŠ¡çš„ç‰¹å¾ã€‚</p><p>ERNIE 3.0è®¤ä¸ºä¸åŒçš„ä»»åŠ¡æ¨¡å¼ä¾èµ–çš„è‡ªç„¶è¯­è¨€çš„åº•å±‚ç‰¹å¾æ˜¯ç›¸åŒçš„ï¼Œæ¯”å¦‚è¯æ³•å’Œå¥æ³•ä¿¡æ¯ï¼Œç„¶è€Œä¸åŒçš„ä»»åŠ¡æ¨¡å¼éœ€è¦çš„ä¸Šå±‚å…·ä½“çš„ç‰¹å¾æ˜¯ä¸åŒçš„ã€‚è‡ªç„¶è¯­è¨€ç†è§£çš„ä»»åŠ¡å¾€å¾€å€¾å‘äºå­¦ä¹ è¯­ä¹‰è¿è´¯æ€§ï¼Œç„¶è€Œè‡ªç„¶è¯­ä¹‰ç”Ÿæˆä»»åŠ¡å´æœŸæœ›èƒ½å¤Ÿçœ‹è§æ›´é•¿çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p><p>ç”±äºè‡ªå›å½’æ¨¡å‹åœ¨æ–‡æœ¬ç”Ÿæˆä»»åŠ¡ä¸Šè¡¨ç°æ›´å¥½ï¼Œè‡ªç¼–ç æ¨¡å‹åœ¨è¯­è¨€ç†è§£ä»»åŠ¡ä¸Šè¡¨ç°æ›´å¥½ã€‚å› æ­¤ï¼ŒERNIE 3.0åœ¨ä¸Šå±‚ä½¿ç”¨äº†ä¸¤ä¸ªç½‘ç»œï¼Œä¸€ä¸ªç”¨äºèšç„¦è‡ªç„¶è¯­è¨€ç†è§£ï¼Œä¸€ä¸ªç”¨äºèšç„¦è‡ªç„¶è¯­è¨€ç”Ÿæˆä»»åŠ¡ã€‚ä¸åŒä»»åŠ¡é€‚é…æ›´åˆé€‚çš„ç½‘ç»œï¼Œèƒ½å¤Ÿæé«˜æ¨¡å‹åœ¨ç›¸åº”ä»»åŠ¡ä¸Šçš„è¡¨ç°ã€‚</p><p>åœ¨fine-tuningé˜¶æ®µï¼Œå¯ä»¥å›ºå®šUniversal Representation Moduleï¼Œåªå¾®è°ƒTask-specific Representation Moduleå‚æ•°ï¼Œæé«˜è®­ç»ƒæ•ˆç‡ã€‚</p><p><strong>1ï¼‰Universal Representation Module</strong></p><p>ä½¿ç”¨Transformer-XLä½œä¸ºéª¨å¹²ç½‘ç»œï¼ŒTransformer-XLå…è®¸æ¨¡å‹ä½¿ç”¨è®°å¿†å¾ªç¯æœºåˆ¶å»ºæ¨¡æ›´é•¿çš„æ–‡æœ¬åºåˆ—ä¾èµ–ã€‚</p><p>Transformer-XL åœ¨æ™®é€š transformer åŸºç¡€ä¸Šå¢åŠ äº†ä¸€ä¸ª recurrence memory module ç”¨äºå»ºæ¨¡é•¿æ–‡æœ¬ï¼Œé¿å…äº†æ™®é€š transformer ä¸­ç”±äºè¾“å…¥é•¿åº¦é™åˆ¶ï¼Œä¸å¾—ä¸å¯¹é•¿æ–‡æœ¬è¿›è¡Œåˆ‡åˆ†ä»è€Œå¯¼è‡´æŸå¤±é•¿è·ç¦»ä¾èµ–çš„é—®é¢˜ã€‚</p><p><strong>2ï¼‰Task-specific Representation Module</strong></p><p>åŒæ ·ä½¿ç”¨äº†Transformer-XLä½œä¸ºéª¨å¹²ç½‘ç»œï¼Œä½†ä½¿ç”¨äº†base sizeæ¨¡å‹ã€‚</p><h3 id="2-å¼•å…¥æ–°çš„é¢„è®­ç»ƒä»»åŠ¡"><a href="#2-å¼•å…¥æ–°çš„é¢„è®­ç»ƒä»»åŠ¡" class="headerlink" title="2. å¼•å…¥æ–°çš„é¢„è®­ç»ƒä»»åŠ¡"></a>2. å¼•å…¥æ–°çš„é¢„è®­ç»ƒä»»åŠ¡</h3><p>é™¤äº† Ernie 2.0 å¼•å…¥çš„å¾ˆå¤šä¸ªé¢„è®­ç»ƒä»»åŠ¡ä¹‹å¤–ï¼ŒErnie 3.0 è¿˜å¢åŠ äº† universal knowledge-text predictionï¼ˆUKTPï¼‰ä»»åŠ¡</p><p>ç»™å®šä¸€ä¸ªä¸‰å…ƒç»„\<head, relation, tail\>å’Œä¸€ä¸ªå¥å­ï¼ŒERNIE 3.0ä¼šmaskæ‰ä¸‰å…ƒç»„ä¸­çš„å®ä½“å…³ç³»relationï¼Œæˆ–è€…å¥å­ä¸­çš„å•è¯wordï¼Œç„¶åè®©æ¨¡å‹å»é¢„æµ‹è¿™äº›å†…å®¹ã€‚</head,></p><p>æ¨¡å‹åœ¨é¢„æµ‹ä¸‰å…ƒç»„ä¸­çš„å…³ç³»æ—¶ï¼Œéœ€è¦æ‰¾åˆ°å¯¹åº”å¥å­ä¸­çš„headå’Œtailè¯å¹¶ç¡®å®šä»–ä»¬ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ï¼›è€Œæ¨¡å‹åœ¨é¢„æµ‹å¥å­ä¸­çš„è¯æ—¶ï¼Œåˆ™éœ€è¦åŒæ—¶è€ƒè™‘å¥å­ä¸­çš„ä¾å­˜ä¿¡æ¯ (dependency information) å’Œä¸‰å…ƒç»„ä¸­çš„é€»è¾‘å…³ç³» (logical relationship)ã€‚</p><p>è¿™ä¸ªä»»åŠ¡ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å‡è®¾ï¼šå¦‚æœä¸€ä¸ªå¥å­ä¸­åŒæ—¶å‡ºç°headå’Œtailä¸¤ä¸ªå®ä½“ï¼Œåˆ™è¿™ä¸ªå¥å­èƒ½å¤Ÿè¡¨è¾¾è¿™ä¸¤ä¸ªå®ä½“çš„å…³ç³»ã€‚</p><p><img src="/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Ernie-%E6%A8%A1%E5%9E%8B/universal_knowledge_text_pred.png" alt></p><h3 id="3-é¢„è®­ç»ƒ-Trick"><a href="#3-é¢„è®­ç»ƒ-Trick" class="headerlink" title="3. é¢„è®­ç»ƒ Trick"></a>3. é¢„è®­ç»ƒ Trick</h3><p>ä¸ºäº†åŠ å¿«é¢„è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ¨¡å‹æ”¶æ•›é€Ÿåº¦ï¼Œæœ¬æ–‡æå‡ºäº†é€æ¸å¢åŠ è®­ç»ƒæ­£åˆ™å› å­ (training regularization factor) çš„æ–¹æ³•ã€‚</p><p>å…·ä½“æ¥è¯´å°±æ˜¯åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é€æ­¥ä¸”åŒæ—¶å¢åŠ è¾“å…¥åºåˆ—é•¿åº¦ã€batch sizeã€å­¦ä¹ ç‡å’Œdropout rateã€‚</p><p>åœ¨ä¸€èˆ¬çš„transformerè®­ç»ƒä¸­éƒ½ä¼šä½¿ç”¨warm-upç­–ç•¥é€æ­¥å¢åŠ å­¦ä¹ ç‡ï¼Œæœ¬æ–‡æå‡ºäº†å°†batch sizeç­‰å…¶ä»–å› å­åŒæ—¶å¢åŠ çš„ç­–ç•¥ã€‚</p><h3 id="å‚è€ƒ-3"><a href="#å‚è€ƒ-3" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://alexyxwang.com/2021/12/09/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0-ERNIE-3-0-Large-scale-Knowledge-Enhanced-Pre-training-for-Language-Understanding-and-Generation/">https://alexyxwang.com/2021/12/09/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0-ERNIE-3-0-Large-scale-Knowledge-Enhanced-Pre-training-for-Language-Understanding-and-Generation/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;!--more---&gt;
&lt;p&gt;æ–‡å¿ƒå¤§æ¨¡å‹ERNIEæ˜¯ç™¾åº¦å‘å¸ƒçš„äº§ä¸šçº§çŸ¥è¯†å¢å¼ºå¤§æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/PaddlePaddle/ERNIE&quot;&gt;https://github.com/PaddlePaddle/ERNIE&lt;/a&gt;</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Ernie" scheme="https://superlova.github.io/tags/Ernie/"/>
    
    <category term="BERT" scheme="https://superlova.github.io/tags/BERT/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘NLPæ•°æ®å¢å¼ºæ–¹æ³•è®°å½•</title>
    <link href="https://superlova.github.io/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91NLP%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA%E6%96%B9%E6%B3%95%E8%AE%B0%E5%BD%95/"/>
    <id>https://superlova.github.io/2022/11/20/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91NLP%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA%E6%96%B9%E6%B3%95%E8%AE%B0%E5%BD%95/</id>
    <published>2022-11-20T08:41:35.000Z</published>
    <updated>2022-11-20T11:56:37.363Z</updated>
    
    <content type="html"><![CDATA[<!--more---><h2 id="1-åŸºäºè§„åˆ™çš„æ•°æ®å¢å¼º"><a href="#1-åŸºäºè§„åˆ™çš„æ•°æ®å¢å¼º" class="headerlink" title="1. åŸºäºè§„åˆ™çš„æ•°æ®å¢å¼º"></a>1. åŸºäºè§„åˆ™çš„æ•°æ®å¢å¼º</h2><p><a href="https://mp.weixin.qq.com/s?__biz=Mzk0NzMwNjU5Nw==&amp;mid=2247484450&amp;idx=1&amp;sn=953dd0856ee087d52a9c229f68281eb3&amp;chksm=c379ad28f40e243eade7677e16fb4146a257c32c39d8b364952c061bdba0af02b6a49a8d5cb0&amp;scene=178&amp;cur_album_id=2592122537619554305#rd">https://mp.weixin.qq.com/s?__biz=Mzk0NzMwNjU5Nw==&amp;mid=2247484450&amp;idx=1&amp;sn=953dd0856ee087d52a9c229f68281eb3&amp;chksm=c379ad28f40e243eade7677e16fb4146a257c32c39d8b364952c061bdba0af02b6a49a8d5cb0&amp;scene=178&amp;cur_album_id=2592122537619554305#rd</a></p><p>å¯¹äºåŒä¸€ä¸ªå¥å­ï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„æ•°æ®å¢å¼ºæ–¹æ³•ï¼š</p><ul><li>éšæœºåˆ é™¤ä¸€ä¸ªè¯</li><li>éšæœºé€‰æ‹©ä¸€ä¸ªè¯ï¼Œç”¨å®ƒçš„åŒä¹‰è¯æ›¿æ¢</li><li>éšæœºé€‰æ‹©ä¸¤ä¸ªè¯ï¼Œç„¶åäº¤æ¢å®ƒä»¬çš„ä½ç½®</li><li>éšæœºé€‰æ‹©ä¸€ä¸ªè¯ï¼Œç„¶åéšæœºé€‰æ‹©ä¸€ä¸ªå®ƒçš„è¿‘ä¹‰è¯ï¼Œç„¶åéšæœºæ’å…¥å¥å­çš„ä»»æ„ä½ç½®</li></ul><p>é‡ç‚¹æ˜¯ â€œåŒä¹‰è¯æ›¿æ¢â€ï¼Œåœ¨é—®é¢˜ä¸­é€‰æ‹©ä¸€ä¸ªä¸æ˜¯åœæ­¢è¯çš„è¯ï¼Œå¹¶ç”¨ä¸€ä¸ªéšæœºé€‰æ‹©çš„åŒä¹‰è¯æ¥æ›¿æ¢å®ƒã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨nltk WordNetæ¥äº§ç”ŸåŒä¹‰è¯ï¼Œç”Ÿæˆä¸åŸé—®é¢˜ç­‰ä»·çš„æ–°é—®é¢˜ã€‚è¿™æ ·å°±å¾—åˆ°äº†ä¸€æ¡æ–°è®­ç»ƒæ•°æ®ã€‚</p><p>æˆ–è€…æˆ‘ä»¬è¯†åˆ«å®ä½“åï¼Œé€šè¿‡åä¹‰è¯è¿›è¡Œæ›¿æ¢ï¼Œåˆ™å¾—åˆ°è´Ÿä¾‹ã€‚</p><p>å…ˆä½¿ç”¨è§„åˆ™çš„æ–¹æ³•ä»¤å¯å›ç­”å’Œä¸å¯å›ç­”çš„é—®é¢˜å¹³è¡¡ï¼›åœ¨äºŒè€…ä¹‹é—´è¾¾åˆ°å¹³è¡¡ä¹‹åï¼Œæ•°æ®å¢å¼ºå³å¯ç»“æŸã€‚</p><h2 id="2-ä½¿ç”¨æ¨¡å‹ç”Ÿæˆæ•°æ®"><a href="#2-ä½¿ç”¨æ¨¡å‹ç”Ÿæˆæ•°æ®" class="headerlink" title="2. ä½¿ç”¨æ¨¡å‹ç”Ÿæˆæ•°æ®"></a>2. ä½¿ç”¨æ¨¡å‹ç”Ÿæˆæ•°æ®</h2><p>æˆ‘ä»¬å¸Œæœ›å¾—åˆ°ä¸€ä¸ªç”Ÿæˆæ¨¡å‹ï¼Œå°†æ¯ä¸ªç¯‡ç« ä¸å¯¹åº”çš„é—®é¢˜ä»¥åŠç­”æ¡ˆï¼Œè¾“å…¥ç”Ÿæˆæ¨¡å‹ï¼Œæ¨¡å‹è¾“å‡ºæ–°çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜ä¸ç¯‡ç« å¾ˆç›¸å…³ï¼›æˆ–è€…ç›´æ¥è¾“å‡ºæ–°çš„é—®é¢˜å’Œæ–°çš„ç­”æ¡ˆï¼ˆè¿™ä¸ªæ¯”è¾ƒå›°éš¾ï¼‰ã€‚</p><p>UniLM æ¨¡å‹ï¼š</p><p><a href="https://xv44586.github.io/2020/08/22/qa-augmentation/">https://xv44586.github.io/2020/08/22/qa-augmentation/</a></p><p>GPT-2æ¨¡å‹ï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/146382050">https://zhuanlan.zhihu.com/p/146382050</a></p><p>Pair-to-Sequence æ¨¡å‹ï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/74514486">https://zhuanlan.zhihu.com/p/74514486</a></p><h2 id="3-ä½¿ç”¨å¯¹æŠ—è®­ç»ƒæ–¹æ³•æ‰°åŠ¨è¾“å…¥æ•°æ®"><a href="#3-ä½¿ç”¨å¯¹æŠ—è®­ç»ƒæ–¹æ³•æ‰°åŠ¨è¾“å…¥æ•°æ®" class="headerlink" title="3. ä½¿ç”¨å¯¹æŠ—è®­ç»ƒæ–¹æ³•æ‰°åŠ¨è¾“å…¥æ•°æ®"></a>3. ä½¿ç”¨å¯¹æŠ—è®­ç»ƒæ–¹æ³•æ‰°åŠ¨è¾“å…¥æ•°æ®</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;!--more---&gt;
&lt;h2 id=&quot;1-åŸºäºè§„åˆ™çš„æ•°æ®å¢å¼º&quot;&gt;&lt;a href=&quot;#1-åŸºäºè§„åˆ™çš„æ•°æ®å¢å¼º&quot; class=&quot;headerlink&quot; title=&quot;1. åŸºäºè§„åˆ™çš„æ•°æ®å¢å¼º&quot;&gt;&lt;/a&gt;1. åŸºäºè§„åˆ™çš„æ•°æ®å¢å¼º&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://mp</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Data Augmentation" scheme="https://superlova.github.io/tags/Data-Augmentation/"/>
    
    <category term="NLP" scheme="https://superlova.github.io/tags/NLP/"/>
    
  </entry>
  
  <entry>
    <title>ã€ç«èµ›æ‰“å¡ã€‘ç™¾åº¦æœç´¢ç«èµ›â€”â€”é—®ç­”æŠ½å–èµ›é“</title>
    <link href="https://superlova.github.io/2022/11/20/%E3%80%90%E7%AB%9E%E8%B5%9B%E6%89%93%E5%8D%A1%E3%80%91%E7%99%BE%E5%BA%A6%E6%90%9C%E7%B4%A2%E7%AB%9E%E8%B5%9B%E2%80%94%E2%80%94%E9%97%AE%E7%AD%94%E6%8A%BD%E5%8F%96%E8%B5%9B%E9%81%93/"/>
    <id>https://superlova.github.io/2022/11/20/%E3%80%90%E7%AB%9E%E8%B5%9B%E6%89%93%E5%8D%A1%E3%80%91%E7%99%BE%E5%BA%A6%E6%90%9C%E7%B4%A2%E7%AB%9E%E8%B5%9B%E2%80%94%E2%80%94%E9%97%AE%E7%AD%94%E6%8A%BD%E5%8F%96%E8%B5%9B%E9%81%93/</id>
    <published>2022-11-20T07:58:37.000Z</published>
    <updated>2022-11-22T03:16:43.755Z</updated>
    
    <content type="html"><![CDATA[<p>å…ˆå å‘ï¼Œç­‰æ¯”èµ›ç»“æŸè®°å½•æ¨¡å‹çš„æ€æƒ³</p><!--more---><p>11 æœˆè‡³ 12 æœˆ 15 ä½œå“æäº¤</p><p>ç»™çœ‹è¯¾ç¨‹çš„åŒå­¦ç®—åŠ›ï¼Œ100 å°æ—¶ï¼›fork é¡¹ç›®ã€åˆ›å»ºé¡¹ç›®ï¼Œæå‡ç”¨æˆ·ç­‰çº§ï¼Œä»è€Œè·å–å…è´¹æ—¶é•¿ï¼›ç›¸å½“å¤šå®é™…é¡¹ç›®ï¼›å…¶ä»–æ¯”èµ›ï¼›å…¶ä»–é¡¹ç›®çš„ baseline paddleNLP åœ¨ github</p><p>baselineï¼š<br>èµ›é“ 1 çš„ baseline 5043272 4960090<br>èµ›é“ 2 çš„ baseline TensorRT 5007642</p><p>åºåˆ—æ ‡æ³¨ä»»åŠ¡çš„æ€è·¯ã€QA çš„æ€è·¯</p><h2 id="æ€è·¯-1ï¼šä½¿ç”¨æŠ½å–å¼é—®ç­”æ€è·¯"><a href="#æ€è·¯-1ï¼šä½¿ç”¨æŠ½å–å¼é—®ç­”æ€è·¯" class="headerlink" title="æ€è·¯ 1ï¼šä½¿ç”¨æŠ½å–å¼é—®ç­”æ€è·¯"></a>æ€è·¯ 1ï¼šä½¿ç”¨æŠ½å–å¼é—®ç­”æ€è·¯</h2><h3 id="baseline1-æ°´å“¥"><a href="#baseline1-æ°´å“¥" class="headerlink" title="baseline1: æ°´å“¥"></a>baseline1: æ°´å“¥</h3><p><a href="https://aistudio.baidu.com/aistudio/projectdetail/5029712?forkThirdPart=1">https://aistudio.baidu.com/aistudio/projectdetail/5029712?forkThirdPart=1</a></p><p>notebooké€»è¾‘</p><pre><code>1. æŒ‰ç…§ã€‚åˆ†å¥ï¼Œéœ€è¦ç»Ÿè®¡è¿˜å¯ä»¥æŒ‰ç…§ä»€ä¹ˆè¿›è¡Œåˆ†å¥åˆ‡å‰²2. åˆ é™¤æ–‡æ¡£ä¸­å­˜åœ¨å•å¥è¶…é•¿çš„æ–‡æ¡£ï¼Œè¯¥éƒ¨åˆ†å¯ä»¥æå‡ï¼Œå¯ä»¥çœ‹ä¸€äº› case å†³å®šæ˜¯ç”±äºåˆ†è¯ä¸ä½³è¿˜æ˜¯æ•°æ®è´¨é‡ä½3. å¯¹è¾“å…¥æ•°æ®è¿›è¡Œç¼–ç ï¼Œ3.1 é—®é¢˜+ç­”æ¡ˆé•¿åº¦è¶…è¿‡ 512 çš„ä¼šè¢«è·³è¿‡3.2 è°ƒç”¨ tokenizer.encode æ¥å£ï¼Œå‚æ•° 1 æ˜¯ queryï¼Œå‚æ•° 2 æ˜¯ sentence3.3 ç¡®è®¤ start_pos å’Œ end_posäº§å‡ºçš„æ•°æ®ä¸º&#39;input_ids&#39;, &#39;token_type_ids&#39;, &#39;seq_len&#39;, &#39;attention_mask&#39;, &#39;position_ids&#39;, &#39;start_positions&#39;, &#39;end_positions&#39;4. æ•°æ®æ‰¹é‡æ‰“åŒ…ï¼Œä½¿ç”¨ batch_size = 6ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ batch_size5. è®¾ç½® SGD ä¼˜åŒ–å™¨ï¼Œlearning rate = 0.0005ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ä¼˜åŒ–å™¨ä»¥åŠlearning rateæŸå¤±å‡½æ•°è®¾ç½®ä¸º CrossEntropyLoss6. å¼€å§‹è®­ç»ƒ7. å¯¼å‡ºç»“æœ</code></pre><p>æ­¥éª¤ï¼š</p><ol><li>å…ˆè·‘é€š Fine tune ä¸­æ–‡é¢„è®­ç»ƒæ¨¡å‹</li><li>è°ƒè¯•ä¸€äº›è¶…å‚æ•°ï¼Œbatch_size/learning rate/epoch/ç­‰</li><li>åº”ç”¨å­¦ä¹ ç‡çš„ä¸€äº› trickï¼Œadam/å­¦ä¹ ç‡è¡°å‡ç­‰</li><li>æå‡æ•°æ®é¢„å¤„ç†çš„æ•ˆæœï¼Œä¸åŒåˆ‡åˆ†æ–¹æ³•ã€ä¸åŒå»ºæ¨¡ç›®æ ‡ã€æ•°æ®å¢å¼ºç­‰ï¼›</li><li>å°è¯•ä½¿ç”¨å…¶ä»–é¢„è®­ç»ƒæ¨¡å‹ï¼Œåšæ¨¡å‹è°ƒç ”å¹¶ä¿®æ”¹ï¼›</li><li>æå‡æ•°æ®åå¤„ç†çš„æ•ˆæœï¼Œæ¨¡å‹èåˆç­‰ï¼›</li></ol><p>ä¼šè®®æåˆ°çš„å…¶ä»–æ€æƒ³</p><p>æ•°æ®æ•´ç†æ‰‹æ®µï¼š</p><ol><li>ã€‚åˆ†æ®µ</li><li>æ»‘åŠ¨çª—å£</li></ol><p>ErnieForQuestionAnswering<br>ErnieTokenizer<br>Ernie ç»“æ„</p><p>é¢„å¤„ç†æ–¹æ³•è°ƒç ”<br>ä¸åŒæ¨¡å‹ã€ä¸åŒæ¡†æ¶è°ƒç ”<br>æ¨¡å‹èåˆè°ƒç ”</p><p>SEO çš„æ€è·¯åº”ç”¨åœ¨æ•°æ®å¢å¼º<br>æ··åˆç²¾åº¦<br>warm up</p><p>optimizer<br>xgboost/lightgbm<br>bert å‚æ•°ä¸ªæ•°</p><p>æ°´å“¥çš„ä¼˜åŒ–æ€è·¯ï¼š<br>1ã€ä»–çš„æ–¹æ¡ˆåªä½¿ç”¨äº† 5000 æ¡è®­ç»ƒæ•°æ®ï¼Œåç»­å¯ä»¥ä½¿ç”¨å…¨é‡æ•°æ®ï¼›<br>2ã€æ•°æ®é¢„å¤„ç†çš„æ”¹è¿›ï¼Œåˆ†å‰² sentences çš„æ–¹å¼ã€æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹çš„é‡‡æ ·æ–¹å¼ã€å¥å­é•¿åº¦æ”¹å°ä¸€ç‚¹æ–¹ä¾¿è®­ç»ƒç­‰ï¼›<br>3ã€é¢„è®­ç»ƒæ¨¡å‹ï¼Œä½¿ç”¨æ›´ large çš„æ¨¡å‹ï¼›<br>4ã€é›†æˆæ¨¡å‹ï¼Œä½¿ç”¨å¤šæŠ˜æ•°æ®ï¼Œæˆ–è€…ä¸åŒæ–‡æœ¬å¤„ç†æ–¹æ³•æ¥è®­ç»ƒä¸åŒæ¨¡å‹ï¼Œç„¶åé›†æˆï¼›<br>5ã€æ ‡é¢˜ä¿¡æ¯å¯èƒ½ä¼šæœ‰ç”¨ï¼Œä¸åŒç±»åˆ«çš„å¸–å­ä¸­åŒ…å«ç­”æ¡ˆçš„æ¦‚ç‡ä¸åŒï¼›æŠŠæ ‡é¢˜ã€domain ç­‰ä¿¡æ¯ä½œä¸ºæ ‘æ¨¡å‹çš„è¾“å…¥è¿›è¡Œåˆ†ç±»ï¼›<br>6ã€ä¸åŒçš„å»ºæ¨¡æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ query-answer åŒ¹é…çš„æ€è·¯ï¼ˆnspï¼‰æ¥åšï¼Ÿæœ¬æ€è·¯æ˜¯ä¼ ç»Ÿçš„ QA æ–¹å¼è¿›è¡Œå»ºæ¨¡çš„ï¼Œæä¾› start å’Œ end<br>7ã€æ°´å“¥çš„æ•ˆæœå† 0.4~0.46ï¼Œå®˜æ–¹åŸºçº¿ä¼šæ›´å¥½ï¼Œå› ä¸ºå®˜æ–¹ç”¨åˆ°äº†æ›´å¤§çš„æ¨¡å‹ä»¥åŠæ›´å¤šçš„æ•°æ®ï¼›<br>8ã€å¿…é¡»ç”¨ paddle å¼€å‘ã€‚</p><h3 id="baseline2"><a href="#baseline2" class="headerlink" title="baseline2:"></a>baseline2:</h3><p><a href="https://aistudio.baidu.com/aistudio/projectdetail/4960090">https://aistudio.baidu.com/aistudio/projectdetail/4960090</a></p><h3 id="baseline3"><a href="#baseline3" class="headerlink" title="baseline3:"></a>baseline3:</h3><p><a href="https://aistudio.baidu.com/aistudio/projectdetail/5043272">https://aistudio.baidu.com/aistudio/projectdetail/5043272</a></p><p>é»˜è®¤å›ç­”ï¼šã€ã€‘è¯¦æƒ…è¯·çœ‹è§†é¢‘å›ç­”ã€‘ï¼Œé‡å¤è¶Šé«˜å¯èƒ½é—®é¢˜è¶Šå¤§<br>é•¿åº¦è¿‡çŸ­ï¼šNoanswer è¶Šå¯èƒ½<br>Noanswerï¼šæ•°æ®å  1/3ï¼Œå¯ä»¥æŠŠ haveanswer ä½œä¸ºäºŒåˆ†ç±»ï¼Œæˆ–è€…å¤šä»»åŠ¡å­¦ä¹ æ–¹æ³•</p><p>å¤šç‰‡æ®µæŠ½å–è¯¦è§å‚è€ƒèµ„æ–™ï¼Œæ¡†æ¶åº”è¯¥æ”¯æŒï¼›æ— ç­”æ¡ˆï¼Ÿ<br>å®˜æ–¹çš„ baseline ä¼˜åŒ–çš„æ¯”è¾ƒåº•å±‚<br>å¯¹æŠ—è®­ç»ƒ</p><h2 id="æ€è·¯-2ï¼šä½¿ç”¨åºåˆ—æ ‡æ³¨æ€è·¯"><a href="#æ€è·¯-2ï¼šä½¿ç”¨åºåˆ—æ ‡æ³¨æ€è·¯" class="headerlink" title="æ€è·¯ 2ï¼šä½¿ç”¨åºåˆ—æ ‡æ³¨æ€è·¯"></a>æ€è·¯ 2ï¼šä½¿ç”¨åºåˆ—æ ‡æ³¨æ€è·¯</h2><h3 id="baseline4"><a href="#baseline4" class="headerlink" title="baseline4:"></a>baseline4:</h3><p><a href="https://aistudio.baidu.com/aistudio/projectdetail/5030168">https://aistudio.baidu.com/aistudio/projectdetail/5030168</a></p><h2 id="å¯¹é½"><a href="#å¯¹é½" class="headerlink" title="å¯¹é½"></a>å¯¹é½</h2><p>æ»‘çª—è¦æå‰å¤„ç†</p><p>æ²¡æœ‰ç­”æ¡ˆå°±å°‘æ»‘çª—ï¼Œç­”æ¡ˆçŸ­å°±åˆ’å¾—å¿«ï¼Œç­”æ¡ˆé•¿è¿‡æ»‘åŠ¨çª—å£çš„å¤§å°ï¼Œåˆ™ä»¥æ»‘åŠ¨çª—å£çš„ä¸Šä¸‹æ ‡ä¸ºstartã€end</p><p>focal loss æŸå¤±å‡½æ•°</p><p>æ ‡æ³¨ 0-1 æ”¹é€ æˆé«˜æ–¯åˆ†å¸ƒ</p><p>åˆ†å±‚ä»»åŠ¡ï¼Œå…ˆé¢„æµ‹æ˜¯å¦å­˜åœ¨ç­”æ¡ˆï¼Œç„¶åé¢„æµ‹ç­”æ¡ˆçš„å¼€å§‹å’Œç»“æŸ</p><p>åˆ†è¯æŒ‰ç…§ [ï¼Œã€‚ã€ã€‘ã€] ç­‰ç­‰</p><p>æŸ¥çœ‹æ°´å“¥çš„ä»£ç ï¼Œæ£€éªŒ badcaseï¼›answer list æœ‰å¥½å¤šä¸ªç­”æ¡ˆçš„æƒ…å†µï¼Œä»–ä»¬å¦‚ä½•å¯¹ç­”æ¡ˆè¿›è¡Œå»ºæ¨¡çš„ï¼Ÿ</p><p>åºåˆ—æ ‡æ³¨é—®é¢˜</p><p>doc_stride å°çš„æƒ…å†µä¸‹ï¼Œæ­£è´Ÿæ ·æœ¬å¦‚ä½•å†³å®šï¼Ÿå¦‚æœ window å†…åªæœ‰éƒ¨åˆ†ç­”æ¡ˆï¼Œèƒ½ç®—ä½œæ­£æ ·æœ¬è¿˜æ˜¯è´Ÿæ ·æœ¬ï¼Ÿ</p><p>CRF</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>ç®—åŠ›å¦‚ä½•è·å–ï¼Ÿå¤§å®¶ç®—åŠ›å……è¶³å—</p><ol><li>å…¬å¼€ä»£ç ï¼Ÿä»£ç ä»“åº“</li><li>æ—¶é—´è¡¨ï¼›åˆ†å·¥</li></ol><p>å…³é”®æ—¶é—´èŠ‚ç‚¹ï¼š<br>è°ƒç ”æ¨¡å‹ã€æŒ–æ˜ baseline æ€æƒ³ã€æ•°æ®é¢„å¤„ç†ï¼Œæ•°æ®å¢å¼ºç»“æŸ<br>æäº¤ç¬¬ä¸€ç‰ˆæ¨¡å‹ï¼Œé¢„è®¡åˆ†æ•°<br>ä¸åŒæ•°æ®è®­ç»ƒå‡ºæ¥ä¸åŒçš„æ¨¡å‹ï¼Œå¤šä¸ªé«˜æ°´å¹³æ¨¡å‹è¿›è¡ŒæŠ•ç¥¨é›†æˆ</p><p><strong>11 æœˆè‡³ 12 æœˆ 15 ä½œå“æäº¤</strong></p><p>11 æœˆ 21 æ—¥â€”â€”11 æœˆ 27 æ—¥</p><p>11 æœˆ 28 æ—¥â€”â€”12 æœˆ 4 æ—¥</p><p>12 æœˆ 5 æ—¥â€”â€”12 æœˆ 11 æ—¥</p><p>12 æœˆ 12 æ—¥â€”â€”12 æœˆ 15 æ—¥</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å…ˆå å‘ï¼Œç­‰æ¯”èµ›ç»“æŸè®°å½•æ¨¡å‹çš„æ€æƒ³&lt;/p&gt;
&lt;!--more---&gt;
&lt;p&gt;11 æœˆè‡³ 12 æœˆ 15 ä½œå“æäº¤&lt;/p&gt;
&lt;p&gt;ç»™çœ‹è¯¾ç¨‹çš„åŒå­¦ç®—åŠ›ï¼Œ100 å°æ—¶ï¼›fork é¡¹ç›®ã€åˆ›å»ºé¡¹ç›®ï¼Œæå‡ç”¨æˆ·ç­‰çº§ï¼Œä»è€Œè·å–å…è´¹æ—¶é•¿ï¼›ç›¸å½“å¤šå®é™…é¡¹ç›®ï¼›å…¶ä»–æ¯”èµ›ï¼›å…¶ä»–é¡¹ç›®çš„ baseline </summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Extractive Question Answering" scheme="https://superlova.github.io/tags/Extractive-Question-Answering/"/>
    
    <category term="Competition" scheme="https://superlova.github.io/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æå®æ¯…ML-HW7-ä½¿ç”¨BERTè§£å†³ç­”æ¡ˆæå–é—®é¢˜</title>
    <link href="https://superlova.github.io/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-HW7-%E4%BD%BF%E7%94%A8BERT%E8%A7%A3%E5%86%B3%E7%AD%94%E6%A1%88%E6%8F%90%E5%8F%96%E9%97%AE%E9%A2%98/"/>
    <id>https://superlova.github.io/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-HW7-%E4%BD%BF%E7%94%A8BERT%E8%A7%A3%E5%86%B3%E7%AD%94%E6%A1%88%E6%8F%90%E5%8F%96%E9%97%AE%E9%A2%98/</id>
    <published>2022-11-19T10:24:36.000Z</published>
    <updated>2022-11-20T07:58:47.244Z</updated>
    
    <content type="html"><![CDATA[<p>æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡ä¼šè¯•ç€å®Œæˆä½œä¸š 7ï¼Œä»¥åŠåˆ†æé—®ç­”æ¨¡å‹çš„å»ºæ¨¡æ–¹æ³•å’Œä¼˜åŒ–æ–¹æ³•ã€‚</p><!--more---><p>æœ¬ç¯‡åšå®¢è®°å½•è¯¾ç¨‹ä½œä¸š 7 çš„åšæ³•ã€‚</p><h2 id="ä¸€ã€ä»»åŠ¡ç›®æ ‡"><a href="#ä¸€ã€ä»»åŠ¡ç›®æ ‡" class="headerlink" title="ä¸€ã€ä»»åŠ¡ç›®æ ‡"></a>ä¸€ã€ä»»åŠ¡ç›®æ ‡</h2><p>æŠ½å–å¼é—®ç­”ï¼ˆExtractive Question Answeringï¼‰ä»»åŠ¡æ˜¯æŒ‡ï¼šä»ä¸€æ®µæ–‡æœ¬ä¸­æå–å¯¹åº”é—®é¢˜çš„ç­”æ¡ˆã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œæ¨¡å‹çš„è¾“å…¥ä¸ºæ–‡æœ¬ï¼ˆDocumentï¼‰å’Œé—®é¢˜ï¼ˆQuestionï¼‰ï¼Œè¾“å‡ºç­”æ¡ˆåœ¨æ–‡æœ¬ä¸­çš„ä½ç½®ã€‚å¦‚æœæ¨¡å‹è®¤ä¸ºæ–‡æœ¬ä¸­æ²¡æœ‰ç­”æ¡ˆï¼Œåˆ™è¾“å‡ºä¸€ä¸ªç‰¹å®šçš„å ä½ç¬¦ï¼Œæ¯”å¦‚â€œæ— ç­”æ¡ˆï¼ˆNoAnswerï¼‰â€ã€‚</p><p><img src="/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-HW7-%E4%BD%BF%E7%94%A8BERT%E8%A7%A3%E5%86%B3%E7%AD%94%E6%A1%88%E6%8F%90%E5%8F%96%E9%97%AE%E9%A2%98/extractive_question_answering.png" alt></p><p>æœ¬æ¬¡ä½œä¸šçš„ baseline ä½¿ç”¨äº† BERT ä½œä¸ºé¢„è®­ç»ƒæ¨¡å‹ã€‚å…·ä½“åœ°ï¼Œä½¿ç”¨ [SEP] çš„è¿™ä¸ªç‰¹æ®Šå•è¯ï¼Œå°† Query å’Œ Document ä¸€èµ·ä½œä¸ºè¾“å…¥ã€‚ç„¶ååœ¨ Bert ä¸­è·å–è‰¯å¥½çš„ embedding(è¯å‘é‡)ï¼Œç„¶åå°†è¿™ä¸ªembeddingçš„ç»“æœæ¥å…¥ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œåˆ†åˆ«å¾—åˆ°ç­”æ¡ˆåœ¨æ–‡ç« ä¸­ä½ç½®çš„idå’Œç»“æŸä½ç½®çš„idã€‚</p><p>å› ä¸ºæ•°æ®é›†ä¸­çš„ç­”æ¡ˆæ˜¯å¯ä»¥ç›´æ¥åœ¨æ–‡ç« ä¸­æŠ½å–å‡ºæ¥ï¼Œæ‰€ä»¥å¾—åˆ°ç­”æ¡ˆèµ·å§‹ä½ç½®çš„idå’Œç»“æŸä½ç½®çš„idå¯ä»¥ç›´æ¥æŠ½å–å‡ºæ­£ç¡®çš„ç­”æ¡ˆã€‚</p><h2 id="äºŒã€æ•°æ®åˆ†æ"><a href="#äºŒã€æ•°æ®åˆ†æ" class="headerlink" title="äºŒã€æ•°æ®åˆ†æ"></a>äºŒã€æ•°æ®åˆ†æ</h2><p>æœ¬æ¬¡æ•°æ®é›†æ˜¯ç¹ä½“ä¸­æ–‡çš„é˜…è¯»ç†è§£æ•°æ®é›†ã€‚ç±»ä¼¼çš„æ•°æ®é›†è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ <a href="https://rajpurkar.github.io/SQuAD-explorer/">SQuAD æ•°æ®é›†</a>ã€<a href="https://github.com/pluto-junzeng/ChineseSquad">ä¸­æ–‡ SQuAD</a></p><p>é¦–å…ˆæˆ‘ä»¬æ¥åˆ†æä¸‹æ•°æ®é›†ã€‚ä» <a href="https://www.kaggle.com/competitions/ml2021-spring-hw7/data">kaggle çš„å¯¹åº”é“¾æ¥</a> å°±èƒ½ä¸‹è½½æœ¬æ¬¡ä½œä¸šæ‰€éœ€çš„æ•°æ®é›†ã€‚</p><p>æ•°æ®é›†ç”±ä¸‰ä¸ªæ–‡ä»¶ç»„æˆï¼Œåˆ†åˆ«æ˜¯è®­ç»ƒé›†ï¼Œæµ‹è¯•é›†å’ŒéªŒè¯é›†ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€æ®µ json æ–‡æœ¬ï¼Œå¯ä»¥ç”±ä»¥ä¸‹ python ä»£ç è¯»å–ï¼š</p><pre><code class="lang-py"># å°† è®­ç»ƒé›† è¯»å…¥å†…å­˜ï¼Œå¹¶æ•´ç†æˆ dict çš„æ•°æ®ç»“æ„def load_file(filename):    with open(filename, &#39;r&#39;, encoding=&#39;utf-8&#39;) as f:        data = json.loads(f.read())    return datatrain_file = &quot;../data/hw7_train.json&quot;test_file = &quot;../data/hw7_test.json&quot;dev_file = &quot;../data/hw7_dev.json&quot;train_data = load_file(train_file)test_data = load_file(test_file)dev_data = load_file(dev_file)print(&quot;Train Data Num: &#123;0&#125;\nTest Data Num: &#123;1&#125;\nDev Data Num: &#123;2&#125;&quot;.format(len(train_data[&quot;questions&quot;]), len(test_data[&quot;questions&quot;]), len(dev_data[&quot;questions&quot;])))</code></pre><p>ä»¥è®­ç»ƒæ•°æ®ä¸ºä¾‹ï¼Œæ•°æ®è¢«åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼šquestions å’Œ paragraphs ã€‚</p><pre><code class="lang-py">train_data.keys()# [OUT]: dict_keys([&#39;questions&#39;, &#39;paragraphs&#39;])train_data[&quot;questions&quot;][0]# [OUT]: #  &#123;&#39;id&#39;: 0,#  &#39;paragraph_id&#39;: 3884,#  &#39;question_text&#39;: &#39;ç¾…é¦¬æ•™çš‡åˆ©å¥§ä¸‰ä¸–åœ¨800å¹´æ­£å¼åŠ å†•èª°ç‚ºç¾…é¦¬äººçš„çš‡å¸?&#39;,#  &#39;answer_text&#39;: &#39;æŸ¥ç†å¤§å¸&#39;,#  &#39;answer_start&#39;: 141,#  &#39;answer_end&#39;: 144&#125;train_data[&quot;paragraphs&quot;][3884]#[OUT]: &#39;åˆ©å¥§ä¸‰ä¸–é–‹å‰µçš„ä¼Šè˜‡é‡Œäºç‹æœåœ¨8ä¸–ç´€æœ«æœŸèµ°ä¸Šäº†æœ«è·¯...&#39;</code></pre><p>questions éƒ¨åˆ†å‚¨å­˜äº†é—®é¢˜çš„ç¼–å·ï¼Œä»¥åŠå¯¹åº”çš„æ–‡ç« å‚¨å­˜åœ¨ paragraphs ä¸­çš„ä¸‹æ ‡ã€‚ç”±äº questions å’Œ paragraphs çš„æ•°ç›®ä¸ç›¸ç­‰ï¼Œæœ‰å¤šä¸ªé—®é¢˜å¯¹åº”ä¸€ç¯‡æ–‡ç« ï¼Œå› æ­¤ questions éœ€è¦æŒ‡å®šæŸ¥æ‰¾çš„æ–‡ç« ã€‚</p><p>questions éƒ¨åˆ†è¿˜å‚¨å­˜æœ‰é—®é¢˜çš„æ–‡æœ¬ï¼Œä»¥åŠç­”æ¡ˆçš„æ–‡æœ¬ï¼Œä»¥åŠç­”æ¡ˆåœ¨æ–‡æ¡£ä¸­çš„å¼€å§‹ä½ç½®å’Œèµ·å§‹ä½ç½®ã€‚å¦‚æœè¦æå– paragraphs çš„ç­”æ¡ˆï¼Œç›´æ¥ä½¿ç”¨ <code>train_data[&quot;paragraphs&quot;][3884][answer_start:answer_end+1]</code> å³å¯ã€‚</p><p>paragraphs éƒ¨åˆ†åˆ™æ˜¯çº¯æ–‡æœ¬ã€‚</p><p>è®­ç»ƒé›†ã€æµ‹è¯•é›†å’ŒéªŒè¯é›†çš„å¤§å°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>Train Data Question Num: 26936Test Data Question Num: 3493Dev Data Question Num: 3524Train Data Para Num: 8014Test Data Para Num: 1000Dev Data Para Num: 1000</code></pre><p>æµ‹è¯•é›† test_data åˆ™æ²¡æœ‰ç­”æ¡ˆï¼Œanswer ç›¸å…³å­—æ®µå…¨éƒ¨ä¸º None ã€‚</p><h2 id="ä¸‰ã€è¾“å‡ºæ ¼å¼è¦æ±‚å’Œå¾—åˆ†æ ‡å‡†"><a href="#ä¸‰ã€è¾“å‡ºæ ¼å¼è¦æ±‚å’Œå¾—åˆ†æ ‡å‡†" class="headerlink" title="ä¸‰ã€è¾“å‡ºæ ¼å¼è¦æ±‚å’Œå¾—åˆ†æ ‡å‡†"></a>ä¸‰ã€è¾“å‡ºæ ¼å¼è¦æ±‚å’Œå¾—åˆ†æ ‡å‡†</h2><p>å¦‚æœæƒ³è¦éªŒè¯è‡ªå·±çš„æ¨¡å‹æ•ˆæœï¼Œåˆ™æäº¤åˆ° kaggle ç³»ç»Ÿä¸­è¿›è¡Œè‡ªåŠ¨è¯„åˆ¤å³å¯ã€‚éœ€è¦ä½¿ç”¨æ¨¡å‹ç»™å‡º test æµ‹è¯•é›†çš„æ‰€æœ‰æ¨ç†ç»“æœï¼Œå¹¶å°†å…¶æ•´ç†æˆ <code>ID,Answer</code> çš„ csv æ–‡æœ¬ï¼Œç„¶åä¸Šä¼ ã€‚</p><p><img src="/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-HW7-%E4%BD%BF%E7%94%A8BERT%E8%A7%A3%E5%86%B3%E7%AD%94%E6%A1%88%E6%8F%90%E5%8F%96%E9%97%AE%E9%A2%98/output_standard.png" alt></p><p>å¦‚æœæœ€ç»ˆæˆç»©èƒ½è¾¾åˆ° 0.84 ä»¥ä¸Šï¼Œåˆ™è¯´æ˜æˆç»©å·²ç»éå¸¸ä¼˜ç§€ã€‚</p><h2 id="å››ã€ä¸Šåˆ†æŠ€å·§"><a href="#å››ã€ä¸Šåˆ†æŠ€å·§" class="headerlink" title="å››ã€ä¸Šåˆ†æŠ€å·§"></a>å››ã€ä¸Šåˆ†æŠ€å·§</h2><h3 id="1-ä½¿ç”¨æ»‘åŠ¨çª—å£æˆªå–å¤šæ®µæ–‡æœ¬è§£å†³é•¿æ–‡æœ¬é—®é¢˜"><a href="#1-ä½¿ç”¨æ»‘åŠ¨çª—å£æˆªå–å¤šæ®µæ–‡æœ¬è§£å†³é•¿æ–‡æœ¬é—®é¢˜" class="headerlink" title="1. ä½¿ç”¨æ»‘åŠ¨çª—å£æˆªå–å¤šæ®µæ–‡æœ¬è§£å†³é•¿æ–‡æœ¬é—®é¢˜"></a>1. ä½¿ç”¨æ»‘åŠ¨çª—å£æˆªå–å¤šæ®µæ–‡æœ¬è§£å†³é•¿æ–‡æœ¬é—®é¢˜</h3><p>æ¨¡å‹çš„è¾“å…¥é•¿åº¦ä¸º é—®é¢˜é•¿åº¦ + ç¯‡ç« é•¿åº¦ + 3ï¼ˆç‰¹æ®Šå­—ç¬¦ä¸ªæ•°ï¼‰ã€‚å¯¹äº BERT æ¨¡å‹è€Œè¨€ï¼Œæœ€é•¿è¾“å…¥é•¿åº¦ä¸º 512ã€‚è¿™æ˜¯ç”± self-attention çš„è®¡ç®—é‡é™åˆ¶çš„ã€‚</p><p>ä¸‹é¢æ˜¯å¯¹è®­ç»ƒé›†çš„ paragraphs éƒ¨åˆ†çš„é•¿åº¦ç›´æ–¹å›¾ï¼š</p><p><img src="/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-HW7-%E4%BD%BF%E7%94%A8BERT%E8%A7%A3%E5%86%B3%E7%AD%94%E6%A1%88%E6%8F%90%E5%8F%96%E9%97%AE%E9%A2%98/length_of_paragraphs.png" alt></p><p>å› æ­¤ä½¿ç”¨æ•´ç¯‡æ–‡ç« ä½œä¸ºè¾“å…¥æ˜¯ä¸ç°å®çš„ã€‚</p><p>ä½†æ˜¯å¦‚æœå‡å®šæ–‡ç« çš„å¤§éƒ¨åˆ†ä¿¡æ¯å¯¹å›ç­”é—®é¢˜æ²¡æœ‰å¸®åŠ©ï¼Œæˆ‘ä»¬å¯ä»¥åªä½¿ç”¨å±€éƒ¨çš„ä¿¡æ¯è¿›è¡Œè®­ç»ƒã€‚</p><p>å…·ä½“åšæ³•æ˜¯ï¼šè®­ç»ƒæ—¶ï¼Œåœ¨ç¯‡ç« çš„ç­”æ¡ˆé™„è¿‘ï¼Œä»…æˆªå–ä¸€ä¸ªå›ºå®šé•¿åº¦çš„çª—å£å†…çš„æ‰€æœ‰æ–‡æœ¬ï¼Œè¯¥çª—å£å°½å¯èƒ½å¤§ï¼Œæ¯”å¦‚ 32 ä¸ªå­—ç¬¦ã€‚</p><p>æ¨ç†æ—¶ï¼Œç”±äºæˆ‘ä»¬ä¸çŸ¥é“ç­”æ¡ˆåˆ°åº•åœ¨å“ªé‡Œï¼Œå› æ­¤åœ¨ç¯‡ç« ä¸Šæ»‘åŠ¨çª—å£åˆ‡åˆ†å¤šæ®µæ–‡æœ¬ï¼Œä»¤æ¨¡å‹åœ¨æ¯æ®µæ–‡æœ¬ä¸­å¯»æ‰¾ç­”æ¡ˆï¼Œæœ€å total_score è¯„åˆ†æœ€é«˜çš„å°±æ˜¯æœ€ç»ˆçš„è¾“å‡ºã€‚</p><p><img src="/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-HW7-%E4%BD%BF%E7%94%A8BERT%E8%A7%A3%E5%86%B3%E7%AD%94%E6%A1%88%E6%8F%90%E5%8F%96%E9%97%AE%E9%A2%98/example_of_sliding_window.png" alt></p><p>ä»¥ä¸Šå›¾çš„ä¸¤ä¸ªçª—å£ä¸¾ä¾‹ï¼Œ window_1 çš„ç­”æ¡ˆä¸­ start_position çš„æ¨¡å‹è¯„åˆ†ä¸º 0.5ï¼Œ end_score ä¸º 0.4ï¼ŒåŠ èµ·æ¥ä¸º 0.9ï¼Œä½äº window_2 çš„ 1.0ï¼Œå› æ­¤æœ€ç»ˆé€‰æ‹© window_2 çš„ start_pos å’Œ end_posã€‚</p><h3 id="2-åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡"><a href="#2-åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡" class="headerlink" title="2. åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡"></a>2. åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡</h3><p>æ‰‹å·¥è°ƒæ•´å­¦ä¹ ç‡ï¼š</p><p><img src="/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-HW7-%E4%BD%BF%E7%94%A8BERT%E8%A7%A3%E5%86%B3%E7%AD%94%E6%A1%88%E6%8F%90%E5%8F%96%E9%97%AE%E9%A2%98/learning_rate_decay.png" alt></p><p><a href="https://huggingface.co/docs/transformers/main_classes/optimizer_schedules#transformers.get_linear_schedule_with_warmup">https://huggingface.co/docs/transformers/main_classes/optimizer_schedules#transformers.get_linear_schedule_with_warmup</a></p><p><a href="https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate">https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate</a></p><h3 id="3-ä¿®æ”¹æ»‘åŠ¨çª—å£çš„æ­¥è¿›å­—ç¬¦æ•°"><a href="#3-ä¿®æ”¹æ»‘åŠ¨çª—å£çš„æ­¥è¿›å­—ç¬¦æ•°" class="headerlink" title="3. ä¿®æ”¹æ»‘åŠ¨çª—å£çš„æ­¥è¿›å­—ç¬¦æ•°"></a>3. ä¿®æ”¹æ»‘åŠ¨çª—å£çš„æ­¥è¿›å­—ç¬¦æ•°</h3><p>doc_stride æŒ‡æ»‘åŠ¨çª—å£æ¯æ¬¡ç§»åŠ¨çš„å­—ç¬¦ä¸ªæ•°ã€‚</p><p>å®é™…ä½¿ç”¨æ¨¡å‹åšæµ‹è¯•æ—¶ï¼Œå¦‚æœç­”æ¡ˆåœ¨çª—å£é™„è¿‘ï¼Œæ¨ªè·¨ä¸¤ä¸ªçª—å£çš„è¯ï¼Œç­”æ¡ˆä¼šè¢«æˆªæ–­ï¼Œæ¨¡å‹ä¼šçœ‹ä¸åˆ°æ­£ç¡®ç­”æ¡ˆã€‚ä¸ºäº†é˜²æ­¢ç­”æ¡ˆè¢«æˆªæ–­ï¼Œæ»‘åŠ¨çª—å£çš„æ­¥è¿›ä¸ªæ•°å¿…é¡»æ¯”æ»‘åŠ¨çª—å£æœ¬èº«è¦å°ï¼Œä¸‹ä¸€ä¸ªæˆªå–çš„å­—ç¬¦ä¸²è¦ä¸ä¸Šä¸€ä¸ªæœ‰ä¸€å®šé‡åˆï¼Œå³ overlapping window ã€‚</p><p>åº”è¯¥å‡å° doc_stride ï¼Œæ‰èƒ½åšåˆ°é‡å çª—å£çš„æ•ˆæœã€‚é»˜è®¤çš„ doc_stride ä¸º 150ï¼Œæˆ‘ä»¬å¯ä»¥å‡åŠä¸º 75ï¼Œä»¥å‡å°‘ç­”æ¡ˆè¢«æˆªæ–­çš„æ¦‚ç‡ã€‚</p><h3 id="4-æ»‘åŠ¨çª—å£åˆ‡åˆ†ä½ç½®çš„ä¼˜åŒ–"><a href="#4-æ»‘åŠ¨çª—å£åˆ‡åˆ†ä½ç½®çš„ä¼˜åŒ–" class="headerlink" title="4. æ»‘åŠ¨çª—å£åˆ‡åˆ†ä½ç½®çš„ä¼˜åŒ–"></a>4. æ»‘åŠ¨çª—å£åˆ‡åˆ†ä½ç½®çš„ä¼˜åŒ–</h3><p>baseline ä¸­é»˜è®¤å°†ç­”æ¡ˆçš„ä¸­ç‚¹ä½œä¸ºåˆ‡åˆ†çª—å£çš„ä¸­ç‚¹ï¼Œå¯¼è‡´åˆ‡åˆ†å‡ºæ¥çš„è®­ç»ƒé›†å¤§éƒ¨åˆ†éƒ½æ˜¯ <code>æ— ç”¨æ–‡æœ¬+ç­”æ¡ˆ+æ— ç”¨æ–‡æœ¬</code> ï¼Œæ¨¡å‹å­¦ä¹ åˆ°äº†å¾ˆå¤šæ— ç”¨æ–‡æœ¬ã€‚</p><p>å®é™…ä¸Šç­”æ¡ˆå¹¶ä¸æ€»åœ¨çª—å£çš„ä¸­é—´ï¼Œåœ¨æµ‹è¯•é˜¶æ®µçª—å£çš„åˆ’åˆ†æ˜¯éšæœºçš„ï¼Œç­”æ¡ˆå¯èƒ½å‡ºç°åœ¨çª—å£çš„å‰åŠéƒ¨åˆ†æˆ–è€…ååŠéƒ¨åˆ†ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å¯¹è®­ç»ƒé›†çš„çª—å£åˆ‡åˆ†æ–¹å¼åšä¼˜åŒ–ï¼Œæ¯”å¦‚å¼•å…¥éšæœºæ€§ã€‚</p><h3 id="5-ä½¿ç”¨å…¶ä»–çš„é¢„è®­ç»ƒæ¨¡å‹"><a href="#5-ä½¿ç”¨å…¶ä»–çš„é¢„è®­ç»ƒæ¨¡å‹" class="headerlink" title="5. ä½¿ç”¨å…¶ä»–çš„é¢„è®­ç»ƒæ¨¡å‹"></a>5. ä½¿ç”¨å…¶ä»–çš„é¢„è®­ç»ƒæ¨¡å‹</h3><p><a href="https://huggingface.co/models">https://huggingface.co/models</a></p><h3 id="6-æ¨¡å‹åå¤„ç†"><a href="#6-æ¨¡å‹åå¤„ç†" class="headerlink" title="6. æ¨¡å‹åå¤„ç†"></a>6. æ¨¡å‹åå¤„ç†</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ è§„åˆ™ï¼Œæ¥è§„é¿æ¨¡å‹çš„æ˜¾è‘—é”™è¯¯ï¼Œæ¯”å¦‚ start_pos &gt; end_pos çš„æƒ…å†µæ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ã€‚</p><h3 id="7-è‡ªåŠ¨æ··åˆç²¾åº¦"><a href="#7-è‡ªåŠ¨æ··åˆç²¾åº¦" class="headerlink" title="7. è‡ªåŠ¨æ··åˆç²¾åº¦"></a>7. è‡ªåŠ¨æ··åˆç²¾åº¦</h3><p>Pytorch è®­ç»ƒæ¨¡å‹é»˜è®¤ä½¿ç”¨ float32 ç²¾åº¦çš„æµ®ç‚¹æ•°ã€‚è‡ªåŠ¨æ··åˆç²¾åº¦ï¼ˆAutomatic mixed precisionï¼‰èƒ½å¤Ÿå…è®¸ä½ ä½¿ç”¨åŠç²¾åº¦æµ®ç‚¹æ•° float16 æ¥åŠ é€Ÿæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚è¿™ä¸ªæ“ä½œåªåœ¨ T4/V100 ç­‰ GPU ä¸Šæœ‰ç”¨ã€‚</p><p><img src="/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-HW7-%E4%BD%BF%E7%94%A8BERT%E8%A7%A3%E5%86%B3%E7%AD%94%E6%A1%88%E6%8F%90%E5%8F%96%E9%97%AE%E9%A2%98/automatic_mixed_precision.png" alt></p><p><a href="https://huggingface.co/docs/accelerate/index">https://huggingface.co/docs/accelerate/index</a></p><p><a href="https://pytorch.org/blog/accelerating-training-on-nvidia-gpus-with-pytorch-automatic-mixed-precision/">https://pytorch.org/blog/accelerating-training-on-nvidia-gpus-with-pytorch-automatic-mixed-precision/</a></p><h3 id="8-æ¢¯åº¦ç´¯åŠ "><a href="#8-æ¢¯åº¦ç´¯åŠ " class="headerlink" title="8. æ¢¯åº¦ç´¯åŠ "></a>8. æ¢¯åº¦ç´¯åŠ </h3><p>å½“æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨æ›´å¤§çš„ batch_size ä½†æ˜¯æ˜¾å­˜ä¸å¤Ÿæ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ¢¯åº¦ç´¯åŠ ï¼ˆGradient Accumulationï¼‰çš„æ–¹æ³•æ¥èŠ‚çº¦æ˜¾å­˜ã€‚</p><p><a href="https://kozodoi.me/python/deep%20learning/pytorch/tutorial/2021/02/19/gradient-accumulation.html">https://kozodoi.me/python/deep%20learning/pytorch/tutorial/2021/02/19/gradient-accumulation.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡ä¼šè¯•ç€å®Œæˆä½œä¸š 7ï¼Œä»¥åŠåˆ†æé—®ç­”æ¨¡å‹çš„å»ºæ¨¡æ–¹æ³•å’Œä¼˜åŒ–æ–¹æ³•ã€‚&lt;/p&gt;
&lt;!--more---&gt;
&lt;p&gt;æœ¬ç¯‡åšå®¢è®°å½•è¯¾ç¨‹ä½œä¸š 7 çš„åšæ³•ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä¸€ã€ä»»åŠ¡ç›®æ ‡&quot;&gt;&lt;a href=&quot;#ä¸€ã€ä»»åŠ¡ç›®æ ‡&quot; class=&quot;</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="BERT" scheme="https://superlova.github.io/tags/BERT/"/>
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="MOOC" scheme="https://superlova.github.io/tags/MOOC/"/>
    
    <category term="Extraction-based Question Answering" scheme="https://superlova.github.io/tags/Extraction-based-Question-Answering/"/>
    
    <category term="homework" scheme="https://superlova.github.io/tags/homework/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘é€šè¿‡æ–‡å­—æ£€ç´¢è§†é¢‘ç‰‡æ®µï¼šVCEDâ€”â€”è·¨æ¨¡æ€æ¨¡å‹ä»‹ç»</title>
    <link href="https://superlova.github.io/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E2%80%94%E2%80%94%E8%B7%A8%E6%A8%A1%E6%80%81%E6%A8%A1%E5%9E%8B%E4%BB%8B%E7%BB%8D/"/>
    <id>https://superlova.github.io/2022/11/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E2%80%94%E2%80%94%E8%B7%A8%E6%A8%A1%E6%80%81%E6%A8%A1%E5%9E%8B%E4%BB%8B%E7%BB%8D/</id>
    <published>2022-11-18T16:58:52.000Z</published>
    <updated>2022-11-23T17:20:23.694Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡æ˜¯ VCED è·¨æ¨¡æ€æ£€ç´¢å·¥å…·ä»‹ç»çš„ç¬¬ä¸‰ç¯‡ï¼Œä»‹ç» VCED å®ç°è·¨æ¨¡æ€æ£€ç´¢çš„æ ¸å¿ƒæ¨¡å‹å’Œç®—æ³•ã€‚æœ¬ç¯‡æ–‡ç« åªèƒ½è¯´æµ…å°è¾„æ­¢ï¼Œæ›´æ·±å…¥çš„æ€è€ƒè¿˜éœ€åç»­è¡¥å……ã€‚</p><!--more---><h2 id="ä¸€ã€CLIP-æ¨¡å‹"><a href="#ä¸€ã€CLIP-æ¨¡å‹" class="headerlink" title="ä¸€ã€CLIP æ¨¡å‹"></a>ä¸€ã€CLIP æ¨¡å‹</h2><p>CLIPæ¨¡å‹å°†åŸæœ‰çš„å›¾åƒæ ‡ç­¾æ›¿æ¢ä¸ºå›¾åƒçš„æ–‡æœ¬æè¿°ä¿¡æ¯ï¼Œæ¥ç›‘ç£è§†è§‰ä»»åŠ¡çš„è®­ç»ƒï¼Œåœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸­å¾—åˆ°äº†è¾ƒå¥½çš„zero-shotçš„ç»“æœã€‚</p><p>è¯¥æ¨¡å‹å°†å›¾åƒåˆ†ç±»é—®é¢˜è½¬æ¢ä¸ºå›¾æ–‡åŒ¹é…é—®é¢˜ï¼Œåœ¨ä¸‹æ¸¸ä»»åŠ¡ï¼ˆä»¥å›¾åƒåˆ†ç±»ä¸ºä¾‹ï¼‰çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåŸºäºå›¾åƒæ ‡ç­¾é›†åˆï¼Œæ„é€  text prompt å¹¶å°†å…¶é€šè¿‡ clip çš„ text encoder è·å¾—æ–‡æœ¬ç¼–ç å‘é‡ï¼Œä¹‹åï¼Œå°†å›¾ç‰‡é€šè¿‡ image encoder è·å¾—å›¾åƒç¼–ç å‘é‡ã€‚</p><p>å¯¹äºæ¯å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å®ƒä¸æ‰€æœ‰ text prompt ä¹‹é—´çš„è·ç¦»ï¼ˆé€šè¿‡è®¡ç®—å›¾åƒç¼–ç å‘é‡ä¸æ–‡æœ¬ç¼–ç å‘é‡ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦æˆ–ç‚¹ç§¯å¾—åˆ°ï¼‰ï¼Œé€‰æ‹©è·ç¦»æœ€è¿‘çš„ text prompt æ‰€å¯¹åº”çš„æ ‡ç­¾ä½œä¸ºè¯¥å¼ å›¾ç‰‡çš„åˆ†ç±»æ ‡ç­¾ã€‚è¿™æ ·çš„è½¬æ¢ä½¿å¾—æ¨¡å‹åœ¨ zero-shot åœºæ™¯ä¸‹å¯ä»¥è·å¾—ä¸ç›‘ç£å­¦ä¹ æ¯”è‚©çš„æ•ˆæœï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œclip æ¨¡å‹å¯å¹¿æ³›åº”ç”¨åˆ°å›¾åƒæ£€ç´¢ï¼Œè§†é¢‘ç†è§£ï¼Œå›¾åƒç”Ÿæˆç­‰å…¶ä»–é¢†åŸŸã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ CLIP æ¨¡å‹è¿›è¡Œç®€å•çš„ä»‹ç»ã€‚</p><h3 id="1-CLIP-åŸç†"><a href="#1-CLIP-åŸç†" class="headerlink" title="1. CLIP åŸç†"></a>1. CLIP åŸç†</h3><p>CLIPå°†å›¾åƒçš„åˆ†ç±»ä»»åŠ¡è½¬åŒ–ä¸ºäº†å›¾æ–‡åŒ¹é…çš„ä»»åŠ¡ï¼Œå°†å›¾åƒä¿¡æ¯å’Œè¯­ä¹‰ä¿¡æ¯æ˜ å°„åˆ°åŒä¸€å¤šæ¨¡æ€è¯­ä¹‰ç©ºé—´ä¸‹ï¼Œå†ä½¿ç”¨å¯¹æ¯”å­¦ä¹ çš„æ–¹æ³•è¿›è¡Œè®­ç»ƒã€‚</p><p>åœ¨é¢„è®­ç»ƒé˜¶æ®µï¼Œæ¨¡å‹çš„æ•°æ®æ¥æºä¸ºä»äº’è”ç½‘ä¸Šæœé›†çš„4äº¿ä¸ªï¼ˆå›¾åƒï¼Œæ–‡æœ¬ï¼‰å¯¹ã€‚å‡è®¾batchä¸­æœ‰Nä¸ªï¼ˆå›¾åƒï¼Œæ–‡æœ¬ï¼‰å¯¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥å¾—åˆ°Nä¸ªæ–‡æœ¬å‘é‡ï¼Œè®°ä¸ºï¼št1,t2,â€¦,tn,ä»¥åŠNä¸ªå›¾åƒå‘é‡ï¼Œè®°ä¸ºimg1,img2,â€¦,imgnã€‚æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯è®©t(i)ä¸img(i)ä¹‹é—´çš„è¯­ä¹‰è·ç¦»å°½å¯èƒ½æ¥è¿‘ï¼Œè€Œä¸å…¶ä»–çš„imgä¹‹é—´çš„è·ç¦»å°½å¯èƒ½æ‹‰è¿œã€‚å¦‚æœæˆ‘ä»¬å°†å…¶çœ‹ä¸ºä¸€ä¸ªçŸ©é˜µï¼Œå…¶ä¸­æ¨ªè½´æ–¹å‘ä¸ºæ–‡æœ¬ï¼Œçºµè½´æ–¹å‘ä¸ºå›¾åƒï¼Œä¸”æ–‡æœ¬ã€å›¾åƒçš„æ ‡å·å‡æŒ‰ç…§æ¬¡åºæ’åˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªN * Nçš„æ–¹é˜µï¼Œæ–¹é˜µçš„æ¯ä¸ªå…ƒç´ (i,j)çš„ä½ç½®ä¸ºt(i)ä¸img(j)ä¹‹é—´çš„è¯­ä¹‰ç›¸ä¼¼åº¦ï¼Œç›¸ä¼¼åº¦å¯é€šè¿‡ä½™å¼¦æˆ–ç‚¹ç§¯çš„æ–¹å¼è·å¾—ã€‚æˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡å°±æ˜¯è®©å¯¹è§’çº¿ä¸Šçš„å…ƒç´ çš„å€¼å°½å¯èƒ½çš„å¤§ï¼Œè€Œå…¶ä½™éƒ¨åˆ†çš„å€¼å°½å¯èƒ½åœ°å°ã€‚</p><p>åœ¨zero shoté˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡è¯­ä¹‰å»ºç«‹promptæ¨¡æ¿ï¼Œå¹¶å°†æ ‡ç­¾é›†åˆæ˜ å°„åˆ°è¯¥æ¨¡æ¿ä¸­ï¼Œå¾—åˆ°prompt textæ¨¡æ¿ã€‚æ¯”æ–¹è¯´ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦åšå¯¹(å¤§è±¡ï¼Œå†°ç®±ï¼Œèš‚èš)çš„ä¸‰åˆ†ç±»ä»»åŠ¡ï¼Œpromptæ¨¡æ¿ä¸º â€œè¿™æ˜¯ä¸€å¼ æœ‰å…³{ç±»åˆ«}çš„ç…§ç‰‡â€ï¼Œå°†åˆ†ç±»æ ‡ç­¾æ˜ å°„åˆ°promptæ¨¡æ¿åå¯ä»¥å¾—åˆ°é›†åˆï¼š{â€œè¿™æ˜¯ä¸€å¼ æœ‰å…³å¤§è±¡çš„ç…§ç‰‡â€â€œè¿™æ˜¯ä¸€å¼ æœ‰å…³å†°ç®±çš„ç…§ç‰‡â€â€œè¿™æ˜¯ä¸€å¼ æœ‰å…³èš‚èšçš„ç…§ç‰‡â€}ã€‚å¯¹é›†åˆä¸­çš„æ–‡æœ¬ï¼Œé€šè¿‡clipçš„text encoderä¹‹åï¼Œä¾¿å¯ä»¥å¾—åˆ°ä¸‰ä¸ªç±»åˆ«å¯¹åº”çš„æ–‡æœ¬ç‰¹å¾å‘é‡ï¼Œä¹‹åï¼Œå¯¹äºæ¯ä¸€å¼ éœ€è¦åˆ†ç±»çš„å›¾ç‰‡ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯”è¾ƒè¯¥å›¾ç‰‡çš„ç‰¹å¾å‘é‡ä¸ä¸‰ä¸ªç±»åˆ«å¯¹åº”çš„æ–‡æœ¬ç‰¹å¾å‘é‡ä¹‹é—´çš„è¯­ä¹‰è·ç¦»ï¼Œå¹¶é€‰æ‹©æœ€è¿‘çš„é‚£ä¸€æ¡æ–‡æœ¬æ‰€å¯¹åº”çš„æ ‡ç­¾ä½œä¸ºå›¾åƒçš„åˆ†ç±»ç»“æœã€‚ å…·ä½“ç»†èŠ‚å¯å‚è€ƒè®ºæ–‡ã€ŠLearning transferable visual models from natural language supervisionã€‹ã€‚</p><h3 id="2-å…¶ä»–å¤šæ¨¡æ€æ¨¡å‹"><a href="#2-å…¶ä»–å¤šæ¨¡æ€æ¨¡å‹" class="headerlink" title="2. å…¶ä»–å¤šæ¨¡æ€æ¨¡å‹"></a>2. å…¶ä»–å¤šæ¨¡æ€æ¨¡å‹</h3><p>åœ¨å›¾æ–‡ç”Ÿæˆé¢†åŸŸï¼Œå¹¿ä¸ºäººçŸ¥çš„æ¨¡å‹æœ‰VAEï¼ŒGANç­‰ã€‚æœ€è¿‘å¤§ç«çš„diffusion modelåˆ™ä½¿ç”¨äº†ä¸€ç§éå¸¸æœ‰è¶£çš„æ€æƒ³æ¥åšç”Ÿæˆä»»åŠ¡ã€‚</p><h2 id="äºŒã€å¤šæ¨¡æ€ä¸è·¨æ¨¡æ€çš„åº”ç”¨ï¼šæ–°çš„äº¤äº’æ–¹å¼"><a href="#äºŒã€å¤šæ¨¡æ€ä¸è·¨æ¨¡æ€çš„åº”ç”¨ï¼šæ–°çš„äº¤äº’æ–¹å¼" class="headerlink" title="äºŒã€å¤šæ¨¡æ€ä¸è·¨æ¨¡æ€çš„åº”ç”¨ï¼šæ–°çš„äº¤äº’æ–¹å¼"></a>äºŒã€å¤šæ¨¡æ€ä¸è·¨æ¨¡æ€çš„åº”ç”¨ï¼šæ–°çš„äº¤äº’æ–¹å¼</h2><p>å¤šæ¨¡æ€åº”ç”¨å…è®¸æˆ‘ä»¬é€šè¿‡åˆ©ç”¨æ¯ç§æ–¹å¼çš„ä¼˜åŠ¿æ¥ç»“åˆä¸åŒçš„æ¨¡æ€ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯¹è¯ä¸­åŒæ—¶ä½¿ç”¨å£è¯­å’Œä¹¦é¢è¯­è¨€ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬ç›¸äº’ç†è§£ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å›¾ç‰‡æˆ–è§†é¢‘ç­‰ä½œä¸ºè§†è§‰è¾…åŠ©å·¥å…·ï¼Œæ¥å¸®åŠ©è§£é‡Šä»…ç”¨æ–‡å­—éš¾ä»¥æè¿°çš„äº‹ç‰©ã€‚</p><p>è·¨æ¨¡æ€åº”ç”¨é’ˆå¯¹çš„æ˜¯æ¥è‡ªä¸åŒæ¨¡æ€ï¼ˆå¦‚è§†è§‰å’Œå¬è§‰ï¼‰çš„è¾“å…¥å’Œè¾“å‡ºã€‚å®ƒé€šè¿‡ä½¿ç”¨ä¸€ç§æ„Ÿå®˜çš„ä¿¡æ¯æ¥å¢å¼ºå¦ä¸€ç§æ„Ÿå®˜ï¼Œä½¿ç”¨æˆ·ä½“éªŒæ¯”ä¼ ç»Ÿåº”ç”¨æ›´ä¸Šä¸€å±‚æ¥¼ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è§¦æ‘¸çš„æ–¹å¼æ¥å¸®åŠ©æˆ‘ä»¬ç†è§£åœ¨è§¦è§‰åœ°å›¾æˆ–ç›²æ–‡æ–‡æœ¬ä¸­çœ‹åˆ°çš„å†…å®¹ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å£°éŸ³æ¥å¸®åŠ©æˆ‘ä»¬å®šä½ç¯å¢ƒä¸­çš„äº‹ç‰©ï¼Œä¸€èˆ¬é€šè¿‡å£°çº³æˆ–é›·è¾¾æ¥å®Œæˆã€‚</p><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a href="https://medium.com/jina-ai/multimodal-and-crossmodal-applications-the-new-way-to-interact-d73d3e932990">https://medium.com/jina-ai/multimodal-and-crossmodal-applications-the-new-way-to-interact-d73d3e932990</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬ç¯‡æ˜¯ VCED è·¨æ¨¡æ€æ£€ç´¢å·¥å…·ä»‹ç»çš„ç¬¬ä¸‰ç¯‡ï¼Œä»‹ç» VCED å®ç°è·¨æ¨¡æ€æ£€ç´¢çš„æ ¸å¿ƒæ¨¡å‹å’Œç®—æ³•ã€‚æœ¬ç¯‡æ–‡ç« åªèƒ½è¯´æµ…å°è¾„æ­¢ï¼Œæ›´æ·±å…¥çš„æ€è€ƒè¿˜éœ€åç»­è¡¥å……ã€‚&lt;/p&gt;
&lt;!--more---&gt;
&lt;h2 id=&quot;ä¸€ã€CLIP-æ¨¡å‹&quot;&gt;&lt;a href=&quot;#ä¸€ã€CLIP-æ¨¡å‹&quot; class=&quot;</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="VCED" scheme="https://superlova.github.io/tags/VCED/"/>
    
    <category term="multimodal" scheme="https://superlova.github.io/tags/multimodal/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æå®æ¯…ML-Note8-è‡ªç›‘ç£å­¦ä¹ ã€BERT</title>
    <link href="https://superlova.github.io/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/"/>
    <id>https://superlova.github.io/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/</id>
    <published>2022-11-17T08:09:44.000Z</published>
    <updated>2022-11-18T12:48:10.804Z</updated>
    
    <content type="html"><![CDATA[<p>æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šè‡ªç›‘ç£å­¦ä¹ ã€BERTã€GPTã€‚</p><!--more---><h2 id="äºŒã€è‡ªç›‘ç£å­¦ä¹ "><a href="#äºŒã€è‡ªç›‘ç£å­¦ä¹ " class="headerlink" title="äºŒã€è‡ªç›‘ç£å­¦ä¹ "></a>äºŒã€è‡ªç›‘ç£å­¦ä¹ </h2><p>è‡ªç›‘ç£å­¦ä¹ ç”± Yann LeCun åœ¨ 2019 å¹´é¦–æ¬¡æå‡ºï¼Œæ¨¡å‹ä¼šä»æ— æ ‡ç­¾çš„æ•°æ®ä¸­é‡‡å–æŸäº›æ–¹æ³•æ„å»ºæ ‡ç­¾ï¼Œç„¶åè¿›è¡Œå­¦ä¹ ã€‚ç”±äºè‡ªç›‘ç£å­¦ä¹ ä¸éœ€è¦äººä¸ºå¯¹æ•°æ®è¿›è¡Œæ ‡ç­¾ï¼Œå› æ­¤è‡ªç›‘ç£å­¦ä¹ å¯ä»¥çœ‹åšæ— ç›‘ç£å­¦ä¹ çš„ä¸€ç§ã€‚</p><p>è‡ªç›‘ç£å­¦ä¹ å¸¸ç”¨äºè®­ç»ƒå¤§è§„æ¨¡çš„è¯­è¨€æ¨¡å‹ï¼Œæ¯”å¦‚ BERTã€GPT ç­‰ã€‚ç”±äºè¿™äº›æ¨¡å‹çš„å‚æ•°é‡éå¸¸å¤§ï¼Œå› æ­¤è®­ç»ƒæ¨¡å‹æ‰€éœ€çš„æ•°æ®é‡ä¹Ÿéå¸¸å¤§ï¼Œç”šè‡³å¤§åˆ°äººå·¥æ ‡æ³¨æ— æ³•å®Œæˆçš„ç¨‹åº¦ã€‚</p><p>BERT çš„è®­ç»ƒæ•°æ®åŒ…å«æ•´ä¸ªç»´åŸºç™¾ç§‘çš„æ— æ ‡ç­¾å·æ–‡æœ¬çš„å¤§è¯­æ–™åº“ä¸­ï¼ˆè¶³è¶³æœ‰25äº¿å­—ï¼ï¼‰ å’Œå›¾ä¹¦è¯­æ–™åº“ï¼ˆæœ‰8äº¿å­—ï¼‰ï¼›ä½¿ç”¨è‡ªç›‘ç£å­¦ä¹ èƒ½æ›´é«˜æ•ˆã€æ›´ç›´æ¥åœ°ä»æ•°æ®ä¸­å­¦åˆ°çŸ¥è¯†ï¼Œé¿å…äººå·¥æ ‡æ³¨å¸¦æ¥çš„æˆæœ¬ã€‚</p><p>ä¸‹é¢ä»‹ç»å‡ ä¸ª BERT ä½¿ç”¨åˆ°çš„è‡ªç›‘ç£å­¦ä¹ æ–¹æ³•ã€‚</p><h3 id="1-Masking-Input"><a href="#1-Masking-Input" class="headerlink" title="1. Masking Input"></a>1. Masking Input</h3><p>BERT çš„è¾“å…¥æ˜¯ä¸€ä¸ªå¥å­ï¼Œå¥å­ç”±è‹¥å¹² token ç»„æˆã€‚Masking Input è®­ç»ƒä»»åŠ¡å°±æ˜¯éšæœº Mask å¥å­ä¸­çš„è¯ï¼Œæ¥æ„å»º {å¡«ç©ºé¢˜, ç­”æ¡ˆ} è¿™æ ·çš„æ•°æ®ã€‚</p><p>Mask æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå¯ä»¥ç›´æ¥æ›¿æ¢ä¸º [MSK] è¿™ç§å…¨æ–°çš„ç‰¹æ®Šç¬¦å·ï¼Œæˆ–è€…æ›¿æ¢ä¸ºä»»æ„ä¸€ä¸ªå…¶ä»–å­—ã€‚</p><p>åˆ°åº•ç”¨å“ªä¸€ç§ä¹Ÿæ˜¯éšæœºå†³å®šçš„ã€‚åœ¨åŸæ–‡ä¸­ï¼Œ80%çš„æ•°æ®æ˜¯ç”± [MSK] ç‰¹æ®Šç¬¦å·æ›¿æ¢æ–¹æ³•æ¥ç”Ÿæˆçš„ï¼Œ10%çš„æ•°æ®æ˜¯ä»¥å…¶ä»–è¯è¿›è¡Œæ›¿æ¢ç”Ÿæˆçš„ï¼Œè¿˜æœ‰ 10%çš„æ•°æ®æ˜¯ä¿æŒåŸæ ·ç”Ÿæˆçš„ã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹ BERT ä¼šé¢„æµ‹ [MSK] å¯¹åº”çš„å­—æ˜¯å“ªä¸€ä¸ªï¼ŒæŠŠç›–ä½çš„éƒ¨åˆ†å¯¹åº”çš„è¾“å‡ºå‘é‡åšçº¿æ€§å˜æ¢ï¼Œåš softmax äº§å‡ºä¸€ä¸ªåˆ†å¸ƒã€‚ç”±æ­¤ï¼Œå˜æˆäº†ä¸€ä¸ªç›‘ç£å­¦ä¹ çš„åˆ†ç±»ä»»åŠ¡ã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/masking_input.png" alt></p><p>è®­ç»ƒæ–¹æ³•ï¼šä¸ ground truth è¿›è¡Œæœ€å°åŒ–äº¤å‰ç†µã€‚</p><h3 id="2-Next-Sentence-Prediction"><a href="#2-Next-Sentence-Prediction" class="headerlink" title="2. Next Sentence Prediction"></a>2. Next Sentence Prediction</h3><p>é€‰æ‹©å¥å­Aå’ŒBä½œä¸ºé¢„è®­ç»ƒæ ·æœ¬ï¼šBæœ‰50%çš„å¯èƒ½æ˜¯Açš„ä¸‹ä¸€å¥ï¼Œä¹Ÿæœ‰50%çš„å¯èƒ½æ˜¯æ¥è‡ªè¯­æ–™åº“çš„éšæœºå¥å­ã€‚</p><pre><code>[cls] w1 w2 [sep] w3 w4 w5</code></pre><p>åªå– cls å¯¹åº”çš„è¾“å‡ºï¼Œç„¶åé¢„æµ‹ yes or noï¼Œåˆ¤æ–­è¿™ä¸¤ä¸ªå¥å­æ˜¯å¦ç›¸æ¥ã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/next_sentence_pred.png" alt></p><p>è¿™ä¸€æ‹›ä¸å¤ªæœ‰ç”¨ï¼ŒRoBERTa èˆå¼ƒäº†è¯¥æ–¹æ³•ã€‚å¯èƒ½æ˜¯è¿™ä¸ªä»»åŠ¡å¤ªç®€å•äº†ï¼Œå­¦ä¸åˆ°å¤ªæœ‰ç”¨çš„ä¸œè¥¿ã€‚</p><h3 id="3-Sentence-Order-Prediction"><a href="#3-Sentence-Order-Prediction" class="headerlink" title="3. Sentence Order Prediction"></a>3. Sentence Order Prediction</h3><p>ALBERT çš„è®­ç»ƒæ–¹æ³•ï¼Œåˆ¤æ–­ä¸¤å¥çš„é¡ºåºæˆ–è€…é€†åºã€‚</p><h3 id="4-å¦‚ä½•è¯„ä¼°å­¦ä¹ çš„æ•ˆæœï¼Ÿ"><a href="#4-å¦‚ä½•è¯„ä¼°å­¦ä¹ çš„æ•ˆæœï¼Ÿ" class="headerlink" title="4. å¦‚ä½•è¯„ä¼°å­¦ä¹ çš„æ•ˆæœï¼Ÿ"></a>4. å¦‚ä½•è¯„ä¼°å­¦ä¹ çš„æ•ˆæœï¼Ÿ</h3><p>è¯„ä¼°æ–¹æ³•ï¼šGLUEï¼ˆGeneral Language Understanding Evaluationï¼‰</p><p>æœ‰ä¹å¤§ä»»åŠ¡ï¼Œè¯„ä¼°é¢„è®­ç»ƒæ¨¡å‹çš„å¥½åã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/glue_score_9_missions.png" alt></p><h2 id="ä¸‰ã€å¦‚ä½•ä½¿ç”¨-BERT"><a href="#ä¸‰ã€å¦‚ä½•ä½¿ç”¨-BERT" class="headerlink" title="ä¸‰ã€å¦‚ä½•ä½¿ç”¨ BERT"></a>ä¸‰ã€å¦‚ä½•ä½¿ç”¨ BERT</h2><p>é¢„è®­ç»ƒæ¨¡å‹å®Œæˆè®­ç»ƒåï¼Œéœ€è¦å°†æ¨¡å‹å­¦ä¹ åˆ°çš„çŸ¥è¯†è¿ç§»åˆ°å…¶ä»–é¢†åŸŸã€‚è¿™ä¸ªè¿ç§»çš„è¿‡ç¨‹å«åšå¾®è°ƒï¼ˆfine-tuningï¼‰ã€‚å¾®è°ƒéœ€è¦ä¸€å®šçš„æ ‡æ³¨æ•°æ®ï¼Œè¿›è¡Œç›‘ç£å­¦ä¹ ã€‚æ ¹æ®ä¸‹æ¸¸ä»»åŠ¡ä¸åŒï¼Œæ‰€éœ€è¦çš„æ ‡æ³¨æ•°æ®ä¸åŒã€‚</p><h3 id="1-æ–‡æœ¬åˆ†ç±»ï¼š"><a href="#1-æ–‡æœ¬åˆ†ç±»ï¼š" class="headerlink" title="1. æ–‡æœ¬åˆ†ç±»ï¼š"></a>1. æ–‡æœ¬åˆ†ç±»ï¼š</h3><p>æ–‡æœ¬åˆ†ç±»ä»¥ä¸€ä¸²æ–‡æœ¬ä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œè¡¨æ˜è¯¥ä¸²æ–‡æœ¬è¢«åˆ†æˆå„ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚</p><p>INPUT:</p><pre><code>[cls] w1 w2 w3</code></pre><p>OUTPUT:<br>çœ‹ [cls] çš„è¾“å‡ºåˆ†å¸ƒï¼Œç„¶åä¸çœŸå®æ ‡æ³¨è¿›è¡Œå¯¹æ¯”ï¼Œæœ€å°äº¤å‰ç†µã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/bert_classification.png" alt></p><p>è®­ç»ƒæ—¶ï¼Œlinear çº¿æ€§å˜æ¢çŸ©é˜µçš„å‚æ•°æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œé¢„è®­ç»ƒçš„å‚æ•°æ˜¯ç›´æ¥ä¸‹è½½çš„ã€‚</p><p>fine tuning æ—¶ï¼Œæ‰€æœ‰éƒ¨åˆ†çš„å‚æ•°éƒ½ä¼šæ¢¯åº¦ä¸‹é™è¿›è¡Œä¼˜åŒ–ã€‚</p><h3 id="2-åºåˆ—æ ‡æ³¨"><a href="#2-åºåˆ—æ ‡æ³¨" class="headerlink" title="2. åºåˆ—æ ‡æ³¨"></a>2. åºåˆ—æ ‡æ³¨</h3><p>è¾“å…¥ä¸€ä¸ªåºåˆ—ï¼Œè¾“å‡ºå¦ä¸€ä¸ªåºåˆ—ã€‚</p><pre><code>[cls] w1 w2 w3 w4</code></pre><p>BERT ä»¥ä¸€ä¸ª [cls] å¼€å¤´çš„åºåˆ—ä¸ºè¾“å…¥ï¼Œå¯¹äºæ¯ä¸ª tokenï¼Œéƒ½ä¼šäº§å‡ºå‘é‡ï¼Œå¹¶è½¬åŒ–ä¸ºé¢„æµ‹è¯¥ token çš„è¯æ€§ã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/pos_tagging.png" alt></p><h3 id="3-è¯­ä¹‰æ¨ç†"><a href="#3-è¯­ä¹‰æ¨ç†" class="headerlink" title="3. è¯­ä¹‰æ¨ç†"></a>3. è¯­ä¹‰æ¨ç†</h3><p>Natural Language Inference ï¼Œè¾“å…¥ä¸¤ä¸ªå¥å­ï¼Œè¾“å‡ºä¸¤ä¸ªå¥å­çš„é€»è¾‘å…³ç³»ï¼Œå¤šåˆ†ç±»é—®é¢˜ã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/natural_language_inference.png" alt></p><p>å¯ä»¥æ‰©å±•åˆ°è¯„è®ºç«‹åœºåˆ¤æ–­ï¼Œè¾“å…¥åŸæ–‡+è¯„è®ºï¼Œè¾“å‡ºè¯»è€…å¯¹æ­¤çš„æ€åº¦ï¼Œæ”¯æŒåå¯¹è¿˜æ˜¯ä¸­ç«‹ã€‚</p><h3 id="4-é—®ç­”ç³»ç»Ÿ"><a href="#4-é—®ç­”ç³»ç»Ÿ" class="headerlink" title="4. é—®ç­”ç³»ç»Ÿ"></a>4. é—®ç­”ç³»ç»Ÿ</h3><p>ç»™å®šä¸€ç¯‡æ–‡ç« +ä¸€ä¸ªé—®é¢˜ï¼Œæœºå™¨äº§å‡ºç­”æ¡ˆåœ¨åŸæ–‡ä¸­çš„ä½ç½®ï¼Œåˆ†åˆ«æ˜¯èµ·å§‹èŠ‚ç‚¹å’Œç»ˆæ­¢èŠ‚ç‚¹ã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/extraction_based_question_answering.png" alt></p><p>æˆ‘ä»¬éœ€è¦å°†è¾“å…¥æ•´ç†æˆ query + documentï¼Œè¾“å‡ºä¸¤ä¸ªä½ç½®ï¼Œstart_pos å’Œ end_pos ï¼Œåœ¨åŸæ–‡ä¸­ [start_pos, end_pos] å†…çš„ä½ç½®å°±æ˜¯æ¨¡å‹è®¤ä¸ºçš„ç­”æ¡ˆã€‚å¦‚æœ start_pos å’Œ end_pos éƒ½ä¸º 0ï¼Œåˆ™æ¨¡å‹è®¤ä¸ºæ²¡æœ‰ç­”æ¡ˆã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/extraction_based_qa_input_output.png" alt></p><p>åœ¨è¿™é‡Œå”¯ä¸€éœ€è¦ä»å¤´å¼€å§‹è®­ç»ƒçš„æ¨¡å—æ˜¯å¦‚ä¸Šå›¾æ‰€ç¤ºçš„<font color="Orange">æ©™è‰²</font>å’Œ<font color="Blue">è“è‰²</font>å‘é‡ã€‚</p><p>é¦–å…ˆæŠŠæ©™è‰²å‘é‡è·Ÿæ¯ä¸ª document çš„ N ä¸ªè¯å‘é‡å¯¹åº”çš„è¾“å‡ºå‘é‡åšç‚¹ç§¯ï¼Œç®—å‡º N ä¸ªæ•°å€¼ï¼Œç„¶åè¿‡ä¸€ä¸‹ softmax å¾—åˆ°æ¦‚ç‡åˆ†å¸ƒã€‚å–æœ€é«˜çš„å€¼ä¸º start_posã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note8-%E8%87%AA%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E3%80%81BERT/extraction_based_qa_input_outout_2.png" alt></p><p>ç„¶åæŠŠè“è‰²å‘é‡è·Ÿæ¯ä¸ª document çš„ N ä¸ªè¯å‘é‡é”™å¯¹åº”çš„è¾“å‡ºå‘é‡åšç‚¹ç§¯ï¼Œç®—å‡º N ä¸ªæ•°å€¼ï¼ŒåŒæ ·å–æœ€å¤§åå†³å®š end_posã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹ç±»æ¯” self-attentionï¼Œå°±å¥½åƒæˆ‘ä»¬è¦è®­ç»ƒ query å‘é‡å¯¹åº”çš„ Q çŸ©é˜µã€‚</p><p>å®é™…ä¸Š BERT çš„è¾“å…¥åºåˆ—ä¸€èˆ¬ä¸º 512ï¼Œè€Œä¸€æ•´ç¯‡æ–‡ç« å¾€å¾€å·¨é•¿æ— æ¯”ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ¯æ¬¡åªæ‹¿ä¸€å°æ®µä¸€å°æ®µ document è¿›è¡Œè®­ç»ƒï¼Œåªæœ‰ä¸€ä¸ªæœ‰æ­£ä¾‹ã€‚</p><h3 id="â€”â€”â€”"><a href="#â€”â€”â€”" class="headerlink" title="â€”â€”â€”"></a>â€”â€”â€”</h3><p>Bert æŸå¤±å‡½æ•°ç»„æˆ</p><p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯æ¥è‡ª Mask-LM çš„å•è¯çº§åˆ«åˆ†ç±»ä»»åŠ¡ï¼›<br>å¦ä¸€éƒ¨åˆ†æ˜¯å¥å­çº§åˆ«çš„åˆ†ç±»ä»»åŠ¡ï¼›</p><p>æ‰€ç”¨çš„æŸå¤±å‡½æ•°å«åšè´Ÿå¯¹æ•°ä¼¼ç„¶å‡½æ•°</p><p>BERT åˆ™æ˜¯é€šè¿‡ã€Œtransformer ç¼–ç å™¨ã€æ¨¡å—æ„å»ºçš„ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šè‡ªç›‘ç£å­¦ä¹ ã€BERTã€GPTã€‚&lt;/p&gt;
&lt;!--more---&gt;
&lt;h2 id=&quot;äºŒã€è‡ªç›‘ç£å­¦ä¹ &quot;&gt;&lt;a href=&quot;#äºŒã€è‡ªç›‘ç£å­¦ä¹ &quot; class=&quot;headerlink&quot; title=&quot;äºŒã€è‡ªç›‘ç£å­¦ä¹ &quot;&gt;&lt;</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="BERT" scheme="https://superlova.github.io/tags/BERT/"/>
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="MOOC" scheme="https://superlova.github.io/tags/MOOC/"/>
    
    <category term="Self-Supervised Learning" scheme="https://superlova.github.io/tags/Self-Supervised-Learning/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘é€šè¿‡æ–‡å­—æ£€ç´¢è§†é¢‘ç‰‡æ®µï¼šVCEDä¹‹Jina</title>
    <link href="https://superlova.github.io/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E4%B9%8BJina/"/>
    <id>https://superlova.github.io/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E4%B9%8BJina/</id>
    <published>2022-11-16T16:33:03.000Z</published>
    <updated>2022-11-23T17:19:09.208Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯ VCED è·¨æ¨¡æ€æ£€ç´¢ä»‹ç»çš„ç¬¬äºŒç¯‡ï¼Œæœ¬ç¯‡å°†ä»‹ç» VCED å·¥å…·èƒŒåçš„å…³é”®æ¡†æ¶ï¼šJinaã€‚</p><!--more---><p>Jina æ˜¯ä¸€ä¸ªèƒ½å¤Ÿå°†éç»“æ„åŒ–æ•°æ®ä¾‹å¦‚å›¾åƒï¼Œæ–‡æ¡£è§†é¢‘ç­‰ï¼Œè½¬æ¢ä¸ºå‘é‡æ•°æ®çš„å·¥å…·ã€‚åˆ©ç”¨è¯¥å·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿå®ç°å¤šæ¨¡æ€çš„æ£€ç´¢ä»»åŠ¡ã€‚å¦å¤–ï¼ŒJina ä¹Ÿæ˜¯ä¸€å®¶æ–°çš„å…¬å¸ï¼Œç›®å‰æ­£åœ¨ä¼˜åŒ–ä¸­ã€‚ä»–ä»¬çš„ <a href="https://github.com/jina-ai/jina">GitHub Repo</a>ã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E4%B9%8BJina/jina%20introduction.png" alt></p><p>å…¶å® Jina å…¬å¸æä¾›äº†åŒ…æ‹¬å‘é‡åŒ–ã€æœåŠ¡åŒ–åˆ°å®é™…éƒ¨ç½²çš„å…¨éƒ¨å·¥å…·ï¼Œå¯ä»¥æ”¯æŒåŒ…æ‹¬ PDF æ£€ç´¢ã€è§†é¢‘æ£€ç´¢åœ¨å†…çš„å¾ˆå¤šæ£€ç´¢æ“ä½œã€‚</p><p><img src="/2022/11/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED%E4%B9%8BJina/jina_å…¨å®¶æ¡¶.png" alt></p><h2 id="1-Jina-å®‰è£…"><a href="#1-Jina-å®‰è£…" class="headerlink" title="1. Jina å®‰è£…"></a>1. Jina å®‰è£…</h2><p>åœ¨ windows ç³»ç»Ÿä¸Šçš„å®‰è£…æ•™ç¨‹ï¼š</p><p><a href="https://blog.csdn.net/Jina_AI/article/details/122820646">https://blog.csdn.net/Jina_AI/article/details/122820646</a></p><p>æœ¬æ–‡å°†è®°å½•åœ¨ mac ä¸Šå®‰è£… jina çš„è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆç¡®ä¿è‡ªå·±çš„ Python ç‰ˆæœ¬åœ¨ 3.7 åŠä»¥ä¸Šï¼Œç„¶åé€šè¿‡ä¸‹åˆ—æ–¹å¼å®‰è£… jinaï¼š</p><pre><code class="lang-sh"># via pypipip install jina# via condaconda install jina -c conda-forge# via dockerdocker pull jinaai/jina:latest</code></pre><p>ä½¿ç”¨ pip å®‰è£… jina æ—¶ï¼Œæç¤ºï¼š</p><pre><code>lz4/_version.c:32:10: fatal error: &#39;Python.h&#39; file not foundERROR: Failed building wheel for lz4Successfully built jina docarray grpcio jcloud python-multipartFailed to build lz4ERROR: Could not build wheels for lz4, which is required to install pyproject.toml-based projects</code></pre><p>åŸå› ï¼šç³»ç»Ÿä¸­æ²¡æœ‰ Python.hï¼Œæ˜¯å› ä¸ºæ²¡æœ‰å®‰è£… python çš„å¼€å‘ç‰ˆï¼Œå³ Python-devel è¿™ä¸ªåŒ…ã€‚</p><h2 id="2-Jina-çš„åŸºæœ¬ç»„ä»¶"><a href="#2-Jina-çš„åŸºæœ¬ç»„ä»¶" class="headerlink" title="2. Jina çš„åŸºæœ¬ç»„ä»¶"></a>2. Jina çš„åŸºæœ¬ç»„ä»¶</h2><p>è¯¦ç»†çš„æ–‡æ¡£å¯ä»¥å‚è€ƒ<a href="https://docs.jina.ai/fundamentals/architecture-overview/">è¿™é‡Œ</a>ã€‚</p><p>Documentã€Executor å’Œ Flow æ˜¯ Jina çš„ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µï¼Œåˆ†åˆ«ä»£è¡¨æ•°æ®ç±»å‹ï¼Œç®—æ³•å•å…ƒï¼Œå’Œå·¥ä½œæµã€‚</p><p>ç®€å•æ¥è¯´ï¼ŒDocument æ˜¯ä¸€ç§æ•°æ®ç±»å‹çš„å®šä¹‰æ–¹å¼ï¼ŒFlow åˆ™æ˜¯è´Ÿè´£ Document åœ¨æ•´ä¸ªæ¶æ„é—´çš„ä¼ è¾“ï¼Œæœ€å Executor åˆ™å®ç°å…·ä½“çš„ç®—æ³•åŠŸèƒ½ã€‚</p><p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªç®€å•çš„ Demoï¼Œå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ç»™æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ç«¯å¤„å­˜åœ¨å®šä¹‰å¥½çš„ Flowï¼ŒFlow åˆ™ä¼šæŠŠä¸åŒçš„ Executor ä¸²è”èµ·æ¥ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªå·²ç»å®šä¹‰å¥½çš„ Executorï¼Œåˆ†åˆ«æ‰§è¡Œå°†å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ ç‰¹å®šå­—ç¬¦çš„æ“ä½œã€‚</p><p>æœåŠ¡å™¨ç«¯ä»£ç ï¼š</p><pre><code class="lang-py">from jina import DocumentArray, Executor, Flow, requestsclass FooExec(Executor):    @requests    async def add_text(self, docs: DocumentArray, **kwargs):        for d in docs:            d.text += &#39;hello, world!&#39;class BarExec(Executor):    @requests    async def add_text(self, docs: DocumentArray, **kwargs):        for d in docs:            d.text += &#39;goodbye!&#39;f = Flow(port=12345).add(uses=FooExec, replicas=3).add(uses=BarExec, replicas=2)with f:    f.block()</code></pre><p>å®¢æˆ·ç«¯ä»£ç ï¼š</p><pre><code class="lang-py">from jina import Client, DocumentArrayc = Client(port=12345)r = c.post(&#39;/&#39;, DocumentArray.empty(2))print(r.texts)</code></pre><p>è¿è¡Œé€»è¾‘åŠ¨å›¾ä¸ºï¼š</p><p><img src="https://docs.jina.ai/_images/arch-overview.svg" alt="jina_overview"></p><p>è¿”å›ç»“æœä¸ºï¼š</p><pre><code>[&#39;hello, world!goodbye!&#39;, &#39;hello, world!goodbye!&#39;]</code></pre><h2 id="3-å¯åŠ¨-jina-ç¤ºä¾‹"><a href="#3-å¯åŠ¨-jina-ç¤ºä¾‹" class="headerlink" title="3. å¯åŠ¨ jina ç¤ºä¾‹"></a>3. å¯åŠ¨ jina ç¤ºä¾‹</h2><p>å®‰è£…å®Œæ¯•åï¼Œæ–°å»º toy.yml ä½œä¸º gRPC æœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼š</p><pre><code class="lang-yaml"># toy.ymljtype: Flowwith:  port: 51000  protocol: grpcexecutors:- uses: FooExecutor  name: foo  py_modules:    - test.py- uses: BarExecutor  name: bar  py_modules:    - test.py</code></pre><p>ç„¶åå®šä¹‰ test.py ï¼Œå®šä¹‰è‹¥å¹² Executor çš„å¤„ç†é€»è¾‘ï¼š</p><p>test.py</p><pre><code class="lang-py"># åˆ›å»º test.py æ–‡ä»¶ä¸ YAML æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹# å¯¼å…¥ documentã€executor å’Œ flow ä»¥åŠ requests è£…é¥°å™¨from jina import DocumentArray, Executor, requests, Document# ç¼–å†™ FooExecutor ä¸ BarExecutor ç±»ï¼Œç±»ä¸­å®šä¹‰äº†å‡½æ•° foo å’Œ bar# è¯¥å‡½æ•°ä»ç½‘ç»œè¯·æ±‚æ¥æ”¶ DocumentArray (å…ˆæš‚æ—¶ä¸éœ€è¦ç†è§£å®ƒæ˜¯ä»€ä¹ˆ)ï¼Œå¹¶åœ¨å…¶å†…å®¹åé¢é™„åŠ  &quot;foo was here&quot; ä¸ &quot;bar was here&quot;class FooExecutor(Executor):    @requests # ç”¨äºæŒ‡å®šè·¯ç”±ï¼Œç±»ä¼¼ç½‘é¡µè®¿é—® /index å’Œ /login ä¼šè¢«è·¯ç”±åˆ°ä¸åŒçš„æ–¹æ³•ä¸Šæ˜¯ç”¨æ ·çš„æ¦‚å¿µï¼Œå…³äº request ä¸‹é¢ä¼šå†è¿›è¡Œè¯¦ç»†ä»‹ç»    def foo(self, docs: DocumentArray, **kwargs):        docs.append(Document(text=&#39;foo was here&#39;))class BarExecutor(Executor):    @requests    def bar(self, docs: DocumentArray, **kwargs):        docs.append(Document(text=&#39;bar was here&#39;))</code></pre><p>ç„¶åä½¿ç”¨è¯¥æŒ‡ä»¤å¯åŠ¨æœåŠ¡ï¼š</p><pre><code class="lang-sh">jina flow --uses toy.yml</code></pre><p>å¯åŠ¨æœåŠ¡ä¹‹åæ”¾ç€åˆ«åŠ¨ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª shell çª—å£ï¼›ç„¶åæ–°å»º client.pyï¼Œç”¨äºå‚¨å­˜å®¢æˆ·ç«¯è¯·æ±‚æ¶ˆæ¯çš„é€»è¾‘ï¼š</p><p>client.py</p><pre><code class="lang-py"># ä» Jina ä¸­å¯¼å…¥è¿æ¥çš„å®¢æˆ·ç«¯ä¸ Documentfrom jina import Client, Documentc = Client(host=&#39;grpc://0.0.0.0:51000&#39;)  # å¦‚æœè¿è¡Œæç¤ºå¤±è´¥ï¼Œå¯å°è¯•ä½¿ç”¨localhostresult = c.post(&#39;/&#39;, Document()) # å°†ä¸€ä¸ªç©ºçš„ Document ä¼ åˆ°æœåŠ¡ç«¯æ‰§è¡Œprint(result.texts)</code></pre><p>éšåå¯åŠ¨å®¢æˆ·ç«¯ï¼š</p><pre><code class="lang-sh">python client.py</code></pre><p>æœ€ç»ˆä¼šæ‰“å°å‡ºä¸€ä¸ª â€œ[â€˜â€™, â€˜foo was hereâ€™, â€˜bar was hereâ€™]â€ å­—ç¬¦ä¸²ã€‚</p><h2 id="4-DocArray-ç®€ä»‹"><a href="#4-DocArray-ç®€ä»‹" class="headerlink" title="4. DocArray ç®€ä»‹"></a>4. DocArray ç®€ä»‹</h2><p>DocArray ä¹Ÿæ˜¯ä¸€ä¸ªå·¥å…·åŒ…ï¼Œå®ƒè¢«æ•´åˆåœ¨ Jina ä¸­ï¼Œä½œä¸º Jina çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæ–¹ä¾¿å®ç°è·¨æ¨¡æ€åº”ç”¨ã€‚å…³äº DocArray çš„å…¶ä»–èµ„æ–™å¯ä»¥å‚è€ƒ<a href="https://docarray.jina.ai/">è¿™é‡Œ</a>ã€‚</p><p>DocArray ç±»æ¯” Pandasï¼Œå…¶åŸºæœ¬æ•°æ®ç±»å‹ä¸º Documentï¼Œå¹¶æ•´åˆäº†å¤šç§æ“ä½œ Document çš„æ–¹æ³•ã€‚DocArray å¯¹æ•°æ®é‡‡ç”¨åˆ†å±‚ç»“æ„å­˜å‚¨ã€‚</p><blockquote><p>å¯ä»¥åˆ©ç”¨ DocArray å®ç°åœ¨ç¬¬ä¸€å±‚å­˜å…¥è¯¥ç”»é¢çš„è§†é¢‘ï¼Œç¬¬äºŒå±‚å­˜å…¥è¯¥è§†é¢‘çš„ä¸åŒé•œå¤´ï¼Œç¬¬ä¸‰å±‚å¯ä»¥æ˜¯è§†é¢‘çš„æŸä¸€å¸§ï¼Œä¹Ÿå¯ä»¥å­˜å‚¨å°å°è¯ç­‰ç­‰ï¼Œè¿™ä½¿å¾—ä½ å¯ä»¥é€šè¿‡å°è¯å»æœç´¢åˆ°è§†é¢‘ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è§†é¢‘å®šä½æŸå‡ å¸§ç”»é¢ï¼Œè¿™æ ·æœç´¢çš„é¢—ç²’åº¦ï¼Œç»“æ„çš„å¤šæ ·æ€§å’Œç»“æœçš„ä¸°å¯Œåº¦ï¼Œéƒ½æ¯”ä¼ ç»Ÿæ–‡æœ¬æ£€ç´¢å¥½å¾ˆå¤šã€‚</p></blockquote><h2 id="5-é€šè¿‡-DocArray-å¯¼å…¥ä»»æ„æ¨¡æ€çš„æ•°æ®"><a href="#5-é€šè¿‡-DocArray-å¯¼å…¥ä»»æ„æ¨¡æ€çš„æ•°æ®" class="headerlink" title="5. é€šè¿‡ DocArray å¯¼å…¥ä»»æ„æ¨¡æ€çš„æ•°æ®"></a>5. é€šè¿‡ DocArray å¯¼å…¥ä»»æ„æ¨¡æ€çš„æ•°æ®</h2><p>é¡¹ç›®ä»£ç å‚è€ƒ<a href="https://github.com/datawhalechina/vced/tree/main/code/jina_demo">è¿™é‡Œ</a>ã€‚æœ‰å°†å›¾ç‰‡ã€æ–‡æœ¬ã€è§†é¢‘åˆ†åˆ«å¯¼å…¥ Jina çš„å®ä¾‹ã€‚</p><h3 id="5-1-æ–‡æœ¬æ•°æ®å¯¼å…¥"><a href="#5-1-æ–‡æœ¬æ•°æ®å¯¼å…¥" class="headerlink" title="5.1 æ–‡æœ¬æ•°æ®å¯¼å…¥"></a>5.1 æ–‡æœ¬æ•°æ®å¯¼å…¥</h3><p><strong>åˆ›å»ºæ–‡æœ¬</strong></p><pre><code class="lang-py">from jina import Document  # å¯¼åŒ…# åˆ›å»ºç®€å•çš„æ–‡æœ¬æ•°æ®d = Document(text=&#39;hello, world.&#39;)print(d.text)  # é€šè¿‡textè·å–æ–‡æœ¬æ•°æ®# å¦‚æœæ–‡æœ¬æ•°æ®å¾ˆå¤§ï¼Œæˆ–è€…è‡ªURIï¼Œå¯ä»¥å…ˆå®šä¹‰URIï¼Œç„¶åå°†æ–‡æœ¬åŠ è½½åˆ°æ–‡æ¡£ä¸­d = Document(uri=&#39;https://www.w3.org/History/19921103-hypertext/hypertext/README.html&#39;)d.load_uri_to_text()print(d.text)# æ”¯æŒå¤šè¯­è¨€d = Document(text=&#39;ğŸ‘‹    à¤¨à¤®à¤¸à¥à¤¤à¥‡ à¤¦à¥à¤¨à¤¿à¤¯à¤¾!    ä½ å¥½ä¸–ç•Œï¼ã“ã‚“ã«ã¡ã¯ä¸–ç•Œï¼    ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ Ğ¼Ğ¸Ñ€!&#39;)print(d.text)</code></pre><p><strong>åˆ‡å‰²æ–‡æœ¬</strong></p><pre><code class="lang-py">from jina import Document  # å¯¼åŒ…d = Document(text=&#39;ğŸ‘‹    à¤¨à¤®à¤¸à¥à¤¤à¥‡ à¤¦à¥à¤¨à¤¿à¤¯à¤¾!    ä½ å¥½ä¸–ç•Œï¼ã“ã‚“ã«ã¡ã¯ä¸–ç•Œï¼    ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ Ğ¼Ğ¸Ñ€!&#39;)d.chunks.extend([Document(text=c) for c in d.text.split(&#39;!&#39;)])  # æŒ‰&#39;!&#39;åˆ†å‰²d.summary()</code></pre><p><strong>æ–‡æœ¬åŒ¹é…</strong></p><pre><code class="lang-py">from jina import Document, DocumentArrayd = Document(    uri=&#39;https://www.gutenberg.org/files/1342/1342-0.txt&#39;).load_uri_to_text()  # é“¾æ¥æ˜¯å‚²æ…¢ä¸åè§çš„ç”µå­ä¹¦ï¼Œæ­¤å¤„å°†ç”µå­ä¹¦å†…å®¹åŠ è½½åˆ° Document ä¸­da = DocumentArray(Document(text=s.strip()) for s in d.text.split(&#39;\n&#39;) if s.strip())  # æŒ‰ç…§æ¢è¡Œè¿›è¡Œåˆ†å‰²å­—ç¬¦ä¸²da.apply(lambda d: d.embed_feature_hashing())q = (    Document(text=&#39;she entered the room&#39;)  # è¦åŒ¹é…çš„æ–‡æœ¬    .embed_feature_hashing()  # é€šè¿‡ hash æ–¹æ³•è¿›è¡Œç‰¹å¾ç¼–ç     .match(da, limit=5, exclude_self=True, metric=&#39;jaccard&#39;, use_scipy=True)  # æ‰¾åˆ°äº”ä¸ªä¸è¾“å…¥çš„æ–‡æœ¬æœ€ç›¸ä¼¼çš„å¥å­)print(q.matches[:, (&#39;text&#39;, &#39;scores__jaccard&#39;)])  # è¾“å‡ºå¯¹åº”çš„æ–‡æœ¬ä¸ jaccard ç›¸ä¼¼æ€§åˆ†æ•°# è¾“å‡ºç»“æœï¼š# [[&#39;staircase, than she entered the breakfast-room, and congratulated&#39;, &#39;of the room.&#39;,#   &#39;She entered the room with an air more than usually ungracious,&#39;,#   &#39;entered the breakfast-room, where Mrs. Bennet was alone, than she&#39;, &#39;those in the room.&#39;],#  [&#123;&#39;value&#39;: 0.6&#125;, &#123;&#39;value&#39;: 0.6666666666666666&#125;, &#123;&#39;value&#39;: 0.6666666666666666&#125;, &#123;&#39;value&#39;: 0.6666666666666666&#125;,#   &#123;&#39;value&#39;: 0.7142857142857143&#125;]]</code></pre><h3 id="5-2-ä»å½±ç‰‡å¯¼å…¥"><a href="#5-2-ä»å½±ç‰‡å¯¼å…¥" class="headerlink" title="5.2 ä»å½±ç‰‡å¯¼å…¥"></a>5.2 ä»å½±ç‰‡å¯¼å…¥</h3><pre><code class="lang-py"># è§†é¢‘éœ€è¦ä¾èµ– av åŒ…# pip install avfrom jina import Documentd = Document(uri=&#39;cat.mp4&#39;)d.load_uri_to_video_tensor()# ç›¸è¾ƒäºå›¾åƒï¼Œè§†é¢‘æ˜¯ä¸€ä¸ª 4 ç»´æ•°ç»„ï¼Œç¬¬ä¸€ç»´è¡¨ç¤ºè§†é¢‘å¸§ id æˆ–æ˜¯è§†é¢‘çš„æ—¶é—´ï¼Œå‰©ä¸‹çš„ä¸‰ç»´åˆ™å’Œå›¾åƒä¸€è‡´ã€‚print(d.tensor.shape)  # (31, 1080, 1920, 3)# ä½¿ç”¨ append æ–¹æ³•å°† Document æ”¾å…¥ chunk ä¸­for b in d.tensor:    d.chunks.append(Document(tensor=b))d.chunks.plot_image_sprites(&#39;mov.png&#39;)</code></pre><p>è¿˜æœ‰è®¸å¤šå…¶ä»–çš„æ“ä½œæ–¹æ³•ï¼Œæœ‰å¾…åç»­è¿›ä¸€æ­¥å‘æ˜å’Œä½¿ç”¨ã€‚æ€»ä½“æ„Ÿè§‰è¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://u84gxokzmi.feishu.cn/docx/doxcn30HXXLbqFrsyR6bL5A6o1g">https://u84gxokzmi.feishu.cn/docx/doxcn30HXXLbqFrsyR6bL5A6o1g</a></p><p><a href="https://github.com/datawhalechina/vced">https://github.com/datawhalechina/vced</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™æ˜¯ VCED è·¨æ¨¡æ€æ£€ç´¢ä»‹ç»çš„ç¬¬äºŒç¯‡ï¼Œæœ¬ç¯‡å°†ä»‹ç» VCED å·¥å…·èƒŒåçš„å…³é”®æ¡†æ¶ï¼šJinaã€‚&lt;/p&gt;
&lt;!--more---&gt;
&lt;p&gt;Jina æ˜¯ä¸€ä¸ªèƒ½å¤Ÿå°†éç»“æ„åŒ–æ•°æ®ä¾‹å¦‚å›¾åƒï¼Œæ–‡æ¡£è§†é¢‘ç­‰ï¼Œè½¬æ¢ä¸ºå‘é‡æ•°æ®çš„å·¥å…·ã€‚åˆ©ç”¨è¯¥å·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿå®ç°å¤šæ¨¡æ€çš„æ£€ç´¢ä»»åŠ¡ã€‚å¦å¤–ï¼ŒJina ä¹Ÿæ˜¯</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="VCED" scheme="https://superlova.github.io/tags/VCED/"/>
    
    <category term="multimodal" scheme="https://superlova.github.io/tags/multimodal/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘é€šè¿‡æ–‡å­—æ£€ç´¢è§†é¢‘ç‰‡æ®µï¼šVCED</title>
    <link href="https://superlova.github.io/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/"/>
    <id>https://superlova.github.io/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/</id>
    <published>2022-11-14T14:12:07.000Z</published>
    <updated>2022-11-23T17:15:27.964Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡åšå®¢è®°å½•äº†ç¬”è€…åœ¨æœ¬æœºï¼ˆMacOSï¼‰éƒ¨ç½² VCED å¤šæ¨¡æ€æ•°æ®æ£€ç´¢å·¥å…·çš„å‰ç«¯å’Œåç«¯çš„è¿‡ç¨‹ï¼Œå¹¶å°è¯•ä½¿ç”¨è¯¥å·¥å…·æ£€ç´¢äº†ä¸€ä¸ªåŠ¨ç”»çŸ­ç‰‡ï¼Œå–å¾—äº†ä»¤æˆ‘æƒŠå¥‡çš„æ•ˆæœã€‚</p><!--more---><p>VCED: Video Clip Extraction by description, å¯ä»¥é€šè¿‡ä½ çš„æ–‡å­—æè¿°æ¥è‡ªåŠ¨è¯†åˆ«è§†é¢‘ä¸­ç›¸ç¬¦åˆçš„ç‰‡æ®µè¿›è¡Œè§†é¢‘å‰ªè¾‘ã€‚åŸºäºè·¨æ¨¡æ€æœç´¢ä¸å‘é‡æ£€ç´¢æŠ€æœ¯æ­å»ºã€‚</p><p>æœ¬é¡¹ç›®å‚è€ƒè‡ª <a href="https://github.com/datawhalechina/vced">Datawhale çš„ VCED å­¦ä¹ æ•™ç¨‹</a>ã€‚</p><p>ç¯å¢ƒä¸º Mac Monterey, Apple M1 Pro èŠ¯ç‰‡ï¼Œå†…å­˜ 16GBã€‚</p><h2 id="ç›´æ¥å®‰è£…-docker-é•œåƒ"><a href="#ç›´æ¥å®‰è£…-docker-é•œåƒ" class="headerlink" title="ç›´æ¥å®‰è£… docker é•œåƒ"></a>ç›´æ¥å®‰è£… docker é•œåƒ</h2><p>é¦–å…ˆéœ€è¦å®‰è£… dockerï¼Œåœ¨ mac ä¸Šå®‰è£… docker åªéœ€å»å®˜ç½‘ä¸‹è½½å®¢æˆ·ç«¯ï¼š</p><p><a href="https://docs.docker.com/desktop/install/mac-install/">https://docs.docker.com/desktop/install/mac-install/</a></p><p><img src="/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/macå®‰è£…docker.png" alt></p><p>æ³¨æ„ï¼Œåœ¨ mac ä¸Šå®‰è£… docker éœ€è¦æå‰å®‰è£… rosettaã€‚</p><p>å®‰è£… docker å®Œæˆåï¼Œä¸ºäº†æ–¹ä¾¿ä¸‹è½½é•œåƒï¼Œæˆ‘ä»¬å…ˆä¿®æ”¹ä¸‹æºã€‚</p><p><img src="/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/macä¿®æ”¹æº.png" alt></p><p>åœ¨å¦‚å›¾æ‰€ç¤ºçš„æ–‡æœ¬æ¡†å†…æŒ‰ç…§ json æ ¼å¼æ·»åŠ å¦‚ä¸‹æ–‡æœ¬ï¼š</p><pre><code class="lang-json">&quot;registry-mirrors&quot;: [    &quot;https://hub-mirror.c.163.com&quot;,    &quot;https://mirror.baidubce.com&quot;  ]</code></pre><p>ä¹‹åä½¿ç”¨ç°æœ‰çš„é•œåƒæ–‡ä»¶å³å¯éƒ¨ç½²ï¼š</p><pre><code class="lang-sh">docker pull nil01/vceddocker run -itd -p 8501:8501 -p 45679:45679 --name vced_arm nil01/vced</code></pre><p>æœ€å¤§çš„æ–‡ä»¶æœ‰ 2GBï¼Œéœ€è¦ç­‰å¾…ä¸€ä¼šå„¿ä¸‹è½½ã€‚éƒ¨ç½²å®Œæˆåï¼Œè®¿é—® <code>localhost:8501</code> å³å¯ã€‚</p><p><img src="/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/æµè§ˆå™¨äº¤äº’é¡µé¢.png" alt></p><p>å¯åŠ¨ docker è¿›ç¨‹ä¹‹åï¼Œè¾“å…¥æŒ‡ä»¤ <code>docker ps</code> æŸ¥çœ‹è¿è¡Œä¸­çš„ containerï¼Œè¾“å…¥ <code>docker ps &lt;CONTAINER ID&gt;</code> å³å¯ç»“æŸè¯¥ containerã€‚</p><p><img src="/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/dockeræ“ä½œ.png" alt></p><h2 id="è‡ªè¡Œç¼–è¯‘"><a href="#è‡ªè¡Œç¼–è¯‘" class="headerlink" title="è‡ªè¡Œç¼–è¯‘"></a>è‡ªè¡Œç¼–è¯‘</h2><p>å…ˆå®‰è£… rust</p><pre><code class="lang-sh">curl --proto &#39;=https&#39; --tlsv1.2 -sSf https://sh.rustup.rs | sh</code></pre><p>åœ¨å®‰è£…æ—¶ï¼Œé»˜è®¤çš„ rust ç‰ˆæœ¬é€‚é…â€œaarch64-apple-darwinâ€æ¶æ„çš„ macã€‚å› æ­¤æ”¾å¿ƒå®‰è£…å³å¯ã€‚</p><p>å®‰è£…å®Œæ¯•åï¼Œéœ€è¦é‡å¯ shellï¼Œæµ‹è¯• rustc å‘½ä»¤çœ‹çœ‹èƒ½ä¸èƒ½æ­£å¸¸æ‰§è¡Œå³å¯ã€‚</p><p>å†å®‰è£… CLIPï¼š</p><pre><code class="lang-sh">pip install git+https://github.com/openai/CLIP.git</code></pre><p>ç„¶å clone æˆ‘ä»¬æ‰€å­¦çš„ä»£ç ï¼š</p><pre><code class="lang-sh">git clone &quot;https://github.com/datawhalechina/vced.git&quot;</code></pre><p>è¿›å…¥ <code>vced/code/service</code> ï¼Œç„¶åæ‰§è¡Œ</p><pre><code class="lang-sh">pip install -r requirements.txt</code></pre><p>å®‰è£…ä¾èµ–åŒ…ã€‚è¿™ä¸ªè¿‡ç¨‹éœ€è¦ä¸‹è½½è¾ƒé•¿æ—¶é—´ã€‚ä¸‹è½½å®‰è£…å®Œæ¯•åï¼Œæ‰§è¡Œ</p><pre><code class="lang-sh">python app.py</code></pre><p>å³å¯è¿è¡Œåç«¯æœåŠ¡å™¨ã€‚</p><p><img src="/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/demo.png" alt></p><p>ç„¶åæˆ‘ä»¬è¿˜éœ€è¦è¿è¡Œå‰ç«¯ï¼Œä¿ç•™åŸæ¥çš„ shell ä¸è¦å…³é—­ï¼Œå¦å¼€ä¸€ä¸ª shellï¼Œè¿›å…¥ç›®å½• <code>vced/code/web</code> ï¼Œå¯åŠ¨å‰ç«¯ï¼š</p><pre><code class="lang-sh">streamlit run app.py</code></pre><p><img src="/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/demo_frontend_success.png" alt></p><p>å‰ç«¯é»˜è®¤åœ¨<code>http://localhost:8501/</code>å¼€æ”¾ã€‚</p><h2 id="æµ‹è¯•åŠŸèƒ½"><a href="#æµ‹è¯•åŠŸèƒ½" class="headerlink" title="æµ‹è¯•åŠŸèƒ½"></a>æµ‹è¯•åŠŸèƒ½</h2><p>éšä¾¿é€‰ä¸€ä¸ªæœ¬åœ°çš„è§†é¢‘ï¼Œç„¶åè¾“å…¥ä¸€æ®µæ–‡æœ¬å°è¯•æè¿°ä½ æƒ³è¦èŠ‚é€‰çš„è§†é¢‘ç‰‡æ®µï¼Œç‚¹å‡» search å³å¯ç­‰å¾…ç»“æœã€‚</p><p>ç»“æœé»˜è®¤æ˜¯ä¸€ä¸ª 10s çš„ç‰‡æ®µï¼Œå¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ™é»˜è®¤è¿”å›å¼€å¤´çš„ 10sã€‚</p><p><img src="/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/demo_example.png" alt></p><p>æˆ‘ä¸Šä¼ äº†ä¸€æ®µå¦®éœ²è·³èˆçš„è§†é¢‘ï¼Œè¯•å›¾æ£€ç´¢â€œgirlâ€ï¼Œè¾“å‡ºç‰‡æ®µæœçœŸæ˜¯å¦®éœ²è·³èˆçš„è§†é¢‘ç‰‡æ®µã€‚</p><p><img src="/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/demo_example2.png" alt></p><p>æ­¤æ—¶æ›´æ¢æ£€ç´¢è¯â€œboyâ€ï¼ŒçœŸçš„æŠŠç©ºçš„é•œå¤´æ£€ç´¢å‡ºæ¥äº†ã€‚</p><p>æœ€åæˆ‘å°è¯•æ£€ç´¢â€œa boy with sadnessâ€è¿™ç§è¯­æ³•ä¸é€šçš„æ£€ç´¢è¯ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2022/11/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%80%9A%E8%BF%87%E6%96%87%E5%AD%97%E6%A3%80%E7%B4%A2%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%EF%BC%9AVCED/final_example.png" alt></p><p>æŒ‰ç…§æˆ‘çš„æ ‡å‡†ï¼Œå·²ç»å®Œå…¨æ»¡è¶³éœ€æ±‚ï¼ŒçœŸæ˜¯ç¥å™¨ï¼</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬ç¯‡åšå®¢è®°å½•äº†ç¬”è€…åœ¨æœ¬æœºï¼ˆMacOSï¼‰éƒ¨ç½² VCED å¤šæ¨¡æ€æ•°æ®æ£€ç´¢å·¥å…·çš„å‰ç«¯å’Œåç«¯çš„è¿‡ç¨‹ï¼Œå¹¶å°è¯•ä½¿ç”¨è¯¥å·¥å…·æ£€ç´¢äº†ä¸€ä¸ªåŠ¨ç”»çŸ­ç‰‡ï¼Œå–å¾—äº†ä»¤æˆ‘æƒŠå¥‡çš„æ•ˆæœã€‚åç»­ä¼šé’ˆå¯¹è¯¥å·¥å…·è¿›è¡Œæ·±å…¥ç ”ç©¶ï¼Œæ¢ç´¢è·¨æ¨¡æ€æ£€ç´¢ä½¿ç”¨çš„æŠ€æœ¯å’ŒåŸç†åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œä»¥åŠæŒæ¡å‰ç«¯å’Œåç«¯æ‰€ä½¿ç”¨çš„æŠ€æœ¯ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://github.com/datawhalechina/vced/blob/main/README.md">https://github.com/datawhalechina/vced/blob/main/README.md</a></p><p><a href="https://docs.jina.ai/get-started/install/windows/">https://docs.jina.ai/get-started/install/windows/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬ç¯‡åšå®¢è®°å½•äº†ç¬”è€…åœ¨æœ¬æœºï¼ˆMacOSï¼‰éƒ¨ç½² VCED å¤šæ¨¡æ€æ•°æ®æ£€ç´¢å·¥å…·çš„å‰ç«¯å’Œåç«¯çš„è¿‡ç¨‹ï¼Œå¹¶å°è¯•ä½¿ç”¨è¯¥å·¥å…·æ£€ç´¢äº†ä¸€ä¸ªåŠ¨ç”»çŸ­ç‰‡ï¼Œå–å¾—äº†ä»¤æˆ‘æƒŠå¥‡çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;!--more---&gt;
&lt;p&gt;VCED: Video Clip Extraction by descriptio</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="VCED" scheme="https://superlova.github.io/tags/VCED/"/>
    
    <category term="multimodal" scheme="https://superlova.github.io/tags/multimodal/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æå®æ¯…ML-Note7-Transformer</title>
    <link href="https://superlova.github.io/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/"/>
    <id>https://superlova.github.io/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/</id>
    <published>2022-10-29T12:05:45.000Z</published>
    <updated>2022-10-29T19:59:51.366Z</updated>
    
    <content type="html"><![CDATA[<p>æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šTransformerã€‚<br><!--more---></p><h2 id="ä¸€ã€Seq2Seq"><a href="#ä¸€ã€Seq2Seq" class="headerlink" title="ä¸€ã€Seq2Seq"></a>ä¸€ã€Seq2Seq</h2><p>Transformeræ˜¯ä¸€ç±»Seq2seqç»“æ„çš„æ¨¡å‹ï¼Œè¾“å…¥é•¿åº¦ä¸ºNçš„åºåˆ—ï¼Œè¾“å‡ºé•¿åº¦ä¸ºMçš„åºåˆ—ã€‚å…¶ä¸­Mçš„é•¿åº¦æ˜¯ç”±æ¨¡å‹å†³å®šçš„ã€‚è¯¸å¦‚æ–‡æœ¬ç”Ÿæˆã€è¯­éŸ³åˆæˆã€æœºå™¨ç¿»è¯‘ç­‰ä»»åŠ¡éƒ½éœ€è¦åº”ç”¨seq2seqæ¨¡å‹ã€‚</p><p>å¾ˆå¤šä»»åŠ¡å¯ä»¥è¢«è½¬åŒ–ä¸ºseq2seqä»»åŠ¡ï¼Œä½†ä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£ã€‚</p><p>seq2seqæ¨¡å‹ç”±ä¸€ä¸ªç¼–ç å™¨ï¼ˆEncodeerï¼‰å’Œä¸€ä¸ªè§£ç å™¨ï¼ˆDecoderï¼‰ç»„æˆï¼ŒåŸºç¡€æ¶æ„å¦‚ä¸‹ï¼š</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-1.png" alt></p><p>seq2seqæ¨¡å‹æ˜¯ä¸€ç§æ¶æ„ï¼Œåªè§„å®šäº†è¾“å…¥è¾“å‡ºï¼Œå¹¶æ²¡æœ‰è§„å®šå¿…é¡»ä½¿ç”¨å“ªç§å…·ä½“çš„æ¨¡å‹ã€‚</p><h2 id="äºŒã€Encoder"><a href="#äºŒã€Encoder" class="headerlink" title="äºŒã€Encoder"></a>äºŒã€Encoder</h2><p>å¦‚å›¾æ‰€ç¤ºæ˜¯Transformerçš„Encoderï¼š</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-2.png" alt></p><p>Transformer çš„ Encoder æ˜¯ç”±è‹¥å¹²çš„ Block æ„æˆçš„ï¼Œæ¯ä¸ª Block åŒ…å«ä¸€ä¸ª multihead self-attention ç»“æ„å’Œä¸€ä¸ªå…¨è¿æ¥ç½‘ç»œç­‰ï¼Œè¿™äº› Block ä¸²è”èµ·æ¥ç»„æˆ Encoderã€‚</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-3.png" alt></p><p>éœ€è¦å…³æ³¨ä¸¤ä¸ªç»†èŠ‚ï¼š</p><ol><li>self-attention å±‚çš„å‘é‡è¾“å‡ºåï¼Œéœ€è¦ç»è¿‡ä¸€æ­¥æ®‹å·®è¿ç®—ï¼Œå’ŒåŸæ¥çš„è¾“å…¥ç›¸åŠ ï¼›</li><li>æ®‹å·®è¿ç®—åçš„å‘é‡éœ€è¦ LayerNormalization æ“ä½œï¼›</li><li>normalized ä¹‹åçš„å‘é‡éœ€è¦è¾“å…¥å†…éƒ¨çš„å…¨è¿æ¥ç½‘ç»œï¼Œè¾“å‡ºçš„å‘é‡åŒæ ·è¦ä¸è¿™ä¸€æ­¥éª¤çš„è¾“å…¥è¿›è¡Œæ®‹å·®ï¼›</li><li>åœ¨è¾“å‡ºå‰åŒæ ·éœ€è¦ç»è¿‡ normalizationã€‚</li></ol><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-4.png" alt></p><p>å®é™…ä¸Šï¼Œåœ¨å…·ä½“å®ç°æ—¶ï¼Œä¸Šé¢çš„æ“ä½œé¡ºåºæ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œæœ‰è‹¥å¹²æ–‡ç« å·²ç»åœ¨è®¨è®º LayerNormalization çš„æ‰§è¡Œæ—¶æœºå¯¹æœ€ç»ˆæ€§èƒ½çš„å½±å“ã€‚</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-layer-norm.png" alt></p><h2 id="ä¸‰ã€Decoder"><a href="#ä¸‰ã€Decoder" class="headerlink" title="ä¸‰ã€Decoder"></a>ä¸‰ã€Decoder</h2><p>Decoderè´Ÿè´£ä»¥Encoderçš„è¾“å‡ºä¸ºçŸ¥è¯†ï¼Œç”Ÿæˆä¸€ç³»åˆ—è¾“å‡ºå‘é‡ã€‚</p><h3 id="3-1-Decoder-çš„æ‰§è¡Œæ­¥éª¤"><a href="#3-1-Decoder-çš„æ‰§è¡Œæ­¥éª¤" class="headerlink" title="3.1 Decoder çš„æ‰§è¡Œæ­¥éª¤"></a>3.1 Decoder çš„æ‰§è¡Œæ­¥éª¤</h3><p>Transformer çš„ Decoder æ˜¯ä¸€ä¸ªè‡ªå›å½’ï¼ˆAutoRegressiveï¼‰æ¨¡å‹ï¼Œå³ä½¿ç”¨è‡ªèº«ä»¥å‰çš„äº§å‡ºæ¥é¢„æµ‹å°†æ¥çš„äº§å‡ºã€‚</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-decoder-example-1.png" alt></p><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä»¥è¯­éŸ³è½¬æ–‡å­—ä»»åŠ¡ä¸ºä¾‹ï¼Œä»¥ä¸€ä¸²éŸ³é¢‘ä¸ºè¾“å…¥ï¼ˆåœ¨å›¾ç¤ºçš„ä¾‹å­ä¸­ï¼Œæ˜¯â€œæœºå™¨å­¦ä¹ â€å››ä¸ªå­—ï¼‰ï¼ŒEncoder é¦–å…ˆå­¦ä¹ é€‚å½“çš„è¯­ä¹‰å‘é‡ï¼Œå¹¶å°†å…¶è¾“å…¥ Decoder ä¸­ï¼ŒDecoder æ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><ol><li>Decoder å…ˆä»¥ [start] ç¬¦å·ä½œä¸ºè¾“å…¥ï¼Œé€šè¿‡ Encoder æä¾›çš„çŸ¥è¯†ï¼Œæ¥é¢„æµ‹è¯¥ç¬¦å·å¯¹åº”çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼›</li><li>Decoder äº§å‡ºçš„é¢„æµ‹å‘é‡æ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºå•è¯è¡¨å¤§å°çš„å‘é‡ï¼Œå‘é‡çš„æ¯ä¸ªåˆ†é‡ä»£è¡¨è¾“å‡ºä¸ºè¯¥è¯æ—¶çš„æ¦‚ç‡å€¼ï¼›</li><li>ç´§æ¥ç€ Decoder ä¼šä»¥è¯¥è¾“å‡ºä¸ºè¾“å…¥ï¼Œæ¥é¢„æµ‹è¾“å‡ºï¼›</li><li>ç”±æ­¤å¾ªç¯å¾€å¤ï¼Œç›´è‡³ Decoder è®¤ä¸ºæ¨¡å‹çš„è¾“å‡ºä¸ºç‰¹æ®Šç¬¦å· [end]ä¸ºæ­¢ã€‚</li></ol><h3 id="3-2-Decoder-çš„å…·ä½“æ¶æ„"><a href="#3-2-Decoder-çš„å…·ä½“æ¶æ„" class="headerlink" title="3.2 Decoder çš„å…·ä½“æ¶æ„"></a>3.2 Decoder çš„å…·ä½“æ¶æ„</h3><p>Transformer çš„ Decoder ä¸ Encoder æ¶æ„ååˆ†ç±»ä¼¼ï¼š</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-decoder-structure.png" alt></p><ol><li>æ¥çº³æ¨¡å‹è¾“å…¥çš„ attention å±‚æ˜¯ masked self-attention å±‚ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼Œåœ¨è€ƒè™‘æŸä¸ªè¾“å…¥å‘é‡$x_n$çš„è¾“å‡ºæ—¶ï¼Œself-attention ä¼šç»¼åˆæ‰€æœ‰çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè€Œ masked self-attention åªä¼šè€ƒè™‘å·²ç»å‡ºç°è¿‡çš„ $x_1~x_n$ èŒƒå›´å†…çš„æ‰€æœ‰å‘é‡ï¼Œè€Œä¸ä¼šè€ƒè™‘å®ƒçš„ä¸‹æ–‡ï¼›<br> è¿™æ ·åšæ˜¯è‡ªç„¶çš„ï¼Œå› ä¸º Decoder æ˜¯ä»¥è¿‡å»çš„è¾“å‡ºé¢„æµ‹å°†æ¥çš„è¾“å‡ºçš„è‡ªå›å½’æ¨¡å‹ï¼Œå®ƒæ— æ³•å‚è€ƒå°šæœªç”Ÿæˆçš„ä¸‹æ–‡å†…å®¹ï¼›</li><li>ç»è¿‡ masked self-attention çš„ç¼–ç åçš„è¾“å‡ºå‘é‡ï¼Œä¼šè¢«å½“åšä¸‹ä¸€å±‚ self-attention çš„ query æŸ¥è¯¢å‘é‡ï¼Œç„¶åä¸ encoder å¾—åˆ°çš„è¾“å‡ºå‘é‡è®¡ç®—ç›¸å…³æ€§ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œquery æ¥è‡ª Decoder çš„è¾“å…¥ï¼Œè€Œ key å’Œ value éƒ½æ¥è‡ª Encoder å±‚ã€‚è¿™ä¸€æ­¥éª¤å«åš Cross Attentionã€‚<br> åœ¨ Decoder ä¸­åŠ å…¥ Cross Attention ï¼Œæ˜¯å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿæ­£ç¡®åœ°åˆ©ç”¨ Encoder æä¾›çš„çŸ¥è¯†ï¼Œå¹¶æ ¹æ®ç°æœ‰çš„è¾“å…¥ï¼Œè‡ªåŠ¨ç”Ÿæˆåˆé€‚çš„è¾“å‡ºè¡¨ç¤ºã€‚è¦å®Œæˆè¿™ä¸€æ­¥ï¼ŒEncoder æä¾›çš„å…ˆéªŒçŸ¥è¯†ä¸ Decoder æä¾›çš„æŸ¥è¯¢è¯éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</li></ol><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-decoder-cross-attention.png" alt></p><p>Transformer çš„ Encoder ä¸ Decoder çš„è¯¦ç»†æ¶æ„å¦‚å›¾ï¼š</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-encoder-decoder.png" alt></p><p>éœ€è¦æ³¨æ„ï¼ŒåŸæ–‡ä¸­ Transformer çš„å¤šä¸ª Decoder ç»“æ„ä½¿ç”¨çš„ Encoder ä¿¡æ¯éƒ½æ¥è‡ªäºæœ€åä¸€ä¸ª Encoderï¼Œè¿™æ ·åšæ˜¯è‡ªç„¶åœ°ï¼Œæ¯•ç«Ÿæˆ‘ä»¬è®¤ä¸ºæœ€åä¸€å±‚å­¦ä¹ åˆ°çš„çŸ¥è¯†æœ€æŠ½è±¡ï¼Œæ³›åŒ–èƒ½åŠ›æœ€å¼ºï¼›</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-encoder-decoder-2.png" alt></p><p>äº‹å®ä¸Šå¹¶ä¸æ€»æ˜¯è¿™æ ·ï¼Œä¹Ÿæœ‰ä¸€äº›æ–‡ç« åœ¨ç ”ç©¶ä»¤ä¸åŒæ—¶æœŸçš„ Encoder äº§å‡ºçš„å‘é‡é€ç»™ä¸åŒæ—¶æœŸçš„ Decoderï¼Œå¹¶å–å¾—äº†ä¸€å®šçš„æ•ˆæœï¼š</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-cross-attention-various.png" alt></p><h3 id="3-3-éè‡ªå›å½’-Decoder"><a href="#3-3-éè‡ªå›å½’-Decoder" class="headerlink" title="3.3 éè‡ªå›å½’ Decoder"></a>3.3 éè‡ªå›å½’ Decoder</h3><p>å­˜åœ¨ä¸€äº› None AutoRegressive Decoderï¼Œè¿™äº› Decoder ä¸æ˜¯ä»¥è‡ªèº«ä¹‹å‰çš„è¾“å‡ºé¢„æµ‹ä¹‹åçš„è¾“å‡ºï¼Œè€Œæ˜¯ä¸€æ¬¡æ€§ç»™å‡ºæ•´ä¸ªè¾“å‡ºåºåˆ—ã€‚</p><p>è‡ªå›å½’é—®é¢˜æ˜¯é€šè¿‡åœ¨è¾“å‡ºé›†åˆä¸­æ·»åŠ ç‰¹æ®Šç¬¦å· [end] æ¥è§£å†³åºåˆ—ä¸åœæ­¢çš„é—®é¢˜çš„ï¼Œä½†æ˜¯ éè‡ªå›å½’ Decoder ä¸€æ¬¡æ€§è¾“å‡ºæ•´ä¸ªåºåˆ—ï¼Œå®ƒåªèƒ½é¢„å…ˆè®¾å®šä¸€ä¸ªåºåˆ—é•¿åº¦å€¼ï¼Œå¹¶ä¾æ­¤é•¿åº¦è¿›è¡Œè¾“å‡ºã€‚è¿™ç§ç±»å‹çš„ Decoder å½“ç„¶ä¹Ÿä¼šè¾“å‡º [end] ï¼Œä½† Decoder å¹¶ä¸ä¼šæ ¹æ®æ­¤æ¥ç»ˆæ­¢åç»­å­—ç¬¦çš„ç”Ÿæˆã€‚æœ€ç»ˆçš„ç»“æœä¼šæˆªæ–­ [end] ä¹‹åçš„å­—ç¬¦ã€‚</p><p>éƒ¨åˆ†éè‡ªå›å½’ Decoder å¯ä»¥é€šè¿‡å¦å¤–è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ï¼Œé€šè¿‡å­¦ä¹ è¾“å…¥åºåˆ—é•¿åº¦ä¸è¾“å‡ºåºåˆ—é•¿åº¦ä¹‹é—´çš„å…³ç³»æ¥åŠ¨æ€äº§ç”Ÿåºåˆ—çš„é•¿åº¦ã€‚</p><p>éè‡ªå›å½’ Decoder çš„ä¼˜ç‚¹åœ¨äºå¯å¹¶è¡ŒåŒ–ï¼Œå¿«é€Ÿï¼›è€Œä¸”è¾“å‡ºåºåˆ—çš„é•¿åº¦æ˜¯äººä¸ºå¯æ§çš„ï¼›</p><p>ç¼ºç‚¹åœ¨äºå‡†ç¡®ç‡ç­‰ç›¸å¯¹ä¸å¦‚è‡ªå›å½’ Decoderã€‚</p><h2 id="å››ã€Transformer-çš„è®­ç»ƒè¿‡ç¨‹"><a href="#å››ã€Transformer-çš„è®­ç»ƒè¿‡ç¨‹" class="headerlink" title="å››ã€Transformer çš„è®­ç»ƒè¿‡ç¨‹"></a>å››ã€Transformer çš„è®­ç»ƒè¿‡ç¨‹</h2><p>å…¶å®å°±æ˜¯è®­ç»ƒä¸€ä¸ªåˆ†ç±»é—®é¢˜ã€‚å‡è®¾é—®é¢˜ä¸ºä¸€æ®µè¯­éŸ³ï¼Œé—®é¢˜çš„ç­”æ¡ˆä¸ºâ€œæˆ‘çˆ±ä¸­å›½â€å››ä¸ªå­—ï¼Œåˆ™ Encoder ä¼šå­¦ä¹ è¯¥è¯­éŸ³çš„å‘é‡è¡¨ç¤ºå¹¶è¾“å‡ºç»™ Decoderï¼ŒDecoder åˆ™ä¼šåˆ†åˆ«è¾“å…¥ <code>BOSã€æˆ‘ã€çˆ±ã€ä¸­ã€å›½</code>ï¼Œä½œä¸ºäº”ä¸ªè®­ç»ƒæ ·æœ¬ï¼›ä»–ä»¬çš„æ­£ç¡®ç­”æ¡ˆä¸º<code>æˆ‘ã€çˆ±ã€ä¸­ã€å›½ã€EOS</code>ï¼Œæ¯ä¸ªå­—å¯¹åº”ä¸€ä¸ª one-hot å‘é‡ã€‚æœ€åé€šè¿‡ä¼˜åŒ–äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼ŒæŒ‰ç…§æ­£å¸¸çš„æ¢¯åº¦ä¸‹é™ç®—æ³•è¿›è¡Œä¼˜åŒ–å³å¯ã€‚</p><p><img src="/2022/10/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note7-Transformer/transformer-training.png" alt></p><p>è¿™ç§ä»¥æ­£ç¡®ç­”æ¡ˆä¸ºè¾“å…¥çš„è®­ç»ƒæ–¹æ³•ç§°ä½œ Teacher Forcingã€‚</p><h2 id="äº”ã€Transformer-è®­ç»ƒæŠ€å·§"><a href="#äº”ã€Transformer-è®­ç»ƒæŠ€å·§" class="headerlink" title="äº”ã€Transformer è®­ç»ƒæŠ€å·§"></a>äº”ã€Transformer è®­ç»ƒæŠ€å·§</h2><h3 id="5-1-Copy-Mechanism"><a href="#5-1-Copy-Mechanism" class="headerlink" title="5.1 Copy Mechanism"></a>5.1 Copy Mechanism</h3><p>å¯¹äºä¸€äº›é—®ç­”ç­‰é—®é¢˜ï¼Œå½“è¾“å…¥ä¸­åŒ…å«ä¸€äº›å®ä½“æ—¶ï¼Œæ¨¡å‹å¯ä»¥ç›´æ¥æŠŠè¯¥å®ä½“å¤åˆ¶åˆ°è¾“å‡ºåºåˆ—ä¸­è¿›è¡ŒåŸæ ·è¾“å‡ºï¼Œç§°ä¹‹ä¸ºâ€œå¤åˆ¶æœºåˆ¶â€ï¼Œè¿™éœ€è¦ä¿è¯è¾“å…¥ä¿¡æ¯åˆ°è¾“å‡ºä¿¡æ¯ä¹‹é—´çš„ç•…é€šã€‚</p><p>å®ç° Copy Mechanism çš„ç½‘ç»œç»“æ„æœ‰æŒ‡é’ˆç½‘ç»œç­‰ã€‚</p><h3 id="5-2-Guided-Attention"><a href="#5-2-Guided-Attention" class="headerlink" title="5.2 Guided Attention"></a>5.2 Guided Attention</h3><p>é€šè¿‡äººä¸ºé™åˆ¶æ³¨æ„åŠ›çš„å­¦ä¹ æ–¹å‘ã€å­¦ä¹ é‡ç‚¹ç­‰ï¼Œæå‡æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›ã€‚æ¯”å¦‚è§„å®šè¯­éŸ³åˆæˆä»»åŠ¡çš„æ³¨æ„åŠ›åªèƒ½ä»å·¦å¾€å³å­¦ä¹ ç­‰ã€‚</p><h3 id="5-3-Beam-Search"><a href="#5-3-Beam-Search" class="headerlink" title="5.3 Beam Search"></a>5.3 Beam Search</h3><p>Beam Search æ˜¯ä¸€ç§å¸®åŠ©æ‰¾åˆ°æœ€ä¼˜è§£çš„æ–¹æ³•ï¼Œå…¶æ€æƒ³ç±»ä¼¼äºåŠ¨æ€è§„åˆ’ï¼Œæ˜¯ä¸ºäº†è§£å†³ Decoder åœ¨è´ªå¿ƒåœ°é€‰æ‹©æœ€ä¼˜è¾“å‡ºæ—¶ï¼Œé”™è¿‡äº†æ¬¡ä¼˜è¾“å‡ºï¼Œå¯¼è‡´åç»­è¾“å‡ºå…¨é”™çš„é—®é¢˜ã€‚</p><p>Beam Search å¹¶ä¸æ€»ä¸€å®šèƒ½æ‰¾åˆ°æœ€ä¼˜è§£ï¼Œè€Œä¸”ä¸€å‘³è¿½å¯»æœ€ä¼˜è§£ï¼Œåœ¨ä¸€äº›éœ€è¦å‘æŒ¥åˆ›æ„çš„ä»»åŠ¡ä¸­ï¼Œåè€Œä¸å¥½ï¼Œæ¯”å¦‚æ–°é—»ç”Ÿæˆä»»åŠ¡ç­‰ã€‚</p><h3 id="5-4-ä¼˜åŒ–è¯„ä¼°æŒ‡æ ‡"><a href="#5-4-ä¼˜åŒ–è¯„ä¼°æŒ‡æ ‡" class="headerlink" title="5.4 ä¼˜åŒ–è¯„ä¼°æŒ‡æ ‡"></a>5.4 ä¼˜åŒ–è¯„ä¼°æŒ‡æ ‡</h3><p>ä¸€èˆ¬è€Œè¨€ Decoder çš„æŸå¤±å‡½æ•°éƒ½æ˜¯äº¤å‰ç†µï¼Œè¿™æ˜¯å› ä¸ºäº¤å‰ç†µæ–¹ä¾¿æ±‚å¯¼å¥½è®­ç»ƒï¼›è€Œè¯„ä¼°æ¨¡å‹æ—¶ä½¿ç”¨çš„å¾€å¾€æ˜¯ BLEUã€‚ä½†å¦‚æœæˆ‘ä»¬ä½¿ç”¨ BLEU è¿™ç§ç›¸å¯¹ç§‘å­¦ä¸€ç‚¹çš„è¯„ä¼°å‡½æ•°æ¥åšæŸå¤±å‡½æ•°çš„è¯ï¼Œå¯èƒ½éœ€è¦å€ŸåŠ©å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learning, RLï¼‰çš„æ€æƒ³ï¼Œå¼ºè¡ŒæŠŠ BLEU ç§»æ¤åˆ°æ¨¡å‹ä¸­ã€‚</p><h3 id="5-5-scheduled-sampling"><a href="#5-5-scheduled-sampling" class="headerlink" title="5.5 scheduled sampling"></a>5.5 scheduled sampling</h3><p>Decoder åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®­ç»ƒæ ·æœ¬æ°¸è¿œéƒ½æ˜¯æ­£ç¡®ç­”æ¡ˆï¼Œç¼ºä¹ä¸€äº›è´Ÿæ ·æœ¬ï¼Œå‘Šè¯‰ Decoder ä½ ä¸åº”è¯¥å°†é¢„æµ‹å€¼é¢„æµ‹ä¸ºè¯¥å€¼ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è®­ç»ƒæ—¶éšæœºåœ¨è¾“å…¥åºåˆ—ä¸­æ·»åŠ å™ªéŸ³ï¼Œä½†è¿™ä¸€ä¸¾æªå¯èƒ½ä¼šæŸå¤±è®­ç»ƒçš„å¹¶è¡ŒåŒ–èƒ½åŠ›ã€‚</p><h2 id="å…­ã€æ€»ç»“å’Œé—®ç­”"><a href="#å…­ã€æ€»ç»“å’Œé—®ç­”" class="headerlink" title="å…­ã€æ€»ç»“å’Œé—®ç­”"></a>å…­ã€æ€»ç»“å’Œé—®ç­”</h2><h3 id="ä¸ºä»€ä¹ˆè¦åŠ å…¥æ®‹å·®æ¨¡å—ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦åŠ å…¥æ®‹å·®æ¨¡å—ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åŠ å…¥æ®‹å·®æ¨¡å—ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦åŠ å…¥æ®‹å·®æ¨¡å—ï¼Ÿ</h3><h3 id="ä¸ºä»€ä¹ˆè¦åŠ å…¥-LayerNormalization-æ¨¡å—ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦åŠ å…¥-LayerNormalization-æ¨¡å—ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åŠ å…¥ LayerNormalization æ¨¡å—ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦åŠ å…¥ LayerNormalization æ¨¡å—ï¼Ÿ</h3><h3 id="BatchNormalization-å’Œ-LayerNormalization-çš„åŒºåˆ«ï¼Ÿ"><a href="#BatchNormalization-å’Œ-LayerNormalization-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="BatchNormalization å’Œ LayerNormalization çš„åŒºåˆ«ï¼Ÿ"></a>BatchNormalization å’Œ LayerNormalization çš„åŒºåˆ«ï¼Ÿ</h3><h3 id="Transformer-ä½¿ç”¨åˆ°çš„å‡ ç§-Mask"><a href="#Transformer-ä½¿ç”¨åˆ°çš„å‡ ç§-Mask" class="headerlink" title="Transformer ä½¿ç”¨åˆ°çš„å‡ ç§ Mask"></a>Transformer ä½¿ç”¨åˆ°çš„å‡ ç§ Mask</h3><h3 id="å‰é¦ˆç¥ç»ç½‘ç»œåœ¨-Transformer-ä¸­çš„ä½œç”¨"><a href="#å‰é¦ˆç¥ç»ç½‘ç»œåœ¨-Transformer-ä¸­çš„ä½œç”¨" class="headerlink" title="å‰é¦ˆç¥ç»ç½‘ç»œåœ¨ Transformer ä¸­çš„ä½œç”¨"></a>å‰é¦ˆç¥ç»ç½‘ç»œåœ¨ Transformer ä¸­çš„ä½œç”¨</h3><h3 id="Gelu-çš„ä½œç”¨"><a href="#Gelu-çš„ä½œç”¨" class="headerlink" title="Gelu çš„ä½œç”¨"></a>Gelu çš„ä½œç”¨</h3><h2 id="ä¸ƒã€transformer-çš„ä»£ç å®ç°"><a href="#ä¸ƒã€transformer-çš„ä»£ç å®ç°" class="headerlink" title="ä¸ƒã€transformer çš„ä»£ç å®ç°"></a>ä¸ƒã€transformer çš„ä»£ç å®ç°</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šTransformerã€‚&lt;br&gt;&lt;!--more---&gt;&lt;/p&gt;
&lt;h2 id=&quot;ä¸€ã€Seq2Seq&quot;&gt;&lt;a href=&quot;#ä¸€ã€Seq2Seq&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€Seq2</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="MOOC" scheme="https://superlova.github.io/tags/MOOC/"/>
    
    <category term="Self-Attention" scheme="https://superlova.github.io/tags/Self-Attention/"/>
    
    <category term="Transformer" scheme="https://superlova.github.io/tags/Transformer/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æå®æ¯…ML-Note6-æ³¨æ„åŠ›æœºåˆ¶</title>
    <link href="https://superlova.github.io/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/"/>
    <id>https://superlova.github.io/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/</id>
    <published>2022-10-23T13:57:40.000Z</published>
    <updated>2022-10-29T19:40:57.261Z</updated>
    
    <content type="html"><![CDATA[<p>æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šè‡ªæ³¨æ„åŠ›æœºåˆ¶ã€‚<br><!--more---></p><h2 id="ä¸€ã€è¾“å…¥ä»å›¾åƒåˆ°åºåˆ—"><a href="#ä¸€ã€è¾“å…¥ä»å›¾åƒåˆ°åºåˆ—" class="headerlink" title="ä¸€ã€è¾“å…¥ä»å›¾åƒåˆ°åºåˆ—"></a>ä¸€ã€è¾“å…¥ä»å›¾åƒåˆ°åºåˆ—</h2><p>å›¾åƒåˆ†ç±»ä»»åŠ¡çš„è¾“å…¥æ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚éƒ½æ˜¯28*28åƒç´ çš„é»‘ç™½å›¾ç‰‡ç­‰ç­‰ã€‚ä½†æ˜¯ä¸€äº›è¾“å…¥å’Œè¾“å‡ºä¸æ˜¯å®šé•¿åºåˆ—çš„ä»»åŠ¡ï¼Œæ¯”å¦‚æœºå™¨ç¿»è¯‘ã€è¯­éŸ³è½¬æ–‡å­—ç­‰ä»»åŠ¡ï¼Œä¼ ç»Ÿæ¨¡å‹åœ¨è¿™äº›ä»»åŠ¡ä¸Šçš„è¡¨ç°ä¸å¥½ã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/ä¸åŒè¾“å‡ºå¯¹åº”ä¸åŒä»»åŠ¡.png" alt></p><p>æ¯”å¦‚è¯æ€§æ ‡æ³¨ä»»åŠ¡ï¼Œæ¨¡å‹çš„è¾“å…¥æ˜¯Nä¸ªå‘é‡ï¼Œè¾“å‡ºæ˜¯Nä¸ªåˆ†ç±»æ ‡ç­¾ï¼›æ¯”å¦‚æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ï¼Œæ¨¡å‹çš„è¾“å…¥æ˜¯Nä¸ªå‘é‡ï¼Œè¾“å‡ºåªæ˜¯ä¸€ä¸ªåˆ†ç±»æ ‡ç­¾ï¼›æ¯”å¦‚æ–‡æœ¬ç¿»è¯‘ä»»åŠ¡ï¼Œæ¨¡å‹çš„è¾“å…¥æ˜¯Nä¸ªå‘é‡ï¼Œè¾“å‡ºå¯èƒ½æ˜¯Nâ€™ä¸ªå‘é‡ï¼Œæ­¤æ—¶Nâ€™æ˜¯æœªçŸ¥çš„ï¼Œéœ€è¦æœºå™¨è‡ªå·±è¿›è¡Œåˆ¤æ–­å’Œå­¦ä¹ ï¼›è¿™ç§ä»»åŠ¡å«åš sequences to sequences (seq2seq) ã€‚</p><p>è¿™äº›ä»»åŠ¡çš„è¾“å…¥ç‰¹ç‚¹æ˜¯ï¼Œéƒ½æœ‰å¤šä¸ªå‘é‡ä½œä¸ºä¸€ä¸ªè¾“å…¥ï¼Œä¸”å‘é‡çš„ç›¸å¯¹ä½ç½®ä¼šå½±å“è¾“å…¥çš„å«ä¹‰ã€‚</p><p>ä»¥è¯æ€§æ ‡æ³¨ä»»åŠ¡ä¸¾ä¾‹ï¼Œè¯¥ä»»åŠ¡çš„è¾“å…¥å’Œè¾“å‡ºå‘é‡ä¸ªæ•°éƒ½ä¸ºNã€‚æˆ‘ä»¬é¦–å…ˆæŠŠä¸€å¥è¯åˆ‡åˆ†ä¸ºNä¸ªè¯ï¼Œç„¶ååˆ©ç”¨ä¸€äº›ç¼–ç æ–¹å¼ï¼ˆæ¯”å¦‚ one-hot æˆ–è€… word2vecï¼‰å°†å…¶å˜æˆNä¸ªå®šé•¿å‘é‡ã€‚æˆ‘ä»¬å°†è¿™Nä¸ªå‘é‡ä½œä¸ºä¸€ä¸ªè¾“å…¥åºåˆ—ï¼Œè¾“å…¥åˆ°æ¨¡å‹ä¸­ï¼Œå¯„å¸Œæœ›äºæ¨¡å‹èƒ½å¤ŸæŠŠæ¯ä¸ªè¯çš„è¯æ€§æ ‡æ³¨å‡ºæ¥ã€‚æ‰€ä»¥è¿™å…¶å®æ˜¯ä¸€ä¸ªåˆ†ç±»ä»»åŠ¡ã€‚</p><p>ä½†æ˜¯å½“æˆ‘ä»¬è¾“å…¥å¥å­â€I saw a saw.â€œæ—¶ï¼Œå‰åä¸¤ä¸ªsawçš„è¯æ€§æ˜¯ä¸åŒçš„ï¼Œå¦‚æœæ¨¡å‹åªä»¥è¯æ±‡å‘é‡ä¸ºè¾“å…¥ï¼Œä¸è€ƒè™‘ä¸Šä¸‹æ–‡çš„è¯ï¼Œæ˜¯æ— æ³•å¾—çŸ¥è¿™ä»¶äº‹çš„ã€‚</p><p>ä¸ºæ­¤ï¼Œå‰äººä»¬åšäº†ä»¥ä¸‹æ”¹è¿›ï¼Œè¯•å›¾ä½¿ç”¨ä¼ ç»Ÿæ¨¡å‹è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><ol><li><p>é€šè¿‡ N-gram æ¨¡å‹ï¼Œå°†ä¸¤ä¸‰ä¸ªè¯æ‰“åŒ…æˆä¸€ä¸ªæ–°è¯ï¼Œâ€I saw a sawâ€œç»è¿‡3-gramæ¨¡å‹çš„ç¼–ç ï¼Œä¼šäº§ç”Ÿå¦‚ä¸‹è¾“å…¥åºåˆ—ï¼š</p><pre><code> I saw a saw -&gt; [i saw a], [saw a saw]</code></pre><p> ç”±æ­¤ï¼Œæ¨¡å‹èƒ½å¤Ÿçœ‹åˆ°çš„ä¸Šä¸‹æ–‡å°±æ‰©å±•åˆ°äº†ä¸‰ä¸ªå•è¯ã€‚ä½†æ˜¯è¯¥ç§æ–¹æ³•ä¼šå¿«é€Ÿæ‰©å¤§å•è¯é‡ï¼Œå¢åŠ è®¡ç®—è´Ÿæ‹…ï¼Œä¸”æ— æ³•æŠŠè·ç¦»è¾ƒè¿œçš„ä¸Šä¸‹æ–‡ä¹ŸåŠ å…¥è¿›æ¥ã€‚</p></li><li><p>ä½¿ç”¨TextCNN</p><p> TextCNN æ˜¯æŠŠå›¾åƒé¢†åŸŸå¤§è´§æˆåŠŸçš„CNNæ¨¡å‹çš„ç»éªŒç§»æ¤åˆ°äº†NLPé¢†åŸŸçš„æˆæœï¼Œå®ƒä½¿ç”¨ä¸€ç»´å·ç§¯æ ¸ã€‚ä½†ç©¶å…¶æœ¬è´¨è¿˜æ˜¯å—é™äºå·ç§¯æ ¸çš„å¤§å°ã€‚</p></li></ol><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/å‘é‡ä¹‹é—´çš„ç›¸å¯¹ä½ç½®.png" alt></p><p>æœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•èƒ½å¤Ÿè€ƒè™‘è¾“å…¥å‘é‡çš„å…¨éƒ¨ä¸Šä¸‹æ–‡å‘¢ï¼Ÿ self-attention å¯ä»¥åšåˆ°ã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attentionä¸FCçš„åŒºåˆ«.png" alt></p><p>self-attention æ¥å—Nä¸ªè¾“å…¥å‘é‡ï¼Œè¾“å‡ºNä¸ªè¾“å‡ºå‘é‡ã€‚è¾“å‡ºçš„å‘é‡ä¸ä»…ä¿ç•™äº†åŸæ¥å‘é‡çš„è¯­ä¹‰ä¿¡æ¯ï¼Œè¿˜é¢å¤–æ·»åŠ äº†è¯¥å‘é‡ä¸Šä¸‹æ–‡çš„ä¿¡æ¯ã€‚</p><p>æœ‰äº†è¿™ä¸ªå…¨æ–°çš„å‘é‡ï¼Œæˆ‘ä»¬ä¾¿ä¸å¿…ä½¿ç”¨è¯¸å¦‚ n-gram ç­‰ç‰¹å¾å·¥ç¨‹æ‰‹æ®µäº†ï¼Œself-attention å°±èƒ½å¤Ÿäº§ç”Ÿéå¸¸å¥½çš„ç¨ å¯†å‘é‡ï¼Œè¯¥å‘é‡è€ƒè™‘çš„ä¸Šä¸‹æ–‡èŒƒå›´æ˜¯æ•´ç¯‡æ–‡æ¡£ã€‚</p><p>self-attention é€‚åˆç¼–ç æ•´ç¯‡æ–‡æ¡£çš„ä¿¡æ¯ï¼Œäº§å‡ºå‘é‡åå¯ä»¥æ¥ä¸€ä¸ªå…¨è¿æ¥ç½‘ç»œæ¥è¿›è¡Œå…·ä½“çš„åˆ†ç±»ï¼›ä¹Ÿå¯ä»¥åƒä¹‹å‰çš„å·ç§¯ç½‘ç»œä¸€æ ·ï¼Œå¤šå±‚ self-attention + FCå…¨è¿æ¥è¿›è¡Œå †å ã€‚è¿™å®é™…ä¸Šå°±æ˜¯Transformerçš„åŸºæœ¬æ€æƒ³ã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/transformerçš„ç®€åŒ–ç»“æ„.png" alt></p><p>self-attention æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿ</p><h2 id="äºŒã€self-attention-çš„å®ç°åŸç†"><a href="#äºŒã€self-attention-çš„å®ç°åŸç†" class="headerlink" title="äºŒã€self-attention çš„å®ç°åŸç†"></a>äºŒã€self-attention çš„å®ç°åŸç†</h2><p>self-attention çš„è¾“å…¥æ˜¯Nä¸ªå‘é‡ç»„æˆçš„è¾“å…¥åºåˆ—ï¼Œè¾“å‡ºä¹Ÿæ˜¯Nä¸ªå‘é‡ç»„æˆçš„åºåˆ—ã€‚åŒºåˆ«åœ¨äºï¼Œè¾“å…¥çš„å‘é‡æœ¬èº«ä¸åŒ…å«ä»»ä½•ä¸ä¸Šä¸‹æ–‡æœ‰å…³çš„ä¿¡æ¯ï¼Œä½†æ˜¯ä¸è¾“å…¥å‘é‡å¯¹åº”çš„è¾“å‡ºå‘é‡ä¼šåŒ…å«ä¸€å®šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attentionçš„æŠ½è±¡ç»“æ„.png" alt></p><p>å¦‚æœè¦äº§ç”Ÿb1å‘é‡ï¼Œå…¶å®æ˜¯è€ƒè™‘äº†a1/a2/a3/a4å…¨éƒ¨å››ä¸ªå‘é‡åçš„ç»“æœã€‚</p><p>å…·ä½“åœ°ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦è€ƒè™‘a1å‘é‡ä¸å…¶ä»–å‘é‡a2/a3/a4ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œä¸¤ä¸ªå‘é‡ä¹‹é—´çš„ç›¸å…³æ€§æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œæˆ‘ä»¬ç”¨$\alpha$æ¥è¡¨ç¤ºï¼š</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attentionåŸç†1_ç›¸å…³æ€§.png" alt></p><p>ç›¸å…³æ€§æ˜¯å¦‚ä½•è®¡ç®—å¾—åˆ°çš„ï¼Ÿæœ‰å¾ˆå¤šåšæ³•å¯ä»¥å®ç°ç›¸å…³æ€§çš„è®¡ç®—ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œçš„<strong>ç›¸å…³æ€§</strong>å¹¶éçŸ©é˜µå‘é‡ç©ºé—´ä¸­çš„ç›¸ä¼¼æ€§ï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>éœ€è¦æœºå™¨ä»æ•°æ®ä¸­å­¦ä¹ </strong>çš„å‚æ•°ã€‚ä¸‹å›¾æ˜¯ä¸¤ç§ä¸åŒçš„ç›¸å…³æ€§çš„è®¡ç®—æ–¹å¼ã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attentionåŸç†2_ç›¸å…³æ€§çš„è®¡ç®—æ–¹æ³•.png" alt></p><p>ä¸Šå›¾å·¦è¾¹æ˜¯ä¸€ç§å¸¸ç”¨çš„å‘é‡ç›¸å…³æ€§è®¡ç®—æ³•ï¼Œé¦–å…ˆæŠŠä¸¤ä¸ªå‘é‡å„è‡ªä¹˜ä»¥ä¸€ä¸ªå‚æ•°çŸ©é˜µï¼Œå…¶ä¸­è¾“å…¥å‘é‡ä¼šå¾—åˆ°å¯¹åº”çš„æŸ¥è¯¢å‘é‡ queryï¼Œä¸Šä¸‹æ–‡å‘é‡ä¼šå¾—åˆ°å¯¹åº”çš„å…³é”®å‘é‡ keyï¼Œç„¶åæˆ‘ä»¬æŠŠqueryå’Œkeyè¿›è¡Œç‚¹ç§¯ï¼Œå¾—åˆ°çš„å°±æ˜¯ä¸¤ä¸ªå‘é‡çš„ç›¸å…³æ€§ã€‚å‚æ•°çŸ©é˜µæ˜¯å¯ä»¥é€šè¿‡æ•°æ®è¿›è¡Œå­¦ä¹ çš„ã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attentionåŸç†3_ç›¸å…³æ€§è®¡ç®—æ–¹æ³•2.png" alt></p><p>ç”±æ­¤æˆ‘ä»¬æ¨å¹¿å¼€æ¥ï¼Œæ¯ä¸ªè¾“å…¥å‘é‡éƒ½å¯ä»¥è®¡ç®—å±äºè‡ªå·±çš„æŸ¥è¯¢å‘é‡queryï¼Œä»¥åŠå…¶ä»–è¾“å…¥å‘é‡çš„å…³é”®å‘é‡keyã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attentionåŸç†4_ç›¸å…³æ€§è®¡ç®—æ–¹æ³•3.png" alt></p><p>è¾“å…¥å‘é‡è¿˜éœ€è¦ä¸è‡ªå·±è®¡ç®—ç›¸å…³æ€§ï¼Œè¿™æ ·å‡‘é½4ä¸ªç›¸å…³æ€§æ•°å€¼ã€‚ç”±æ­¤æˆ‘ä»¬å°±å¾—åˆ°äº†è¾“å…¥å‘é‡a1ä¸å…¶ä»–ï¼ˆåŒ…å«è‡ªå·±çš„ï¼‰å››ä¸ªå‘é‡ä¹‹é—´çš„ç›¸å…³ç¨‹åº¦ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åšçš„ï¼Œå°±æ˜¯æŠŠå››ä¸ªè¾“å…¥å‘é‡éƒ½ä¸è¯¥ç›¸å…³æ€§è¿›è¡Œä¹˜ç§¯ï¼Œç„¶åç›¸åŠ ï¼Œå°±å¾—åˆ°äº†åŒ…å«ä¸Šä¸‹æ–‡ç›¸å…³ä¿¡æ¯çš„è¾“å‡ºå‘é‡b1ã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attentionåŸç†5_ç›¸å…³æ€§è®¡ç®—æ–¹æ³•4.png" alt></p><p>å†åˆ†åˆ«å¯¹a2/a3/a4å‘é‡å¦‚æ³•ç‚®åˆ¶ï¼Œå°±å¯ä»¥åˆ†åˆ«å¾—åˆ°å››ä¸ªè¾“å‡ºå‘é‡ã€‚</p><p>éœ€è¦æ³¨æ„ï¼Œè¾“å…¥å‘é‡æœ€åå‚ä¸è®¡ç®—æ—¶ï¼Œä¸ºäº†å°†å…¶è½¬åŒ–ä¸ºç¨ å¯†å‘é‡ï¼Œä¹Ÿéœ€è¦ä¹˜ä»¥ä¸€ä¸ªçŸ©é˜µåæ‰èƒ½å‚ä¸è®¡ç®—ã€‚</p><h2 id="ä¸‰ã€self-attention-çš„å¹¶è¡Œè®¡ç®—"><a href="#ä¸‰ã€self-attention-çš„å¹¶è¡Œè®¡ç®—" class="headerlink" title="ä¸‰ã€self-attention çš„å¹¶è¡Œè®¡ç®—"></a>ä¸‰ã€self-attention çš„å¹¶è¡Œè®¡ç®—</h2><p>å‘é‡çš„è½¬åŒ–æ“ä½œéƒ½æ˜¯çŸ©é˜µä¹˜æ³•ï¼Œè¿™æ„å‘³ç€å¯¹å‘é‡è¿›è¡Œè½¬åŒ–çš„æ“ä½œæ˜¯å¯ä»¥å¹¶è¡Œè®¡ç®—çš„ã€‚</p><ol><li>é€šè¿‡å‚æ•°å­¦ä¹ ï¼Œå°†è¾“å…¥å‘é‡ï¼ˆä¸€èˆ¬æ˜¯ç¨€ç–çš„ï¼‰è½¬åŒ–ä¸ºquery/key/valueï¼ˆç¨ å¯†å‘é‡ï¼‰ï¼Œç„¶åå°†å‘é‡æ‹¼åˆå½¢æˆçŸ©é˜µï¼Œå¾—åˆ°çŸ©é˜µQã€Kã€Vï¼š</li></ol><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attentionçš„å¹¶è¡Œè®¡ç®—1.png" alt></p><ol><li>çŸ©é˜µQä¸Kåšç‚¹ä¹˜ï¼Œå¾—åˆ°ç›¸å…³æ€§ç³»æ•°çŸ©é˜µA</li></ol><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attention-parallel-2.png" alt></p><ol><li>ç›¸å…³æ€§çŸ©é˜µAç»è¿‡softmaxè¿›è¡Œæ¦‚ç‡å½’ä¸€åŒ–åï¼Œä¸çŸ©é˜µVè¿›è¡Œç‚¹ä¹˜ï¼Œå¾—åˆ°è¾“å‡ºå‘é‡B</li></ol><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attention-parallel-3.png" alt></p><p><strong>self-attentionå°†è¾“å…¥å‘é‡è½¬åŒ–ä¸ºè¾“å‡ºå‘é‡çš„è¿‡ç¨‹åˆ°æ­¤ç»“æŸã€‚æ•´ä¸ªè¿‡ç¨‹æ€»ç»“å¦‚ä¸‹</strong>ï¼š</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attention-parallel-summary.png" alt></p><h2 id="å››ã€å¤šå¤´æ³¨æ„åŠ›-Multihead-Self-attention"><a href="#å››ã€å¤šå¤´æ³¨æ„åŠ›-Multihead-Self-attention" class="headerlink" title="å››ã€å¤šå¤´æ³¨æ„åŠ› Multihead Self-attention"></a>å››ã€å¤šå¤´æ³¨æ„åŠ› Multihead Self-attention</h2><p>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œå°±æ˜¯åŒæ—¶å­¦ä¹ å¤šç§ç›¸å…³æ€§çš„æœºåˆ¶ã€‚</p><p>è¿™æ ·åšçš„ç†ç”±æ˜¯ï¼šè¯­è¨€æ˜¯å­˜åœ¨åŒä¹‰è¯ã€ä¸€è¯å¤šä¹‰ç­‰ç°è±¡çš„ï¼Œå³ä¾¿æ˜¯åŒä¸€å¥è¯ï¼Œåœ¨ä¸åŒè¯­å¢ƒä¸‹é˜è¿°ä¹Ÿä¼šäº§ç”Ÿä¸åŒçš„æ•ˆæœã€‚å¦‚æœåªç®—ä¸€ç§ç›¸å…³æ€§ï¼Œæ¨¡å‹ä¾¿æ— æ³•æŒæ¡ä¸€è¯å¤šä¹‰ç­‰èƒ½åŠ›ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å­¦ä¹ å¤šä¸ªç›¸å…³æ€§çŸ©é˜µAã€‚</p><p>å¦‚æœæƒ³è¦å­¦ä¹ å¤šä¸ªç›¸å…³æ€§çŸ©é˜µAï¼Œ</p><ol><li>å°±å¿…é¡»æœ‰å¤šä¸ªè¾“å…¥çŸ©é˜µQ/K/Vä¸ä¹‹å¯¹åº”ï¼Œæ¯å¤šä¸€ä¸ªAï¼Œå°±è¦å¤šå­¦ä¹ ä¸€ç±»å‚æ•°çŸ©é˜µï¼›</li><li>ä¼šäº§ç”Ÿå¤šç»„è¾“å‡ºçŸ©é˜µBï¼Œéœ€è¦å†å­¦ä¹ ä¸€ä¸ªå‚æ•°çŸ©é˜µï¼Œå°†ä¸€ç³»åˆ—çš„è¾“å‡ºçŸ©é˜µåˆå¹¶èµ·æ¥ï¼›</li></ol><p>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶åœ¨åŸæœ‰æ³¨æ„åŠ›æœºåˆ¶çš„åŸºç¡€ä¸Šï¼ŒæŠŠåŸæœ‰çš„queryå‘é‡å†å¤šä¹˜nä¸ªå‚æ•°çŸ©é˜µï¼Œå°†queryå¤åˆ¶ä¸ºnä¸ªå­å‘é‡ï¼›keyå’Œvalueå‘é‡äº¦æ˜¯å¦‚æ­¤ï¼š</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/multi-head-self-attention-1.png" alt></p><p>queryå‘é‡çš„ç¬¬ä¸€ä¸ªå¤åˆ¶ä½“ä¼šä¸å„ä¸ªkeyå‘é‡çš„ç¬¬ä¸€ä¸ªå¤åˆ¶ä½“è¿›è¡Œè®¡ç®—ç›¸å…³æ€§ï¼Œç”Ÿæˆç›¸å…³æ€§çŸ©é˜µA1ï¼Œç¬¬äºŒä¸ªå¤åˆ¶ä½“ä¼šä¸å„ä¸ªkeyå‘é‡çš„ç¬¬äºŒä¸ªå¤åˆ¶ä½“è®¡ç®—ç›¸å…³æ€§ï¼Œç”Ÿæˆç›¸å…³æ€§çŸ©é˜µA2ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/multi-head-self-attention-2.png" alt></p><p>ç”±æ­¤ä¼šäº§å‡ºnä»½ä¸åŒçš„è¾“å‡ºå‘é‡ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯è€ƒè™‘nç§ä¸åŒç›¸å…³æ€§ä¸‹è®¡ç®—å‡ºæ¥çš„è¾“å‡ºå‘é‡ã€‚ä½¿ç”¨ä¸€ä¸ªå‚æ•°çŸ©é˜µå°†ä»–ä»¬åˆå¹¶èµ·æ¥ï¼š</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/multi-head-self-attention-3.png" alt></p><p>è¿™å°±æ˜¯å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶çš„è®¾è®¡æ€è·¯ã€‚å¦‚æœè¦è®¡ç®—Nç§ç›¸å…³æ€§ï¼Œå°±å«åšNå¤´æ³¨æ„åŠ›æœºåˆ¶ã€‚</p><h2 id="äº”ã€ä½ç½®ç¼–ç "><a href="#äº”ã€ä½ç½®ç¼–ç " class="headerlink" title="äº”ã€ä½ç½®ç¼–ç "></a>äº”ã€ä½ç½®ç¼–ç </h2><p>ä¸Šé¢çš„æœºåˆ¶åªä»‹ç»äº† self-attention å¦‚ä½•æŠŠè¾“å…¥å‘é‡å’Œå®ƒçš„ä¸Šä¸‹æ–‡ä¿¡æ¯è¿›è¡Œç¼–ç ï¼Œä½†æ˜¯å¿½ç•¥äº†ä¸Šä¸‹æ–‡ä¹Ÿæ˜¯æœ‰ä½ç½®å…³ç³»çš„ï¼Œç†è®ºä¸Šç¦»å½“å‰ä½ç½®æ›´è¿‘çš„ä¸Šä¸‹æ–‡åº”è¯¥è·å¾—æ›´å¤šæ³¨æ„åŠ›ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦é¢å¤–æ·»åŠ ä¸€ä¸ªèƒ½å¤Ÿè¡¨ç¤ºä½ç½®çš„å‚æ•°ã€‚</p><p>åšæ³•ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨è¾“å…¥å±‚ä¸ºæ¯ä¸ªå‘é‡æ·»åŠ ä¸€ä¸ªé¢å¤–çš„ä½ç½®å‘é‡å³å¯ã€‚</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/positional-encoding-1.png" alt></p><p>è¿™ä¸ªä½ç½®å‘é‡å¯ä»¥æ˜¯ä½ è‡ªå·±å®šä¹‰çš„ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°æ”¾åˆ°ç½‘ç»œä¸­è¿›è¡Œå­¦ä¹ ã€‚æ€»ä¹‹å®ƒç†è®ºä¸Šåº”è¯¥èƒ½å¤Ÿè¡¨ç¤ºä½ç½®çš„è¿œè¿‘å…³ç³»ã€‚</p><h2 id="å…­ã€self-attention-çš„å…·ä½“åº”ç”¨"><a href="#å…­ã€self-attention-çš„å…·ä½“åº”ç”¨" class="headerlink" title="å…­ã€self-attention çš„å…·ä½“åº”ç”¨"></a>å…­ã€self-attention çš„å…·ä½“åº”ç”¨</h2><p>ä¸Šé¢æˆ‘ä»¬æ˜¯ä»¥æ–‡æœ¬ä¸ºä¾‹ä»‹ç»çš„self-attentionï¼Œå®é™…ä¸Šæœ‰å¾ˆå¤šå…¶ä»–ä»»åŠ¡ä¹Ÿå¯ä»¥ç”¨self-attentionæ¥è§£å†³ï¼ˆè™½ç„¶ä¸è§å¾—æ˜¯æœ€ä½³æ–¹æ¡ˆï¼‰ã€‚</p><p>è¯­éŸ³è¯†åˆ«ä»»åŠ¡é‡Œï¼Œé€šè¿‡å°†ä¸€æ®µéŸ³é¢‘æŒ‰ç…§ä¸€å®šæ—¶é—´çª—å£è¿›è¡Œåˆ‡åˆ†ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ä¸€ä¸ªåŒ…å«å¾ˆå¤šå‘é‡çš„è¾“å…¥åºåˆ—ï¼›åˆ™å¤„ç†æ–¹æ³•ä¸æ–‡æœ¬ä»»åŠ¡å¤§åŒå°å¼‚ï¼Œåªä¸è¿‡è¯­éŸ³åˆ†å‰²æ—¶äº§ç”Ÿçš„è¾“å…¥åºåˆ—ä¼šéå¸¸é•¿ï¼Œæ­¤æ—¶éœ€è¦å¯¹è®¡ç®—è¿‡ç¨‹åŠ ä»¥ä¼˜åŒ–ã€‚ä¾‹å­ï¼šTruncate Self-Attention</p><p>å›¾åƒè¯†åˆ«ä»»åŠ¡é‡Œï¼Œæ¯ä¸ªå›¾åƒæŒ‰ç…§åƒç´ è¿›è¡Œåˆ†å‰²ï¼Œå¹¶é€è¡Œéå†ï¼Œä¹Ÿå¯ä»¥å½¢æˆä¸€ä¸ªåºåˆ—ï¼Œè¿™ä¸ªåºåˆ—é‡Œçš„æ¯ä¸ªè¾“å…¥å‘é‡æ˜¯(R,G,B)çš„ä¸‰ç»´å‘é‡ã€‚ä¾‹å­ï¼šSelf-Attention GAN</p><h2 id="ä¸ƒã€å…¶ä»–å˜ç§-self-attention"><a href="#ä¸ƒã€å…¶ä»–å˜ç§-self-attention" class="headerlink" title="ä¸ƒã€å…¶ä»–å˜ç§ self-attention"></a>ä¸ƒã€å…¶ä»–å˜ç§ self-attention</h2><h2 id="å…«ã€æ€»ç»“å’Œæé—®"><a href="#å…«ã€æ€»ç»“å’Œæé—®" class="headerlink" title="å…«ã€æ€»ç»“å’Œæé—®"></a>å…«ã€æ€»ç»“å’Œæé—®</h2><h3 id="1-Self-Attention-çš„æ ¸å¿ƒæ€æƒ³ï¼Ÿ"><a href="#1-Self-Attention-çš„æ ¸å¿ƒæ€æƒ³ï¼Ÿ" class="headerlink" title="1. Self-Attention çš„æ ¸å¿ƒæ€æƒ³ï¼Ÿ"></a>1. Self-Attention çš„æ ¸å¿ƒæ€æƒ³ï¼Ÿ</h3><p>é€šè¿‡ç»¼åˆè€ƒè™‘è¾“å…¥è¯ä¸ä¸Šä¸‹æ–‡ä¹‹é—´çš„ç›¸å…³å…³ç³»ï¼Œå¾—åˆ°åŒ…å«ä¸Šä¸‹æ–‡è¯­ä¹‰ä¿¡æ¯çš„è¾“å‡ºå‘é‡ã€‚</p><h3 id="2-Self-attention-æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Ÿ"><a href="#2-Self-attention-æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Ÿ" class="headerlink" title="2. Self-attention æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Ÿ"></a>2. Self-attention æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Ÿ</h3><script type="math/tex; mode=display">\text{Attention}(Q,K,V)=\text{softmax}(\frac{QK^T}{\sqrt{d_k}})V</script><p>å…¶ä¸­Qã€Kã€Véƒ½æ˜¯ä»è¾“å…¥å‘é‡å­¦ä¹ è€Œæ¥çš„ç¨ å¯†å‘é‡ç»„æˆçš„çŸ©é˜µï¼Œå®ƒä»¬ä¸åŒ…å«ä¸Šä¸‹æ–‡çš„è¯­ä¹‰ä¿¡æ¯ï¼›</p><ul><li>Qï¼šæŸ¥è¯¢å‘é‡ï¼Œç›®æ ‡å­—ä½œä¸º Queryï¼›</li><li>Kï¼šé”®å‘é‡ï¼Œå…¶ä¸Šä¸‹æ–‡çš„å„ä¸ªå­—ä½œä¸º Keyï¼›</li><li>Vï¼šå€¼å‘é‡ï¼Œä¸Šä¸‹æ–‡å„ä¸ªå­—çš„ Valueï¼›</li></ul><p>$d_k$æ˜¯Q/K/Vçš„ç»´åº¦ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†é™ä½åˆ†é‡ä¹‹é—´çš„æ–¹å·®ï¼Œé˜²æ­¢è¾“å…¥å‘é‡çš„ç»´åº¦è¿‡é«˜å¯¼è‡´ç‚¹å‡»å‡ºæ¥çš„ç»“æœè¿‡å¤§ï¼Œä½¿softmaxå‡ºæ¥çš„ç»“æœå‡ºç°ä¸€äº›æç«¯æƒ…å†µï¼ˆæ¯”å¦‚åªæœ‰ä¸€ä¸ªåˆ†é‡æ˜¯0.99999ï¼Œå…¶ä»–åˆ†é‡éƒ½æ˜¯0ï¼‰ï¼Œè¿›è€Œå¯¼è‡´è®­ç»ƒå›°éš¾çš„ç°è±¡ã€‚</p><h3 id="3-Self-Attention-å’Œ-CNN-çš„å¼‚åŒï¼Ÿ"><a href="#3-Self-Attention-å’Œ-CNN-çš„å¼‚åŒï¼Ÿ" class="headerlink" title="3. Self-Attention å’Œ CNN çš„å¼‚åŒï¼Ÿ"></a>3. Self-Attention å’Œ CNN çš„å¼‚åŒï¼Ÿ</h3><p>CNNæ˜¯ä¸€ç±»ç‰¹æ®Šçš„Attentionï¼Œå³å°†æ³¨æ„åŠ›èšç„¦äºæ„Ÿå—é‡ï¼ˆå·ç§¯æ ¸ï¼‰ä¸­çš„ä¸€ç§self-attentionç½‘ç»œç»“æ„ã€‚</p><p>è€Œself-attentionçš„æ„Ÿå—é‡èŒƒå›´æ˜¯æ•´ä¸ªåºåˆ—ï¼Œå¯ä»¥è‡ªè¡Œå­¦ä¹ å“ªäº›æ˜¯éœ€è¦é‡ç‚¹å…³æ³¨çš„ã€‚</p><p>è¿™ä¹Ÿå°±æ„å‘³ç€self-attentionç›¸è¾ƒäºCNNè€Œè¨€æ›´å¤æ‚ã€å‚æ•°æ›´å¤šï¼Œéœ€è¦æ›´å¤šæ•°æ®è¿›è¡Œè®­ç»ƒã€‚</p><p>æœ‰è®¨è®ºäºŒè€…å…³ç³»çš„è®ºæ–‡ï¼š</p><blockquote><p>On the Relationship between Self-Attention and Convolutional Layers</p></blockquote><p>ä»æ‰€éœ€çš„æ•°æ®é‡å’Œå‡†ç¡®ç‡æ¯”è¾ƒä¸Šï¼Œå¯ä»¥è¾…è¯è¿™ä¸€ç‚¹ï¼š</p><p><img src="/2022/10/23/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note6-%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/self-attention-versus-cnn.png" alt></p><p>é‚£å°±æ˜¯åœ¨æ•°æ®é‡è¾ƒå°çš„æƒ…å†µä¸‹ï¼ŒCNNä½œä¸ºç®€å•æ¨¡å‹å¯ä»¥è¡¨ç°å¾—æ›´å¥½ï¼›ä½†æ˜¯æ•°æ®é‡å……è¶³æ—¶ï¼Œself-attentionå…·æœ‰æ›´é«˜çš„ä¸Šé™ã€‚</p><h3 id="4-Self-Attention-ä¸-RNN-çš„æ¯”è¾ƒï¼Ÿ"><a href="#4-Self-Attention-ä¸-RNN-çš„æ¯”è¾ƒï¼Ÿ" class="headerlink" title="4. Self-Attention ä¸ RNN çš„æ¯”è¾ƒï¼Ÿ"></a>4. Self-Attention ä¸ RNN çš„æ¯”è¾ƒï¼Ÿ</h3><p>RNNè™½ç„¶ä¹Ÿèƒ½å¤Ÿå­¦ä¹ é•¿è·ç¦»ä¾èµ–å…³ç³»ï¼Œä½†æ˜¯å®ƒçš„ç»“æ„å’Œè¿ä½œæ–¹å¼ï¼ˆè¦æƒ³è®¡ç®—b2ï¼Œå¿…é¡»å…ˆè®¡ç®—b1ï¼Œå­˜åœ¨å…ˆåä¾èµ–å…³ç³»ï¼‰å†³å®šäº†å®ƒéš¾ä»¥å¹¶è¡ŒåŒ–ï¼Œè¿™å°±å¯¼è‡´å®ƒçš„è®­ç»ƒè¿‡ç¨‹éå¸¸ç¼“æ…¢ã€‚</p><p>å¦å¤–RNNåœ¨è¾“å…¥åºåˆ—è¿‡é•¿æ—¶ï¼Œä¹Ÿå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±æˆ–è€…æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ï¼Œå¯¼è‡´æ— æ³•è®°å¿†é•¿è·ç¦»ä¿¡æ¯ã€‚</p><p>Self-Attentionçš„å†…éƒ¨æœ‰å¤§é‡çŸ©é˜µä¹˜æ³•è¿ç®—ï¼Œå¯ä»¥è¢«GPUä¼˜åŒ–çš„å¾ˆå¿«ã€‚</p><h3 id="5-MultiHead-Attention-çš„ç”Ÿæ•ˆåŸç†ï¼Ÿ"><a href="#5-MultiHead-Attention-çš„ç”Ÿæ•ˆåŸç†ï¼Ÿ" class="headerlink" title="5. MultiHead Attention çš„ç”Ÿæ•ˆåŸç†ï¼Ÿ"></a>5. MultiHead Attention çš„ç”Ÿæ•ˆåŸç†ï¼Ÿ</h3><p>å€Ÿé‰´äº†CNNä¸­åŒä¸€å·ç§¯å±‚å†…ä½¿ç”¨å¤šä¸ªå·ç§¯æ ¸çš„æ€æƒ³ã€‚ç±»ä¼¼äºCNNä¸­é€šè¿‡å¤šé€šé“æœºåˆ¶è¿›è¡Œç‰¹å¾é€‰æ‹©ã€‚</p><p>Transformerä¸­ä½¿ç”¨åˆ‡å¤´(split)çš„æ–¹æ³•ï¼Œæ˜¯ä¸ºäº†åœ¨ä¸å¢åŠ å¤æ‚åº¦ï¼ˆ$O(n^2 d)$ï¼‰çš„å‰æä¸‹äº«å—ç±»ä¼¼CNNä¸­â€œä¸åŒå·ç§¯æ ¸â€çš„ä¼˜åŠ¿ã€‚</p><p>åœ¨æ¯ä¸ªå¤´çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå½¼æ­¤ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œå‚æ•°ä¸å…±äº«ï¼Œä»…åœ¨æœ€åå°†ç»“æœæ‹¼æ¥èµ·æ¥ï¼Œè¿™æ ·å¯ä»¥å…è®¸æ¨¡å‹åœ¨ä¸åŒçš„è¡¨ç¤ºå­ç©ºé—´é‡Œå­¦ä¹ åˆ°ç›¸å…³çš„ä¿¡æ¯ã€‚</p><p>æœ€åæ•´åˆå¤šä¸ªå‘é‡ï¼ŒæŠŠä»–ä»¬é™ç»´åˆ°ä¸€ä¸ªå‘é‡çš„é•¿åº¦ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯åœ¨å­¦ä¹ â€åˆ°åº•å“ªä¸ªå¤´å­¦åˆ°çš„çŸ¥è¯†æ˜¯æœ‰æ•ˆçš„â€ã€‚</p><h3 id="6-ä½ç½®ç¼–ç çš„è®¡ç®—æ–¹æ³•ï¼Ÿ"><a href="#6-ä½ç½®ç¼–ç çš„è®¡ç®—æ–¹æ³•ï¼Ÿ" class="headerlink" title="6. ä½ç½®ç¼–ç çš„è®¡ç®—æ–¹æ³•ï¼Ÿ"></a>6. ä½ç½®ç¼–ç çš„è®¡ç®—æ–¹æ³•ï¼Ÿ</h3><p>Attention is all you need è®ºæ–‡ä¸­çš„ä½ç½®ç¼–ç çš„å®ç°æ–¹å¼å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">\text{PosEncoding}_{(\text{pos}, 2i)}=\sin{(\frac{\text{pos}}{10000^{2i/d_{model}}})} \\\text{PosEncoding}_{(\text{pos}, 2i+1)}=\cos{(\frac{\text{pos}}{10000^{2i/d_{model}}})}</script><p>å…¶ä¸­posè¡¨ç¤ºè¯åœ¨å¥å­ä¸­çš„ä½ç½®ï¼Œiåˆ™è¡¨ç¤ºå‘é‡çš„åˆ†é‡ã€‚è¿™ç§è®¡ç®—æ–¹æ³•æ— éœ€å­¦ä¹ ä»»ä½•å‚æ•°ã€‚</p><p>åœ¨BERTè®ºæ–‡ä¸­ï¼Œé‡‡ç”¨çš„ä½ç½®ç¼–ç å°±å˜æˆäº†Embeddingçš„æ–¹æ³•è‡ªåŠ¨å­¦ä¹ å¾—åˆ°ã€‚</p><h2 id="é™„ã€self-attention-çš„ä»£ç å®ç°"><a href="#é™„ã€self-attention-çš„ä»£ç å®ç°" class="headerlink" title="é™„ã€self-attention çš„ä»£ç å®ç°"></a>é™„ã€self-attention çš„ä»£ç å®ç°</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šè‡ªæ³¨æ„åŠ›æœºåˆ¶ã€‚&lt;br&gt;&lt;!--more---&gt;&lt;/p&gt;
&lt;h2 id=&quot;ä¸€ã€è¾“å…¥ä»å›¾åƒåˆ°åºåˆ—&quot;&gt;&lt;a href=&quot;#ä¸€ã€è¾“å…¥ä»å›¾åƒåˆ°åºåˆ—&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€è¾“å…¥ä»å›¾åƒåˆ°åº</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="MOOC" scheme="https://superlova.github.io/tags/MOOC/"/>
    
    <category term="Self-Attention" scheme="https://superlova.github.io/tags/Self-Attention/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æå®æ¯…2019ML-Note5-å·ç§¯ç¥ç»ç½‘ç»œ</title>
    <link href="https://superlova.github.io/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"/>
    <id>https://superlova.github.io/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/</id>
    <published>2022-10-22T13:48:58.000Z</published>
    <updated>2022-10-22T18:46:52.357Z</updated>
    
    <content type="html"><![CDATA[<p>æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šå·ç§¯ç¥ç»ç½‘ç»œã€‚<br><!--more---></p><h2 id="ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨CNNï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨CNNï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨CNNï¼Ÿ"></a>ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨CNNï¼Ÿ</h2><p>è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆè¦è¯´æ˜ä¸ºä»€ä¹ˆå…¨è¿æ¥ç½‘ç»œä¸é€‚åˆåšå›¾åƒè¯†åˆ«ä»»åŠ¡ã€‚</p><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/ä¸ºä»€ä¹ˆè¦ç”¨CNN_1.png" alt></p><p>ä»¥å›¾åƒä¸ºè¾“å…¥ï¼Œä¼šå¯¼è‡´è¾“å…¥åºåˆ—ç‰¹åˆ«é•¿ã€‚å‡è®¾è¾“å…¥æ˜¯ä¸€å¼ <code>100*100</code>åƒç´ çš„å›¾ç‰‡ï¼Œæ¯ä¸ªåƒç´ æœ‰<code>R/G/B</code>ä¸‰ä¸ªåˆ†é‡ï¼Œè¦æƒ³å°†å®ƒæ•´ç†ä¸ºè¾“å…¥åºåˆ—ï¼Œæ¯å¼ å›¾ç‰‡çš„ç»´åº¦ä¸º<code>100*100*3=30000</code>ã€‚</p><p>è¾“å…¥å±‚çš„å‚æ•°è¿‡å¤šï¼Œä¼šå¯¼è‡´ä¸­é—´å±‚çš„å‚æ•°è¿‡å¤šï¼Œç½‘ç»œä¸ä»…è®­ç»ƒä»£ä»·æå‡ï¼Œè¿˜æœ‰è¿‡æ‹Ÿåˆçš„é£é™©ã€‚å®é™…ä¸Šå›¾åƒåˆ†ç±»ä»»åŠ¡ç”¨ä¸ç€é‚£ä¹ˆå¤šå‚æ•°ï¼ŒåŸå› æœ‰ä¸‰ï¼š</p><ol><li>æ¯ç§ç‰¹å¾æ‰€éœ€çš„ä»…ä»…æ˜¯å›¾ç‰‡çš„ä¸€å°éƒ¨åˆ†</li></ol><p>ä»ç¥ç»ç½‘ç»œçš„å¯è§£é‡Šæ€§ä¸Šæ¥è¯´ï¼Œç½‘ç»œçš„ç¬¬ä¸€å±‚å­¦ä¹ åˆ°çš„æ˜¯æœ€ç®€å•çš„ç‰¹å¾åˆ†ç±»ï¼Œæ¯”å¦‚ä¸€å¼ è¾“å…¥å›¾ç‰‡â€æœ‰æ²¡æœ‰ç»¿è‰²å‡ºç°ï¼Œæœ‰æ²¡æœ‰é»„è‰²å‡ºç°ï¼Œæœ‰æ²¡æœ‰æ–œçš„æ¡çº¹â€œç­‰ç­‰ï¼›ç¬¬äºŒå±‚ä¼šå­¦åˆ°æ›´å¤æ‚ä¸€äº›çš„ç‰¹å¾ç»„åˆï¼Œè¶Šå¾€åå­¦åˆ°çš„ç‰¹å¾è¶ŠæŠ½è±¡ã€‚</p><p>ä½†æ˜¯å¯¹äºä¸€ä¸ªæ£€æµ‹â€æ˜¯å¦æœ‰é¸Ÿå˜´â€œçš„åˆ†ç±»å™¨æ¥è¯´ï¼Œä¸éœ€è¦çœ‹æ•´å¼ å›¾ç‰‡å°±å¯ä»¥çŸ¥é“è¿™ä»¶äº‹ï¼›<strong>è¾“å…¥åºåˆ—å¯ä»¥ä»ä¸€æ•´å¼ å›¾ç‰‡ä¼˜åŒ–ä¸ºåŸå›¾çš„ä¸€å°éƒ¨åˆ†</strong>ã€‚</p><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/ä¸ºä»€ä¹ˆè¦ç”¨CNN_2.png" alt></p><ol><li>è¯†åˆ«åŒä¸€ç‰¹å¾çš„åˆ†ç±»å™¨çš„éƒ¨åˆ†å‚æ•°å¯ä»¥å…±äº«</li></ol><p>å¯¹äºæ£€æµ‹é¸Ÿå˜´çš„åˆ†ç±»å™¨è€Œè¨€ï¼Œé¸Ÿå˜´å‡ºç°åœ¨å›¾ç‰‡çš„ä¸åŒä½ç½®æ ¹æœ¬æ— æ‰€è°“ã€‚æˆ‘ä»¬ä¸éœ€è¦è®­ç»ƒä¸¤ç»„å‚æ•°ï¼Œæ¥åˆ†åˆ«æ£€æµ‹åˆ°åº•æ˜¯å·¦ä¸‹æ–¹çš„é¸Ÿå˜´è¿˜æ˜¯å³ä¸Šæ–¹çš„é¸Ÿå˜´ã€‚è¿™æ„å‘³ç€<strong>åšåŒä¸€ç‰¹å¾åˆ†ç±»çš„å‚æ•°å¯ä»¥å…±äº«</strong>ã€‚</p><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/ä¸ºä»€ä¹ˆè¦ç”¨CNN_3_å‚æ•°å…±äº«.png" alt></p><ol><li><strong>è¾“å…¥åºåˆ—çš„éƒ¨åˆ†ä¿¡æ¯å¯ä»¥ç•¥è¿‡</strong></li></ol><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/ä¸ºä»€ä¹ˆè¦ç”¨CNN_4.png" alt></p><p>å¯¹å›¾ç‰‡è¿›è¡Œé‡‡æ ·ï¼Œå¾—åˆ°çš„åƒç´ æ›´ä½çš„å›¾ç‰‡ï¼Œå¹¶ä¸ä¼šå½±å“äººå¯¹è¿™å¼ å›¾ç‰‡çš„ç†è§£ã€‚</p><h2 id="CNN-æ¶æ„"><a href="#CNN-æ¶æ„" class="headerlink" title="CNN æ¶æ„"></a>CNN æ¶æ„</h2><p>å·ç§¯ç¥ç»ç½‘ç»œæœ‰ä¸¤ä¸ªåŸºæœ¬å•å…ƒï¼šå·ç§¯å±‚(Convolution Layers)å’Œæ± åŒ–å±‚(MaxPooling Layers)ï¼Œå¯ä»¥å®ç°ä¸Šé¢ä¸‰ç‚¹æ€§èƒ½ä¼˜åŒ–ã€‚</p><p>ä¸€ä¸ªå®Œæ•´çš„å·ç§¯ç¥ç»ç½‘ç»œå¤§æ¦‚é•¿è¿™æ ·ï¼š</p><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/CNNæ¶æ„_1.png" alt></p><p>å·ç§¯å±‚ï¼šæ˜¯ä¸€ç§åˆ©ç”¨å·ç§¯æ“ä½œæå–å›¾åƒçš„å±€éƒ¨ç‰¹å¾çš„ç½‘ç»œç»“æ„ã€‚é€šè¿‡é€‰æ‹©å·ç§¯æ ¸ï¼Œä¸æ–­æ‰§è¡Œå·ç§¯æ“ä½œï¼Œå¾—åˆ°åŸå›¾åƒçš„ç‰¹å¾å›¾ï¼›åç»­çš„ç½‘ç»œæ ¹æ®è¯¥ç‰¹å¾å›¾ä¸ºè¾“å…¥ï¼Œç»§ç»­æå–ç‰¹å¾ã€‚</p><p>æ± åŒ–å±‚ï¼šæœ‰æœ€å¤§æ± åŒ–å’Œå¹³å‡æ± åŒ–ä¸¤ç§æ–¹å¼ï¼Œæœ€å¤§æ± åŒ–æ˜¯å–æ»‘åŠ¨çª—å£å†…æœ€å¤§çš„å…ƒç´ ä½œä¸ºè¾“å‡ºã€‚</p><h2 id="CNN-å·ç§¯å±‚ä¸å…¨è¿æ¥å±‚çš„è”ç³»"><a href="#CNN-å·ç§¯å±‚ä¸å…¨è¿æ¥å±‚çš„è”ç³»" class="headerlink" title="CNN å·ç§¯å±‚ä¸å…¨è¿æ¥å±‚çš„è”ç³»"></a>CNN å·ç§¯å±‚ä¸å…¨è¿æ¥å±‚çš„è”ç³»</h2><p>å·ç§¯æ ¸ä¸­çš„æƒå€¼æ¯æ¬¡æ»‘åŠ¨è®¡ç®—æ—¶åªæ˜¯å±€éƒ¨è¿æ¥ï¼Œä¸”åœ¨å·ç§¯åˆ—ä¸­çš„ç¥ç»å…ƒå…±äº«å‚æ•°â€”â€”è®¡ç®—å±€éƒ¨ä¿¡æ¯ï¼Œè€Œå…¨è¿æ¥å±‚ç¥ç»å…ƒçš„æƒå€¼ä¸æ‰€æœ‰è¾“å…¥ç›¸è¿â€”â€”è®¡ç®—å…¨å±€ä¿¡æ¯ã€‚</p><p>å·ç§¯å±‚çš„ä½œç”¨æ˜¯ä»è¾“å…¥æ•°æ®ä¸­é‡‡é›†å…³é”®æ•°æ®å†…å®¹ã€‚å…¨è¿æ¥å±‚åœ¨æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œä¸­çš„ä½œç”¨æ˜¯å°†å‰é¢ç»è¿‡å¤šæ¬¡å·ç§¯åé«˜åº¦æŠ½è±¡çš„ç‰¹å¾è¿›è¡Œæ•´åˆã€‚</p><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/CNNå·ç§¯å±‚ä¸å…¨è¿æ¥å±‚çš„å…³ç³».png" alt></p><h2 id="ç”¨Keraså®ç°CNNç½‘ç»œ"><a href="#ç”¨Keraså®ç°CNNç½‘ç»œ" class="headerlink" title="ç”¨Keraså®ç°CNNç½‘ç»œ"></a>ç”¨Keraså®ç°CNNç½‘ç»œ</h2><p>ä»¥<a href="https://www.tensorflow.org/tutorials/images/cnn">tensorflowçš„å›¾åƒåˆ†ç±»æ•™ç¨‹</a>ä¸ºä¾‹ï¼Œå®è·µä½¿ç”¨kerasæ­å»ºå·ç§¯æ¨¡å‹çš„æ–¹æ³•ï¼š</p><p>å…ˆå¯¼å…¥ç›¸å…³åŒ…</p><pre><code class="lang-py">import tensorflow as tffrom tensorflow.keras import datasets, layers, modelsimport matplotlib.pyplot as plt</code></pre><p>ç„¶åä¸‹è½½å¹¶å‡†å¤‡ CIFAR10 æ•°æ®é›†</p><pre><code class="lang-py">(train_images, train_labels), (test_images, test_labels) = datasets.cifar10.load_data()# å½’ä¸€åŒ–åƒç´ å€¼åˆ° 0 ~ 1train_images, test_images = train_images / 255.0, test_images / 255.0</code></pre><p>éªŒè¯æ•°æ®</p><pre><code class="lang-py">class_names = [&#39;airplane&#39;, &#39;automobile&#39;, &#39;bird&#39;, &#39;cat&#39;, &#39;deer&#39;,               &#39;dog&#39;, &#39;frog&#39;, &#39;horse&#39;, &#39;ship&#39;, &#39;truck&#39;]plt.figure(figsize=(10,10))for i in range(25):    plt.subplot(5,5,i+1)    plt.xticks([])    plt.yticks([])    plt.grid(False)    plt.imshow(train_images[i])    # The CIFAR labels happen to be arrays,     # which is why you need the extra index    plt.xlabel(class_names[train_labels[i][0]])plt.show()</code></pre><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/CIFAR10æ ·ä¾‹.png" alt></p><p>æ¥ä¸‹æ¥å¼€å§‹æ­å»ºç½‘ç»œï¼š</p><pre><code class="lang-py">model = models.Sequential()model.add(layers.Conv2D(32, (3, 3), activation=&#39;relu&#39;, input_shape=(32, 32, 3)))model.add(layers.MaxPooling2D((2, 2)))model.add(layers.Conv2D(64, (3, 3), activation=&#39;relu&#39;))model.add(layers.MaxPooling2D((2, 2)))model.add(layers.Conv2D(64, (3, 3), activation=&#39;relu&#39;))</code></pre><p>å·ç§¯ç½‘ç»œè¢«å°è£…ä¸º<code>Conv2D</code>ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå·ç§¯æ ¸ä¸ªæ•°ï¼Œä½ å¯ä»¥ç†è§£ä¸ºéšè—å±‚ç¥ç»å…ƒä¸ªæ•°ï¼›æˆ‘ä»¬è¿™é‡Œå®šä¹‰ä¸º32ä¸ªï¼Œå®ƒä¼šæå–32ç§ä¸åŒç±»åˆ«çš„ç‰¹å¾ã€‚</p><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯(3,3)ï¼Œä»£è¡¨å·ç§¯æ ¸çš„å¤§å°æ˜¯<code>3*3</code>çš„ï¼Œè¿™ä¸æè€å¸ˆè¯¾å ‚ä¸Šçš„ç¤ºä¾‹ä¸€è‡´ï¼›</p><p>ç¬¬ä¸‰ä¸ªå‚æ•°ä»£è¡¨æˆ‘ä»¬é€‰æ‹©æ¿€æ´»å‡½æ•°ä¸º<code>relu</code>ï¼›</p><p>ç¬¬å››ä¸ªå‚æ•°æ˜¯åªæœ‰åœ¨ä¸´è¿‘è¾“å…¥å±‚çš„å·ç§¯å±‚æ‰ä¼šæœ‰çš„ï¼Œä»£è¡¨è¾“å…¥å‘é‡çš„ç»´åº¦ã€‚è¿™é‡Œçš„å›¾åƒæ˜¯å½©è‰²çš„ï¼Œä¸ä½†æœ‰é•¿å®½ï¼Œè¿˜æœ‰é€šé“æ•°(channels)ä¸º3ï¼Œå› æ­¤è¾“å…¥å‘é‡çš„å¤§å°ä¸º(32,32,3)ã€‚</p><p>åœ¨æ­å»ºå®Œç¬¬ä¸€å±‚Conv2Dåï¼Œç´§æ¥ç€ä¼šæ­å»ºæœ€å¤§æ± åŒ–å±‚ï¼Œæ± åŒ–å±‚filterä¸º<code>2*2</code>ã€‚åç»­çš„æ“ä½œä¹Ÿæ˜¯é‡å¤çš„ï¼Œéƒ½æ˜¯ä¸€å±‚å·ç§¯ã€ä¸€å±‚æ± åŒ–ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ¨¡å‹ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code class="lang-py">model.summary()</code></pre><pre><code>Model: &quot;sequential&quot;_________________________________________________________________ Layer (type)                Output Shape              Param #   ================================================================= conv2d (Conv2D)             (None, 30, 30, 32)        896        max_pooling2d (MaxPooling2D  (None, 15, 15, 32)       0          )                                                                conv2d_1 (Conv2D)           (None, 13, 13, 64)        18496      max_pooling2d_1 (MaxPooling  (None, 6, 6, 64)         0          2D)                                                              conv2d_2 (Conv2D)           (None, 4, 4, 64)          36928     =================================================================Total params: 56,320Trainable params: 56,320Non-trainable params: 0_________________________________________________________________</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€å±‚Conv2Dçš„è¾“å‡ºå‘é‡çš„å¤§å°å˜æˆäº†(30,30,32)ï¼Œè¿™é‡Œ32æ˜¯æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„å·ç§¯æ ¸ä¸ªæ•°ï¼Œ<code>30*30</code>åˆ™æ˜¯ç‰¹å¾å›¾å¤§å°ã€‚æ¯æ¬¡å·ç§¯æ“ä½œéƒ½ä¼šå¯¼è‡´å®½åº¦å’Œé«˜åº¦çš„æ”¶ç¼©ã€‚</p><p>å‚æ•°é‡ä¸º896ï¼Œè¿™æ˜¯å¦‚ä½•è®¡ç®—æ¥çš„å‘¢ï¼Ÿé¦–å…ˆæ¯ä¸ªå·ç§¯æ ¸æ˜¯<code>3*3</code>ï¼ŒåŒæ—¶å›¾åƒæœ‰3ä¸ªchannelï¼Œå› æ­¤æ¯ä¸ªå·ç§¯æ ¸çš„å‚æ•°ä¸ªæ•°ä¸º<code>3*3*3</code>ï¼Œå†åŠ ä¸Šä¸€ä¸ªåç½®é‡ï¼Œå°±æ˜¯28ä¸ªå‚æ•°ã€‚ä¸€å…±32ä¸ªå·ç§¯æ ¸ï¼Œæœ€åçš„å‚æ•°é‡å³ä¸º<code>[(height * width * channel) + 1] * filter</code>ã€‚</p><p>å·ç§¯å±‚åªæ˜¯ç‰¹å¾æå–å™¨ï¼Œæœ€åä¸ºäº†å®Œæˆåˆ†ç±»æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦åœ¨å·ç§¯å±‚åé¢æ‹¼æ¥å…¨è¿æ¥å±‚ã€‚ä¸ç”¨å¤ªå¤šï¼Œå‡ å±‚å°±å¤Ÿäº†ï¼š</p><pre><code class="lang-py">model.add(layers.Flatten())model.add(layers.Dense(64, activation=&#39;relu&#39;))model.add(layers.Dense(10))model.summary()</code></pre><pre><code>Model: &quot;sequential&quot;_________________________________________________________________ Layer (type)                Output Shape              Param #   ================================================================= conv2d (Conv2D)             (None, 30, 30, 32)        896        max_pooling2d (MaxPooling2D  (None, 15, 15, 32)       0          )                                                                conv2d_1 (Conv2D)           (None, 13, 13, 64)        18496      max_pooling2d_1 (MaxPooling  (None, 6, 6, 64)         0          2D)                                                              conv2d_2 (Conv2D)           (None, 4, 4, 64)          36928      flatten (Flatten)           (None, 1024)              0          dense (Dense)               (None, 64)                65600      dense_1 (Dense)             (None, 10)                650       =================================================================Total params: 122,570Trainable params: 122,570Non-trainable params: 0_________________________________________________________________</code></pre><p>å·ç§¯å±‚çš„è¾“å‡ºåœ¨è¾“å…¥ä¸¤ä¸ª Dense å±‚ä¹‹å‰éœ€è¦è¢«å±•å¹³ï¼ˆFlattenï¼‰ä¸ºå½¢çŠ¶ä¸º (1024) çš„å‘é‡ã€‚</p><p>ä»…æ·»åŠ äº†ä¸¤å±‚å…¨è¿æ¥å±‚ï¼Œå‚æ•°é‡å°±å¤šäº†65600+650ä¸ªï¼Œå¯ä»¥çœ‹åˆ°å…¨è¿æ¥å±‚çœŸçš„æ¯”CNNå¤šå¾ˆå¤šå†—ä½™å‚æ•°ã€‚</p><p>æœ€åç¼–è¯‘å¹¶è®­ç»ƒä¸€ä¸‹ï¼š</p><pre><code class="lang-py">model.compile(optimizer=&#39;adam&#39;,              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),              metrics=[&#39;accuracy&#39;])history = model.fit(train_images, train_labels, epochs=10,                     validation_data=(test_images, test_labels))plt.plot(history.history[&#39;accuracy&#39;], label=&#39;accuracy&#39;)plt.plot(history.history[&#39;val_accuracy&#39;], label = &#39;val_accuracy&#39;)plt.xlabel(&#39;Epoch&#39;)plt.ylabel(&#39;Accuracy&#39;)plt.ylim([0.5, 1])plt.legend(loc=&#39;lower right&#39;)plt.show()test_loss, test_acc = model.evaluate(test_images,  test_labels, verbose=2)</code></pre><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/è®­ç»ƒç»“æœ.png" alt></p><p>å‡†ç¡®ç‡åªæœ‰ä¸åˆ°70%ï¼Œå¯ä»¥æ”¹è¿›çš„åœ°æ–¹è¿˜æœ‰å¾ˆå¤šã€‚ä¸è¿‡å¯¹äºä¸€ä¸ªç®€å•æ¨¡å‹è€Œè¨€ï¼Œåœ¨10åˆ†ç±»ä»»åŠ¡ä¸Šèƒ½è¾¾åˆ°å¦‚æ­¤æˆç»©å·²æ˜¯ä¸å®¹æ˜“äº†ã€‚</p><h2 id="CNNå­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ"><a href="#CNNå­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="CNNå­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ"></a>CNNå­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ</h2><p>åˆ†æç¬¬ä¸€å±‚Convåˆ°åº•å­¦åˆ°äº†ä»€ä¹ˆè¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œå› ä¸ºæ¯ä¸ªå·ç§¯æ ¸å®é™…ä¸Šæ˜¯åœ¨è®¡ç®—å°èŒƒå›´å†…æ˜¯å¦åŒ…å«æŒ‡å®šç‰¹å¾ã€‚ä½†æ˜¯åç»­Convä¼šæ ¹æ®è¯¥ç‰¹å¾å›¾è®¡ç®—æ›´æŠ½è±¡çš„ç‰¹å¾ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åˆ†æï¼Ÿ</p><p>å¯ä»¥é‡‡ç”¨è¿™ç§åˆ†ææ–¹æ³•ï¼Œé¦–å…ˆå›ºå®šå‚æ•°ï¼Œç„¶åé€šè¿‡æ¢¯åº¦ä¸‹é™æ³•å»æ‰¾èƒ½å¤Ÿè®©æŸä¸ªç¥ç»å…ƒçš„è¾“å‡ºå€¼æœ€å¤§çš„è¾“å…¥å›¾ç‰‡ã€‚</p><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/ç”Ÿæˆæœ€èƒ½æ¿€æ´»æŸä¸ªç¥ç»å…ƒçš„å›¾ç‰‡.png" alt></p><p>ä¸Šé¢å°±æ˜¯12ä¸ªfilterå¯¹åº”çš„ç»“æœï¼Œè¿™äº›å›¾ç‰‡çš„ç‰¹å¾æ˜¯æŸç§çº¹è·¯åœ¨å›¾ä¸Šä¸æ–­çš„é‡å¤ã€‚å› æ­¤å®é™…ä¸Šç¥ç»å…ƒä¼šå¯¹è¿™ç§ä¸æ–­é‡å¤çš„èŠ±çº¹åšå‡ºæœ€å¤§çš„ååº”ã€‚</p><p>å½“æˆ‘ä»¬ä»¥åŒæ ·çš„åˆ†ææ–¹æ³•åˆ†æå·ç§¯ç½‘ç»œæœ€åçš„å…¨è¿æ¥å±‚ï¼ˆè¿™é‡Œæ±‡èšäº†å·ç§¯å±‚æå–å‡ºæ¥çš„å„è·¯ç‰¹å¾ï¼‰ï¼Œå¾—åˆ°çš„å›¾åƒä¸ºï¼š</p><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/å…¨è¿æ¥_ç”Ÿæˆæœ€èƒ½æ¿€æ´»æŸä¸ªç¥ç»å…ƒçš„å›¾ç‰‡.png" alt></p><p>å‘ç°æœ€èƒ½æ¿€æ´»æŸä¸ªç¥ç»å…ƒçš„å›¾ç‰‡ï¼Œä¸å†æ˜¯é‚£äº›çº¹è·¯å•ä¸€çš„å›¾åƒäº†ï¼Œè€Œæ˜¯å¸¦æœ‰æŸç§èŠ±çº¹ï¼Œä¼¼ä¹æœ‰æŸäº›å«ä¹‰ã€‚</p><p>ä½†æ˜¯å½“æˆ‘ä»¬ç”¨åŒæ ·çš„æ–¹æ³•åˆ†æè¾“å‡ºå±‚æ—¶ï¼Œå¾—åˆ°çš„å›¾åƒç†è®ºä¸Šåº”è¯¥æ˜¯ç¡®åˆ‡çš„æ•°å­—ï¼Œå®é™…ä¸Šç¡®å®ä¹±ç ä¸€æ ·æ— æ³•è¢«è¾¨è®¤çš„å›¾ç‰‡ï¼š</p><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/è¾“å‡ºå±‚_ç”Ÿæˆæœ€èƒ½æ¿€æ´»æŸä¸ªç¥ç»å…ƒçš„å›¾ç‰‡.png" alt></p><p>äººç±»è™½ç„¶æ— æ³•è¾¨è¯†ï¼Œä½†æ˜¯æœºå™¨ååˆ†ç¡®å®šåœ°å‘Šè¯‰æˆ‘ä»¬ï¼Œå·¦ä¸Šè§’çš„å›¾ç‰‡å°±æ˜¯0ï¼Œå³ä¸‹è§’å°±æ˜¯8ã€‚è¿™ç§ç°è±¡å¾ˆæœ‰æ„æ€ã€‚</p><p>è¿™ç§æ€æƒ³è¢«åº”ç”¨äºå¯¹æŠ—æ ·æœ¬æ”»å‡»ä¹‹ä¸­ï¼Œå¯ä»¥ç”Ÿæˆä¸€äº›ä»¤æ¨¡å‹è¯¯åˆ¤çš„è¯¡å¼‚å›¾ç‰‡ï¼Œå¹¶å°†å…¶æ”¹é€ åŸæœ¬çš„æ•°æ®é›†ï¼Œå°±å¯ä»¥ä»¤æ¨¡å‹çŠ¯é”™ã€‚</p><p>å…³äºæ–‡æœ¬é¢†åŸŸå¯¹æŠ—æ ·æœ¬çš„è®¨è®ºåœ¨<a href="https://superlova.github.io/2020/06/20/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E3%80%91Deep-Text-Classification-Can-be-Fooled/">è¿™é‡Œ</a></p><p>Deep Dreamåˆ™åˆ©ç”¨è¯¥æ€æƒ³ï¼Œå°†CNNå˜æˆä¸€ä¸ªå›¾åƒç”Ÿæˆå™¨ï¼Œå¤¸å¤§åŒ–åŸæœ‰çš„è¾“å…¥å›¾åƒï¼š</p><p><img src="/2022/10/22/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/DeepDreamå¤¸å¤§çš„å›¾åƒ.png" alt></p><p>å³è¾¹æœ‰ä¸€åªç†Šï¼Œè¿™ä¸ªç†ŠåŸæ¥æ˜¯ä¸€ä¸ªçŸ³å¤´(å¯¹æœºå™¨æ¥è¯´ï¼Œè¿™ä¸ªçŸ³å¤´æœ‰ç‚¹åƒç†Šï¼Œå®ƒå°±ä¼šå¼ºåŒ–è¿™ä»¶äº‹æƒ…ï¼Œæ‰€ä»¥å®ƒå°±çœŸçš„å˜æˆäº†ä¸€åªç†Š)ã€‚</p><h2 id="CNNçš„å…¶ä»–åº”ç”¨åœºæ™¯"><a href="#CNNçš„å…¶ä»–åº”ç”¨åœºæ™¯" class="headerlink" title="CNNçš„å…¶ä»–åº”ç”¨åœºæ™¯"></a>CNNçš„å…¶ä»–åº”ç”¨åœºæ™¯</h2><p>CNNå¯ä»¥åº”ç”¨äºæ¸¸æˆé¢†åŸŸï¼Œæ¯”å¦‚å›´æ£‹</p><p>CNNå¯ä»¥åº”ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸï¼Œæ¯”å¦‚æ–‡æœ¬åˆ†ç±»ã€è¯­éŸ³è¯†åˆ«</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šå·ç§¯ç¥ç»ç½‘ç»œã€‚&lt;br&gt;&lt;!--more---&gt;&lt;/p&gt;
&lt;h2 id=&quot;ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨CNNï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨CNNï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="MOOC" scheme="https://superlova.github.io/tags/MOOC/"/>
    
    <category term="Convolutional Neural Network" scheme="https://superlova.github.io/tags/Convolutional-Neural-Network/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æå®æ¯…ML-Note4-æ·±åº¦å­¦ä¹ ä¼˜åŒ–</title>
    <link href="https://superlova.github.io/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/"/>
    <id>https://superlova.github.io/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/</id>
    <published>2022-10-19T11:03:40.000Z</published>
    <updated>2022-10-19T14:21:27.005Z</updated>
    
    <content type="html"><![CDATA[<p>æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šæ·±åº¦å­¦ä¹ ç®—æ³•çš„ä¼˜åŒ–ã€‚<br><!--more---></p><p>ç¥ç»ç½‘ç»œè®­ç»ƒä¸å¥½æ€ä¹ˆåŠï¼Ÿä¸ºä»€ä¹ˆlossä¸ä¸‹é™ï¼Ÿè¿™é‡Œè®¨è®ºçš„è®­ç»ƒä¸å¥½ï¼Œæ˜¯æŒ‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„losså§‹ç»ˆé™ä¸ä¸‹æ¥ã€‚ä»æ•°å­¦ä¼˜åŒ–çš„è§’åº¦ï¼Œæ­¤æ—¶å¯èƒ½é™·å…¥äº†å±€éƒ¨æœ€å°å€¼æˆ–è€…éç‚¹ç­‰å¾®åˆ†ä¸ºé›¶çš„ç‚¹ã€‚</p><h2 id="1-ä¼˜åŒ–é™·å…¥éç‚¹-Saddle-Point-æˆ–å±€éƒ¨æå°å€¼-Local-Minima"><a href="#1-ä¼˜åŒ–é™·å…¥éç‚¹-Saddle-Point-æˆ–å±€éƒ¨æå°å€¼-Local-Minima" class="headerlink" title="1. ä¼˜åŒ–é™·å…¥éç‚¹ (Saddle Point) æˆ–å±€éƒ¨æå°å€¼ (Local Minima)"></a>1. ä¼˜åŒ–é™·å…¥éç‚¹ (Saddle Point) æˆ–å±€éƒ¨æå°å€¼ (Local Minima)</h2><p><img src="/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/é™·å…¥éç‚¹æˆ–è€…å±€éƒ¨æœ€å°ç‚¹.png" alt></p><p>éç‚¹æ˜¯æŒ‡åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šçš„gradient=0ï¼Œä½†æ˜¯åœ¨å…¶ä»–æ–¹å‘çš„gradientä¸ä¸ºé›¶ï¼Œè¯´æ˜lossä»æœ‰ç»§ç»­ä¼˜åŒ–çš„ç©ºé—´ã€‚</p><p>å±€éƒ¨æœ€å°ç‚¹åˆ™æ˜¯æ‰€æœ‰æ–¹å‘çš„gradientå‡ä¸ºé›¶ï¼Œæ­¤æ—¶æ— è®ºå¾€å“ªä¸ªæ–¹å‘èµ°éƒ½æ— æ³•ä»¤lossç»§ç»­å˜å°ã€‚è¿™ç§æƒ…å†µæ¯”è¾ƒæ£˜æ‰‹ã€‚</p><p>å¦‚ä½•ç¡®è®¤åˆ°åº•æ˜¯éç‚¹è¿˜æ˜¯å±€éƒ¨æå€¼ï¼Ÿ</p><p>è¿™é‡Œæœ‰ä¸ªç»“è®ºï¼šå¦‚æœè¯¥ç‚¹å¤„çš„äºŒé˜¶åå¯¼æ•°çŸ©é˜µï¼ˆæµ·å¡çŸ©é˜µï¼‰æ˜¯æ­£å®šçš„ï¼Œå³è¯¥æµ·å¡çŸ©é˜µçš„æ‰€æœ‰ç‰¹å¾å€¼éƒ½å¤§äºé›¶ï¼Œè¯´æ˜è¯¥ç‚¹é™„è¿‘çš„æ‰€æœ‰å€¼å‡å¤§äºè¯¥ç‚¹ï¼Œå³è¯¥ç‚¹ä¸ºå±€éƒ¨æœ€å°å€¼ã€‚</p><p>å¦‚æœæµ·å¡çŸ©é˜µçš„ç‰¹å¾å€¼å…¨ä¸ºè´Ÿï¼Œåˆ™è¯´æ˜è¿™é‡Œæ˜¯å±€éƒ¨æœ€å¤§å€¼ã€‚</p><p>å…¶ä»–æƒ…å†µä¸‹ï¼Œå¦‚æœæµ·å¡çŸ©é˜µçš„ç‰¹å¾å€¼æœ‰æ­£æœ‰è´Ÿï¼Œè¯´æ˜è¿™é‡Œæ˜¯ä¸ªéç‚¹ã€‚</p><p>æ±‚è§£è¯¥ç‚¹å¤„çš„äºŒé˜¶åå¯¼æ•°ä¸ä½†å¯ä»¥å¸®åŠ©åˆ¤æ–­æ˜¯å¦ä¸ºéç‚¹ï¼Œè¿˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬é€‰æ‹©ä¼˜åŒ–çš„æ–¹å‘ã€‚å¦‚æœè¯¥å¤„æ˜¯ä¸€ä¸ªéç‚¹ï¼Œåˆ™æˆ‘ä»¬å°±é€‰æ‹©ä¸€ä¸ªæµ·å¡çŸ©é˜µç‰¹å¾å€¼ä¸ºè´Ÿå€¼çš„ç‰¹å¾å‘é‡ï¼Œæœç€è¿™ä¸ªç‰¹å¾å‘é‡çš„æ–¹å‘è¿›è¡Œç§»åŠ¨ï¼Œå°±èƒ½å¤Ÿæœ€å¿«é€Ÿèµ°å‡ºéç‚¹ã€‚</p><p><img src="/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/å¿«é€Ÿèµ°å‡ºéç‚¹.png" alt></p><p>å®é™…ä¸Šæ±‚æµ·å¡çŸ©é˜µæ˜¯ä¸€ä¸ªè®¡ç®—é‡æ¯”è¾ƒå¤§çš„æ“ä½œï¼Œé™¤éæœ‰å¿…è¦ï¼Œå¦åˆ™è¿™ç§æ–¹æ³•å…¶å®å¾ˆå°‘ä½¿ç”¨ã€‚äº‹å®ä¸Šï¼Œå¾ˆå°‘æœ‰ä¼˜åŒ–ç®—æ³•å…·å¤‡æŠŠæŸå¤±å‡½æ•°ç»™ä¼˜åŒ–åˆ°å±€éƒ¨æœ€å°å€¼æˆ–è€…éç‚¹çš„ç¨‹åº¦ï¼Œåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬ä¼šå—åˆ°å…¶ä»–é—®é¢˜çš„å›°æ‰°ï¼Œæ¯”å¦‚batchæ²¡æœ‰é€‰æ‹©å¥½ã€ä¼˜åŒ–æ–¹æ³•å¹¶ä¸å¤Ÿä¼˜ç§€ç­‰ã€‚</p><h2 id="2-batchæ²¡æœ‰é€‰æ‹©å¥½"><a href="#2-batchæ²¡æœ‰é€‰æ‹©å¥½" class="headerlink" title="2. batchæ²¡æœ‰é€‰æ‹©å¥½"></a>2. batchæ²¡æœ‰é€‰æ‹©å¥½</h2><p>åœ¨ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•æ—¶ï¼Œæˆ‘ä»¬ä¼šå®šä¹‰ä¸€ä¸ªbatchå¤§å°ï¼Œå¹¶æŠŠè®­ç»ƒé›†åˆ†å‰²æˆbatchå¤§å°çš„ä¸€ä¸ªä¸ªå­é›†ï¼Œæ¯æ¬¡æ¢¯åº¦ä¸‹é™åªåœ¨å­é›†ä¸Šè¿›è¡Œéå†ï¼Œæ¯æ¬¡è®­ç»ƒå®Œä¸€ä¸ªå­é›†çš„å†…å®¹å«åšä¸€ä¸ªepochã€‚</p><p>batchçš„å¤§å°è‡ªç„¶ä¼šå½±å“ç½‘ç»œè®­ç»ƒçš„é€Ÿåº¦ä»¥åŠä¼˜åŒ–æ•ˆæœã€‚å°batchå¯ä»¥åŠ é€Ÿè®­ç»ƒï¼Œç¼ºç‚¹æ˜¯å°batchéšæœºæ€§æ›´å¤§ï¼Œæ²¡åŠæ³•ä»£è¡¨æ•´ä½“çš„æ•°æ®é›†ã€‚æç«¯æƒ…å†µä¸‹ï¼Œbatch=1æ—¶ï¼Œç”šè‡³ä¼šå‡ºç°lossåœ¨åŸåœ°ä¸æ–­éœ‡è¡çš„æƒ…å†µã€‚</p><p>ç„¶è€Œbatchè¿‡å¤§åˆ™å¤±å»äº†æ„ä¹‰ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´è®­ç»ƒé€Ÿåº¦å˜æ…¢ã€‚</p><p><img src="/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/batchå¤§å°çš„æƒè¡¡.png" alt></p><p>å¦‚æœå¼•å…¥å¹¶è¡Œè®¡ç®—ï¼ˆå³GPUè¿ç®—ï¼‰ï¼Œé‚£ä¹ˆbatch_sizeåœ¨ä¸€å®šç¨‹åº¦å†…éƒ½å¯ä»¥å¾ˆå¿«ã€‚ä½†æ˜¯ä¸åŒGPUæ”¯æŒçš„batch_sizeæ˜¯æœ‰æé™çš„ï¼ˆå–å†³äºæ˜¾å­˜ï¼‰ã€‚</p><p>batch_size å¯¹æœ€ç»ˆçš„ä¼˜åŒ–æ•ˆæœæœ‰å½±å“å—ï¼Ÿæ˜¯æœ‰çš„ã€‚å¤§çš„batch_sizeå¯èƒ½ä¼šå¯¼è‡´ä¼˜åŒ–é˜¶æ®µäº§ç”Ÿé—®é¢˜ã€‚</p><p><img src="/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/batch_sizeå¯¹æœ€ç»ˆä¼˜åŒ–æ•ˆæœçš„å½±å“.png" alt></p><p>è¿™ç§é—®é¢˜æ˜¯æ€ä¹ˆäº§ç”Ÿçš„å‘¢ï¼Ÿæœ‰ä¸€ç§è§£é‡Šæ˜¯è¿™æ ·çš„ï¼Œå½“æˆ‘ä»¬è¯•å›¾ä»¥ä¸€ä¸ªæ¯”è¾ƒå¤§çš„batch_sizeè®­ç»ƒæ¨¡å‹æ—¶ï¼Œå¯èƒ½ä¼šå¡åœ¨å®¢è§‚å­˜åœ¨çš„å±€éƒ¨æå€¼ç‚¹ï¼›ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ¯”è¾ƒå°çš„batchï¼Œç›¸å½“äºäººä¸ºå¼•å…¥äº†æ›´å¤šçš„éšæœºæ€§ã€‚wåœ¨batch_Aä¸Šæ˜¯å±€éƒ¨æå€¼ç‚¹ï¼Œä½†æ˜¯åœ¨batch_Bä¸Šå°±ä¸ä¸€å®šäº†ã€‚</p><p>å¦å¤–ï¼Œåœ¨testingçš„æ—¶å€™ï¼Œé€‰æ‹©ä¸åŒçš„batchä¹Ÿä¼šè®©accuracyä¸ä¸€æ ·ã€‚å¦‚æœå¤§çš„Batchå¯¹åº”çš„Testingç»“æœå·® ï¼Œä»£è¡¨ Overfitting ã€‚</p><p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼Œbatch_sizeå¯èƒ½é€ æˆçš„å½±å“ï¼š</p><p><img src="/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/batch_sizeçš„é€‰æ‹©æ€»ç»“.png" alt></p><h2 id="3-è™½ç„¶-gradient-æ²¡æœ‰é™ä½åˆ°0ï¼Œä½†æ˜¯-loss-å·²ç»ä¸å†-å˜å°-äº†ï¼ˆæ²¡æœ‰é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç®—æ³•ï¼‰"><a href="#3-è™½ç„¶-gradient-æ²¡æœ‰é™ä½åˆ°0ï¼Œä½†æ˜¯-loss-å·²ç»ä¸å†-å˜å°-äº†ï¼ˆæ²¡æœ‰é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç®—æ³•ï¼‰" class="headerlink" title="3. è™½ç„¶ gradient æ²¡æœ‰é™ä½åˆ°0ï¼Œä½†æ˜¯ loss å·²ç»ä¸å† å˜å° äº†ï¼ˆæ²¡æœ‰é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç®—æ³•ï¼‰"></a>3. è™½ç„¶ gradient æ²¡æœ‰é™ä½åˆ°0ï¼Œä½†æ˜¯ loss å·²ç»ä¸å† å˜å° äº†ï¼ˆæ²¡æœ‰é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç®—æ³•ï¼‰</h2><p>å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸ä¼šæœ‰çœŸæ­£é™·å…¥ critical point çš„æœºä¼šï¼Œè€Œæ˜¯åœ¨ critical point é™„è¿‘å¾˜å¾Šã€‚</p><p><img src="/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/è®­ç»ƒå¡ä½äº†å¹¶ä¸ä¸€å®šæ„å‘³ç€gradientå¾ˆå°.png" alt></p><p>å› æ­¤éœ€è¦æˆ‘ä»¬è°ƒæ•´å­¦ä¹ ç‡ã€‚æ¯ä¸ªä¸åŒçš„å‚æ•°åº”è¯¥åœ¨è®­ç»ƒçš„ä¸åŒé˜¶æ®µæ‹¥æœ‰ä¸åŒçš„å­¦ä¹ ç‡ã€‚è¿™ç§é€šè¿‡æ”¹å˜å­¦ä¹ ç‡æ¥ä¼˜åŒ–ç®—æ³•çš„è®­ç»ƒé€Ÿåº¦çš„æ–¹æ³•ï¼Œåœ¨Note2ä¸­å·²æœ‰ä»‹ç»ã€‚</p><p>å¸¸ç”¨çš„è‡ªé€‚åº”æ”¹å˜å‚æ•°å­¦ä¹ ç‡çš„ç®—æ³•æœ‰Adagradç®—æ³•ã€RMSPropç®—æ³•ç­‰ã€‚</p><p>ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨å¸¦æœ‰momentumçš„ä¼˜åŒ–ç®—æ³•ã€‚åŠ¨é‡æ³•åœ¨Note2é‡Œå·²æœ‰ä»‹ç»ï¼Œæˆ‘ä»¬å°†æ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–è¿‡ç¨‹æ¯”å–»æˆå°çƒæ»šè½å±±å¡çš„è¿‡ç¨‹ã€‚ä½†æ˜¯æ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–è¿‡ç¨‹å¿½ç•¥äº†å°çƒæœ¬èº«å…·æœ‰åŠ¨é‡ï¼Œä¸ç°å®ä¸­æœ‰ä¸€å®šåŒºåˆ«ã€‚å¦‚æœæˆ‘ä»¬å°†æ¢¯åº¦ä¸‹é™ç®—æ³•æ·»åŠ ä¸ŠåŠ¨é‡çš„æ¨¡æ‹Ÿï¼Œåˆ™å°çƒåœ¨é™·å…¥å±€éƒ¨æœ€ä¼˜è§£æ—¶ï¼Œè¶³å¤Ÿé«˜çš„åŠ¨é‡èƒ½å¸®åŠ©å°çƒâ€œå†²â€å‡ºå±€éƒ¨æœ€ä¼˜è§£ã€‚</p><p><img src="/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/åŠ¨é‡æ³•æ¨¡æ‹Ÿ.png" alt></p><p>ä½¿ç”¨åŠ¨é‡æ³•çš„ä¼˜åŒ–ç®—æ³•æœ‰Adamç­‰ã€‚å®é™…ä¸Šï¼ŒAdamæ˜¯Adagradå’ŒMomentumåŠ¨é‡æ³•çš„ç»“åˆã€‚</p><p>æ­¤å¤–ï¼Œä»ç»éªŒä¸Šçœ‹ï¼Œå­¦ä¹ ç‡ä¸€å¼€å§‹è¦ä¿æŒå¤§ä¸€äº›ï¼Œæ¥ä¿è¯æ”¶æ•›åˆ°æœ€ä¼˜ç‚¹é™„è¿‘ï¼›ç„¶åè¦å‡å°å­¦ä¹ ç‡æ¥é¿å…éœ‡è¡ã€‚é‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶å¯ä»¥æƒ³åˆ°ï¼Œå­¦ä¹ ç‡è·Ÿéšè®­ç»ƒè½®æ¬¡å˜å¤§é€æ¸å˜å°ã€‚è¿™å°±æ˜¯<strong>å­¦ä¹ ç‡è¡°å‡</strong>ã€‚</p><p>åœ¨åˆšå¼€å§‹è®­ç»ƒæ—¶ï¼Œç”±äºå‚æ•°æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œæ¢¯åº¦ä¹Ÿå¾€å¾€æ¯”è¾ƒå¤§ï¼Œå†åŠ ä¸Šæ¯”è¾ƒå¤§çš„åˆå§‹å­¦ä¹ ç‡ï¼Œä¼šä½¿å¾—è®­ç»ƒä¸ç¨³å®šã€‚å› æ­¤æˆ‘ä»¬å¸Œæœ›åˆšå¼€å§‹å‡ è½®è¿­ä»£çš„å­¦ä¹ ç‡è¾ƒå°ï¼Œç­‰æ¢¯åº¦ä¸‹é™åˆ°ä¸€å®šç¨‹åº¦æ—¶å†æ¢å¤å­¦ä¹ ç‡ã€‚è¿™ç§æ–¹æ³•ç§°ä¹‹ä¸º<strong>å­¦ä¹ ç‡é¢„çƒ­</strong>ã€‚ç­‰é¢„çƒ­å®Œæ¯•ååœ¨è¿›è¡Œå­¦ä¹ ç‡è¡°å‡ã€‚</p><p>åˆ©ç”¨è¿™ä¸¤ä¸ªæ€æƒ³ï¼Œæ”¹è¿›Adamåï¼Œå°±æ˜¯ä¼˜åŒ–ç®—æ³•RAdamã€‚</p><h2 id="4-æŸå¤±å‡½æ•°ä¹Ÿä¼šæœ‰å½±å“"><a href="#4-æŸå¤±å‡½æ•°ä¹Ÿä¼šæœ‰å½±å“" class="headerlink" title="4. æŸå¤±å‡½æ•°ä¹Ÿä¼šæœ‰å½±å“"></a>4. æŸå¤±å‡½æ•°ä¹Ÿä¼šæœ‰å½±å“</h2><p>åˆ†ç±»é—®é¢˜çš„æŸå¤±å‡½æ•°å¯ä»¥é€‰æ‹©MSEå’ŒCross-entropyã€‚ç°åœ¨æˆ‘ä»¬æ›´å¤šé€‰æ‹©äº¤å‰ç†µã€‚ä¸ºä»€ä¹ˆMSEä¸è¡Œå‘¢ï¼Ÿ</p><p>MSEåœ¨losså¤§çš„åœ°æ–¹éå¸¸å¹³å¦ï¼Œæ¢¯åº¦è¶‹è¿‘äºé›¶ï¼Œæœ€åstuckå¡ä½ï¼éš¾ä»¥ä¼˜åŒ–ã€‚</p><p>Cross-entropy ï¼šå·¦ä¸Šè§’æœ‰æ–œç‡ï¼Œå¯ä»¥é€è¿‡æ¢¯åº¦ï¼Œä¸€è·¯å¾€å³ä¸‹è§’èµ°ã€‚æ›´æ˜“æ”¶æ•›ã€‚</p><p><img src="/2022/10/19/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%85ML-Note4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96/MSEå’ŒCross-entropy.png" alt></p><h2 id="5-ä¹Ÿè®¸éœ€è¦-normalization"><a href="#5-ä¹Ÿè®¸éœ€è¦-normalization" class="headerlink" title="5. ä¹Ÿè®¸éœ€è¦ normalization"></a>5. ä¹Ÿè®¸éœ€è¦ normalization</h2><p>ä¸€èˆ¬è€Œè¨€ï¼Œæ ·æœ¬ç‰¹å¾ç”±äºæ¥æºä»¥åŠåº¦é‡å•ä½ä¸åŒï¼Œä»–ä»¬çš„å°ºåº¦ (Scale) å³å–å€¼èŒƒå›´ä¹Ÿä¸åŒã€‚å¯¹äºæŸäº›æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä¼šå¯¹é‚£äº›å°ºåº¦æ›´å¤§çš„æ•°æ®æ›´æ•æ„Ÿã€‚å› æ­¤å¯¹äºå°ºåº¦æ•æ„Ÿçš„æ¨¡å‹ï¼Œå¿…é¡»å…ˆå¯¹æ ·æœ¬è¿›è¡Œé¢„å¤„ç†ï¼Œå°†å„ä¸ªç»´åº¦çš„ç‰¹å¾è½¬æ¢åˆ°ç›¸åŒçš„å–å€¼åŒºé—´å†…ï¼Œå¹¶ä¸”æ¶ˆé™¤ä¸åŒç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œæ‰èƒ½å–å¾—ç†æƒ³çš„æ•ˆæœã€‚</p><p>å½’ä¸€åŒ– (Normalization) æ–¹æ³•æ³›æŒ‡æŠŠæ•°æ®ç‰¹å¾è½¬æ¢ä¸ºç›¸åŒå°ºåº¦çš„æ–¹æ³•ï¼Œæ¯”å¦‚æŠŠæ•°æ®ç‰¹å¾æ˜ å°„åˆ° [0,1] åŒºé—´å†…ï¼Œæˆ–è€…ç›´æ¥æ˜ å°„ä¸ºå‡å€¼ä¸º0ã€æ–¹å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒã€‚</p><p><strong>æœ€å°æœ€å¤§å€¼å½’ä¸€åŒ–</strong>ï¼šå°†æ¯ä¸ªç‰¹å¾ç¼©æ”¾åˆ° [0,1] æˆ–è€… [-1,1] ä¹‹é—´ã€‚å‡è®¾æˆ‘ä»¬æœ‰ N å“¥æ ·æœ¬ ${x^{(n)}}^{N}_{n=1}$ï¼Œå¯¹æ¯ä¸€ç»´ç‰¹å¾xï¼Œå½’ä¸€åŒ–åçš„ç‰¹å¾ä¸ºï¼š</p><script type="math/tex; mode=display">\hat{x}^{(n)}=\frac{x^{(n)}-\min_n(x^{(n)})}{\max_n(x^{(n)})-\min_n(x^{(n)})}</script><p><strong>æ ‡å‡†åŒ–</strong>ï¼šå°†æ¯ç»´ç‰¹å¾éƒ½è°ƒæ•´åˆ°æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼š</p><script type="math/tex; mode=display">\hat{x}^{(n)}=\frac{x^{(n)}-\mu}{\sigma}</script><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰Batch-Normalizationå’ŒLayer-Normalizationçš„ç®—æ³•ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šæ·±åº¦å­¦ä¹ ç®—æ³•çš„ä¼˜åŒ–ã€‚&lt;br&gt;&lt;!--more---&gt;&lt;/p&gt;
&lt;p&gt;ç¥ç»ç½‘ç»œè®­ç»ƒä¸å¥½æ€ä¹ˆåŠï¼Ÿä¸ºä»€ä¹ˆlossä¸ä¸‹é™ï¼Ÿè¿™é‡Œè®¨è®ºçš„è®­ç»ƒä¸å¥½ï¼Œæ˜¯æŒ‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„losså§‹ç»ˆé™ä¸ä¸‹æ¥ã€‚ä»æ•°å­¦ä¼˜åŒ–çš„è§’åº¦ï¼Œæ­¤æ—¶å¯èƒ½é™·å…¥äº†å±€éƒ¨</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="MOOC" scheme="https://superlova.github.io/tags/MOOC/"/>
    
    <category term="Deep Learning" scheme="https://superlova.github.io/tags/Deep-Learning/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æå®æ¯…2019ML-Note3-æ·±åº¦å­¦ä¹ ä»‹ç»å’Œåå‘ä¼ æ’­</title>
    <link href="https://superlova.github.io/2022/10/16/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/"/>
    <id>https://superlova.github.io/2022/10/16/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/</id>
    <published>2022-10-16T10:32:13.000Z</published>
    <updated>2022-10-16T13:56:17.399Z</updated>
    
    <content type="html"><![CDATA[<p>æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šæ·±åº¦å­¦ä¹ ç®—æ³•ä»‹ç»ã€åå‘ä¼ æ’­æœºåˆ¶ã€‚<br><!--more---></p><h1 id="æ·±åº¦å­¦ä¹ "><a href="#æ·±åº¦å­¦ä¹ " class="headerlink" title="æ·±åº¦å­¦ä¹ "></a>æ·±åº¦å­¦ä¹ </h1><p>æ·±åº¦å­¦ä¹ å¤§å®¶å·²ç»å¾ˆç†Ÿæ‚‰äº†ã€‚æ·±åº¦å­¦ä¹ æŠ€æœ¯å±äºä¸€ç±»æœºå™¨å­¦ä¹ æŠ€æœ¯ã€‚ä½¿ç”¨æ·±åº¦å­¦ä¹ è§£å†³é—®é¢˜çš„è¿‡ç¨‹åŒæ ·éœ€è¦ä¸‰æ­¥éª¤ï¼š</p><p>Step1ï¼šé€‰æ‹©æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼šç¥ç»ç½‘ç»œï¼ˆNeural networkï¼‰ï¼Œç¥ç»ç½‘ç»œæœ‰å„ç§ä¸åŒç±»å‹ï¼Œæ¯”å¦‚å‰é¦ˆç¥ç»ç½‘ç»œã€å·ç§¯ç¥ç»ç½‘ç»œç­‰ï¼›<br>Step2ï¼šæ¨¡å‹è¯„ä¼°ï¼ˆGoodness of functionï¼‰ï¼›<br>Step3ï¼šé€‰æ‹©æœ€ä¼˜å‡½æ•°ï¼ˆPick best functionï¼‰ï¼Œä¸åŒçš„ç½‘ç»œç»“æ„éœ€è¦å®šä¹‰ä¸åŒçš„å‚æ•°å­¦ä¹ æ–¹æ³•ï¼Œæ¯”å¦‚åå‘ä¼ æ’­ç®—æ³•ï¼›</p><p>æ¥ä¸‹æ¥é€ä¸€ä»‹ç»ä¸‰ä¸ªæ­¥éª¤çš„å…·ä½“å†…å®¹ã€‚</p><h2 id="ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©ç¥ç»ç½‘ç»œï¼šä»å‰é¦ˆç½‘ç»œå¼€å§‹"><a href="#ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©ç¥ç»ç½‘ç»œï¼šä»å‰é¦ˆç½‘ç»œå¼€å§‹" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©ç¥ç»ç½‘ç»œï¼šä»å‰é¦ˆç½‘ç»œå¼€å§‹"></a>ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©ç¥ç»ç½‘ç»œï¼šä»å‰é¦ˆç½‘ç»œå¼€å§‹</h2><p>å‰é¦ˆï¼ˆfeedforwardï¼‰ä¹Ÿå¯ä»¥ç§°ä¸ºå‰å‘ï¼Œä»ä¿¡å·æµå‘æ¥ç†è§£å°±æ˜¯è¾“å…¥ä¿¡å·è¿›å…¥ç½‘ç»œåï¼Œä¿¡å·æµåŠ¨æ˜¯å•å‘çš„ï¼Œå³ä¿¡å·ä»å‰ä¸€å±‚æµå‘åä¸€å±‚ï¼Œä¸€ç›´åˆ°è¾“å‡ºå±‚ï¼Œå…¶ä¸­ä»»æ„ä¸¤å±‚ä¹‹é—´çš„è¿æ¥å¹¶æ²¡æœ‰åé¦ˆï¼ˆfeedbackï¼‰ï¼Œäº¦å³ä¿¡å·æ²¡æœ‰ä»åä¸€å±‚åˆè¿”å›åˆ°å‰ä¸€å±‚ã€‚</p><p>ä¸‹å›¾æ˜¯ä¸€ä¸ªç”±ä¸€å±‚è¾“å…¥å±‚ã€Nå±‚éšè—å±‚å’Œä¸€å±‚è¾“å‡ºå±‚æ„æˆçš„ã€æ¯å±‚åŒ…å«Mä¸ªç¥ç»å…ƒçš„å…¨è¿æ¥ç½‘ç»œï¼Œç¥ç»å…ƒçš„æ¿€æ´»å‡½æ•°ä¸ºsigmoidï¼š</p><p><img src="/2022/10/16/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/å‰é¦ˆç½‘ç»œ.png" alt></p><p>ä¸ºä»€ä¹ˆå«å…¨é“¾æ¥å‘¢ï¼Ÿå› ä¸ºlayer1ä¸layer2ä¹‹é—´ä¸¤ä¸¤éƒ½æœ‰è¿æ¥ï¼Œæ‰€ä»¥å«åšFully Connectï¼›</p><p>ä¸ºä»€ä¹ˆå«å‰é¦ˆå‘¢ï¼Ÿå› ä¸ºç°åœ¨ä¼ é€’çš„æ–¹å‘æ˜¯ç”±åå¾€å‰ä¼ ï¼Œæ‰€ä»¥å«åšFeedforwardã€‚</p><p>å½“éšè—å±‚Néå¸¸å¤§æ—¶ï¼Œæˆ‘ä»¬å°±è¯´è¿™ä¸ªç½‘ç»œéå¸¸æ·±ã€‚ç°å¦‚ä»Šçš„ç½‘ç»œç»“æ„åŠ¨è¾„å‡ ç™¾å±‚ï¼Œéšä¹‹å¸¦æ¥å¾ˆå¤§çš„è®¡ç®—å¼€é”€ã€‚ä¸€ä¸ªä¸€ä¸ªè®¡ç®—ç¥ç»å…ƒçš„è¾“å…¥è¾“å‡ºæ˜¯ä¸ç°å®çš„ï¼Œä¸€ç§åŠ é€Ÿæ–¹æ³•æ˜¯å°†ç¥ç»ç½‘ç»œçš„ä¿¡æ¯ä¼ é€’è¿‡ç¨‹å…·è±¡åŒ–ä¸ºçŸ©é˜µè¿ç®—ã€‚</p><p>å‡è®¾ä¸‹å›¾çš„å‰é¦ˆç½‘ç»œï¼š</p><p><img src="/2022/10/16/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/å‰é¦ˆç½‘ç»œ-çŸ©é˜µè®¡ç®—æ¼”ç¤º.png" alt></p><p>è®¡ç®—æ–¹æ³•å°±æ˜¯ï¼šsigmoidï¼ˆæƒé‡wã€é»„è‰²ã€‘ * è¾“å…¥ã€è“è‰²ã€‘+ åç§»é‡bã€ç»¿è‰²ã€‘ï¼‰= è¾“å‡º</p><p>å¦‚æœæœ‰å¾ˆå¤šå±‚ï¼Œå°±è¿›è¡ŒåµŒå¥—</p><p><img src="/2022/10/16/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/å¾ˆå¤šå±‚çš„å…¨è¿æ¥ç½‘ç»œçš„çŸ©é˜µè®¡ç®—.png" alt></p><p>æ‰€ä»¥æ•´ä¸ªç¥ç»ç½‘ç»œè¿ç®—å°±ç›¸å½“äºä¸€è¿ä¸²çš„çŸ©é˜µè¿ç®—ã€‚çŸ©é˜µè¿ç®—æ˜¯å¯ä»¥è¢«GPUå¹¶è¡ŒåŠ é€Ÿçš„ï¼Œå› æ­¤æ·±åº¦å­¦ä¹ æ¨¡å‹æ‰èƒ½å¤Ÿåœ¨å¦‚ä»Šè¿™ä¸ªç®—åŠ›å¤§çˆ†å‘çš„å¹´ä»£å¤§æ”¾å¼‚å½©ã€‚</p><p><strong>æ·±åº¦å­¦ä¹ çš„æœ¬è´¨æ˜¯åˆ©ç”¨éšè—å±‚å­¦ä¹ åˆ°äº†è¾“å…¥ç‰¹å¾çš„æœ‰æ•ˆè¡¨ç¤ºæ–¹æ³•ï¼Œä»£æ›¿äº†ä¹‹å‰ä¾é æ•°æ®ç§‘å­¦å®¶çš„ç»éªŒçš„ç‰¹å¾å·¥ç¨‹ã€‚</strong></p><h2 id="ç¬¬äºŒæ­¥ï¼šæ¨¡å‹è¯„ä¼°æ–¹æ³•ï¼šé€‰æ‹©æŸå¤±å‡½æ•°"><a href="#ç¬¬äºŒæ­¥ï¼šæ¨¡å‹è¯„ä¼°æ–¹æ³•ï¼šé€‰æ‹©æŸå¤±å‡½æ•°" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šæ¨¡å‹è¯„ä¼°æ–¹æ³•ï¼šé€‰æ‹©æŸå¤±å‡½æ•°"></a>ç¬¬äºŒæ­¥ï¼šæ¨¡å‹è¯„ä¼°æ–¹æ³•ï¼šé€‰æ‹©æŸå¤±å‡½æ•°</h2><p>å¯¹äºæ¨¡å‹çš„è¯„ä¼°ï¼Œæˆ‘ä»¬ä¸€èˆ¬é‡‡ç”¨æŸå¤±å‡½æ•°æ¥ååº”æ¨¡å‹çš„å¥½å·®ï¼Œæ‰€ä»¥å¯¹äºç¥ç»ç½‘ç»œæ¥è¯´ï¼Œæˆ‘ä»¬é‡‡ç”¨äº¤å‰ç†µï¼ˆcross entropyï¼‰å‡½æ•°æ¥å¯¹$y$å’Œ$\hat{y}$çš„æŸå¤±è¿›è¡Œè®¡ç®—ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ˜¯è°ƒæ•´å‚æ•°ï¼Œè®©äº¤å‰ç†µè¶Šå°è¶Šå¥½ã€‚</p><h2 id="ç¬¬ä¸‰æ­¥ï¼šé€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼šæ¢¯åº¦ä¸‹é™ï¼Œä»¥åŠç”¨åå‘ä¼ æ’­ç®—æ³•ä¼˜åŒ–è®¡ç®—"><a href="#ç¬¬ä¸‰æ­¥ï¼šé€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼šæ¢¯åº¦ä¸‹é™ï¼Œä»¥åŠç”¨åå‘ä¼ æ’­ç®—æ³•ä¼˜åŒ–è®¡ç®—" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šé€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼šæ¢¯åº¦ä¸‹é™ï¼Œä»¥åŠç”¨åå‘ä¼ æ’­ç®—æ³•ä¼˜åŒ–è®¡ç®—"></a>ç¬¬ä¸‰æ­¥ï¼šé€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼šæ¢¯åº¦ä¸‹é™ï¼Œä»¥åŠç”¨åå‘ä¼ æ’­ç®—æ³•ä¼˜åŒ–è®¡ç®—</h2><p>æ¢¯åº¦ä¸‹é™ç®—æ³•åœ¨ä¹‹å‰çš„ç¬”è®°å·²ç»è®²è¿‡ï¼Œç¥ç»ç½‘ç»œçš„æ¢¯åº¦ä¸‹é™ç®—æ³•ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p><p><img src="/2022/10/16/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/æ¢¯åº¦ä¸‹é™.png" alt></p><p>æ¢¯åº¦ä¸‹é™çš„å…·ä½“è¿‡ç¨‹ï¼š</p><p><img src="/2022/10/16/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML-Note3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/æ¢¯åº¦ä¸‹é™çš„è¿‡ç¨‹.png" alt></p><ol><li>ç»™åˆ°$\theta$(weight and bias)</li><li>å…ˆé€‰æ‹©ä¸€ä¸ªåˆå§‹çš„ $\theta^0$ï¼Œè®¡ç®— $\theta^0$ çš„æŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰è®¾ä¸€ä¸ªå‚æ•°çš„åå¾®åˆ†</li><li>è®¡ç®—å®Œè¿™ä¸ªå‘é‡ï¼ˆvectorï¼‰åå¾®åˆ†ï¼Œç„¶åå°±å¯ä»¥å»æ›´æ–°çš„ä½  $\theta$</li><li>ç™¾ä¸‡çº§åˆ«çš„å‚æ•°ï¼ˆmillions of parametersï¼‰</li><li>åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ•ˆç‡çš„ç®—æ³•ï¼Œè®©ä½ è®¡ç®—æ¢¯åº¦ï¼ˆGradientï¼‰ çš„å‘é‡ï¼ˆVectorï¼‰æ—¶ï¼Œå¯ä»¥æœ‰æ•ˆç‡çš„è®¡ç®—å‡ºæ¥</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šæ·±åº¦å­¦ä¹ ç®—æ³•ä»‹ç»ã€åå‘ä¼ æ’­æœºåˆ¶ã€‚&lt;br&gt;&lt;!--more---&gt;&lt;/p&gt;
&lt;h1 id=&quot;æ·±åº¦å­¦ä¹ &quot;&gt;&lt;a href=&quot;#æ·±åº¦å­¦ä¹ &quot; class=&quot;headerlink&quot; title=&quot;æ·±åº¦å­¦ä¹ &quot;&gt;&lt;/a&gt;æ·±åº¦</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="MOOC" scheme="https://superlova.github.io/tags/MOOC/"/>
    
    <category term="Backpropagation" scheme="https://superlova.github.io/tags/Backpropagation/"/>
    
    <category term="Deep Learning" scheme="https://superlova.github.io/tags/Deep-Learning/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æå®æ¯…2019MLè¯¾ç¨‹-Note2</title>
    <link href="https://superlova.github.io/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/"/>
    <id>https://superlova.github.io/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/</id>
    <published>2022-10-13T02:52:43.000Z</published>
    <updated>2022-10-15T02:44:09.974Z</updated>
    
    <content type="html"><![CDATA[<p>æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šåå·®å’Œæ–¹å·®ã€æ¨¡å‹é€‰æ‹©ã€æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚<br><!--more---></p><h1 id="ä¸€ã€è¯¯å·®çš„æ¥æºï¼šåå·®ä¸æ–¹å·®"><a href="#ä¸€ã€è¯¯å·®çš„æ¥æºï¼šåå·®ä¸æ–¹å·®" class="headerlink" title="ä¸€ã€è¯¯å·®çš„æ¥æºï¼šåå·®ä¸æ–¹å·®"></a>ä¸€ã€è¯¯å·®çš„æ¥æºï¼šåå·®ä¸æ–¹å·®</h1><p>å¯¹å­¦ä¹ ç®—æ³•é™¤äº†é€šè¿‡å®éªŒä¼°è®¡å…¶æ³›åŒ–æ€§èƒ½ï¼Œäººä»¬å¾€å¾€è¿˜å¸Œæœ›èƒ½äº†è§£ä¸ºä»€ä¹ˆå…·æœ‰è¿™æ ·çš„æ€§èƒ½ã€‚è¯¯å·®æ¥æºäºåå·® (bias) å’Œæ–¹å·® (Variance)ä»¥åŠä¸å¯é¿å…çš„å™ªå£°ã€‚</p><h2 id="1-åå·®å’Œæ–¹å·®çš„æ¦‚å¿µå’Œæ¥æº"><a href="#1-åå·®å’Œæ–¹å·®çš„æ¦‚å¿µå’Œæ¥æº" class="headerlink" title="1. åå·®å’Œæ–¹å·®çš„æ¦‚å¿µå’Œæ¥æº"></a>1. åå·®å’Œæ–¹å·®çš„æ¦‚å¿µå’Œæ¥æº</h2><p><strong>åå·®</strong>åº¦é‡äº†é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„åç¦»ç¨‹åº¦ï¼Œå¯¹åº”çš„æ˜¯å­¦ä¹ ç®—æ³•æœ¬èº«çš„æ‹Ÿåˆèƒ½åŠ›ï¼›<strong>æ–¹å·®</strong>åº¦é‡äº†æ•°æ®æ‰°åŠ¨å¯¹æ¨¡å‹çš„å½±å“ï¼Œå¯¹åº”çš„æ˜¯æ¨¡å‹çš„ç¨³å®šæ€§ï¼›<strong>å™ªå£°</strong>åˆ™æ˜¯å¯¹åº”é—®é¢˜å¯¹åº”çš„éš¾åº¦ã€‚</p><p>ä¸Šé¢çš„ç»“è®ºè¯´æ˜ï¼Œæ¨¡å‹çš„æ€§èƒ½æ˜¯ç”±æ¨¡å‹èƒ½åŠ›ã€æ•°æ®çš„å……åˆ†æ€§ä»¥åŠé—®é¢˜æœ¬èº«çš„éš¾åº¦å†³å®šçš„ã€‚ç”±äºå™ªéŸ³æ˜¯é—®é¢˜æœ¬èº«çš„ç‰¹æ€§ï¼Œä¸å¥½è§£å†³ï¼Œå› æ­¤è¦æƒ³æå‡æ¨¡å‹çš„æ€§èƒ½ï¼Œå°±éœ€è¦é‡‡å–æªæ–½é™ä½åå·®å’Œæ–¹å·®ã€‚</p><h2 id="4-åå·®å’Œæ–¹å·®åˆ†è§£ï¼šé‡æ–°è€ƒè™‘æ¬ æ‹Ÿåˆã€è¿‡æ‹Ÿåˆé—®é¢˜"><a href="#4-åå·®å’Œæ–¹å·®åˆ†è§£ï¼šé‡æ–°è€ƒè™‘æ¬ æ‹Ÿåˆã€è¿‡æ‹Ÿåˆé—®é¢˜" class="headerlink" title="4. åå·®å’Œæ–¹å·®åˆ†è§£ï¼šé‡æ–°è€ƒè™‘æ¬ æ‹Ÿåˆã€è¿‡æ‹Ÿåˆé—®é¢˜"></a>4. åå·®å’Œæ–¹å·®åˆ†è§£ï¼šé‡æ–°è€ƒè™‘æ¬ æ‹Ÿåˆã€è¿‡æ‹Ÿåˆé—®é¢˜</h2><p>ä¸ºäº†é¿å…è¿‡æ‹Ÿåˆï¼Œæˆ‘ä»¬ç»å¸¸ä¼šåœ¨æ¨¡å‹çš„æ‹Ÿåˆèƒ½åŠ›å’Œå¤æ‚åº¦ä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚æ‹Ÿåˆèƒ½åŠ›å¼ºçš„æ¨¡å‹ä¸€èˆ¬å¤æ‚åº¦ä¼šæ¯”è¾ƒé«˜ï¼Œå®¹æ˜“å¯¼è‡´è¿‡æ‹Ÿåˆã€‚ç›¸åï¼Œå¦‚æœé™åˆ¶æ¨¡å‹çš„å¤æ‚åº¦ï¼Œé™ä½å…¶æ‹Ÿåˆèƒ½åŠ›ï¼Œæœ‰å¯èƒ½å¯¼è‡´æ¬ æ‹Ÿåˆã€‚å› æ­¤ï¼Œå¦‚ä½•åœ¨æ¨¡å‹çš„æ‹Ÿåˆèƒ½åŠ›ä¸å¤æ‚åº¦ä¹‹é—´å–å¾—å¹³è¡¡ï¼Œå¯¹æœºå™¨å­¦ä¹ ç®—æ³•æ¥è¯´ååˆ†é‡è¦ã€‚</p><p>åå·®-æ–¹å·®åˆ†è§£ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„åˆ†æå·¥å…·ã€‚æ•°å­¦æ¨å¯¼è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œç»“è®ºä¸ºï¼š</p><p><strong>æœ€å°åŒ–æœŸæœ›é”™è¯¯ç­‰ä»·äºæœ€å°åŒ–åå·®å’Œæ–¹å·®ä¹‹å’Œã€‚</strong></p><p>ä¸‹å›¾ç»™å‡ºäº†æœºå™¨å­¦ä¹ æ¨¡å‹å››ç§åå·®å’Œæ–¹å·®çš„ç»„åˆæƒ…å†µã€‚</p><p><img src="/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/åå·®å’Œæ–¹å·®.png" alt></p><p>æ¯ä¸ªå›¾çš„ä¸­å¿ƒåº—ä¸ºæœ€ä¼˜æ¨¡å‹$f(x)$ï¼Œè“ç‚¹ä¸ºä¸åŒè®­ç»ƒé›†ä¸Šå¾—åˆ°çš„æ¨¡å‹$f^*(x)$ã€‚å·¦ä¸Šè§’çš„å›¾æ˜¯ä¸€ç§ç†æƒ³æƒ…å†µï¼Œæ–¹å·®å’Œåå·®éƒ½æ¯”è¾ƒä½ï¼›å³ä¸Šè§’ä¸ºé«˜åå·®ä½æ–¹å·®çš„æƒ…å†µï¼Œè¡¨ç¤ºæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å¾ˆå¥½ï¼Œä½†æ˜¯æ‹Ÿåˆèƒ½åŠ›ä¸è¶³ï¼Œç±»ä¼¼äºæˆ‘ä»¬ä¹‹å‰çš„çº¿æ€§æ¨¡å‹ï¼›å·¦ä¸‹è§’æ˜¯ä½åå·®é«˜æ–¹å·®çš„æƒ…å†µï¼Œè¡¨ç¤ºæ¨¡å‹çš„æ‹Ÿåˆèƒ½åŠ›å¾ˆå¥½ï¼Œä½†æ˜¯æ³›åŒ–èƒ½åŠ›è¾ƒå·®ã€‚å½“è®­ç»ƒæ•°æ®æ¯”è¾ƒå°‘çš„æ—¶å€™å¾€å¾€ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä¸€èˆ¬æŠŠä»–ç§°ä¹‹ä¸ºè¿‡æ‹Ÿåˆï¼›å³ä¸‹è§’ä¸ºé«˜åå·®é«˜æ–¹å·®çš„æƒ…å†µï¼Œæ˜¯æœ€å·®çš„æƒ…å†µï¼Œç­‰äºæ²¡è®­ç»ƒã€‚</p><p>æ–¹å·®ä¸€èˆ¬ä¼šéšç€è®­ç»ƒæ ·æœ¬çš„å¢åŠ è€Œå‡å°ã€‚å½“æ ·æœ¬æ¯”è¾ƒå¤šï¼Œæ–¹å·®æ¯”è¾ƒå°ï¼Œè¿™æ˜¯å¯ä»¥é€‰æ‹©èƒ½åŠ›å¼ºçš„æ¨¡å‹æ¥å‡å°‘åå·®ï¼›å½“è®­ç»ƒé›†æ¯”è¾ƒæœ‰é™æ—¶ï¼Œæœ€ä¼˜çš„åå·®å’Œæ–¹å·®å¾€å¾€æ— æ³•å…¼é¡¾ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œåå·®-æ–¹å·®çª˜å¢ƒâ€ã€‚</p><p><img src="/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/åå·®æ–¹å·®çª˜å¢ƒ.png" alt></p><p>åå·®-æ–¹å·®çª˜å¢ƒè¯´çš„æ˜¯ï¼Œæ¨¡å‹å¤æ‚åº¦å¢åŠ åï¼Œè™½ç„¶ä½ å’Œèƒ½åŠ›å˜å¼ºå¯¼è‡´åå·®å‡å°‘ï¼Œä½†æ˜¯æ–¹å·®ä¼šå¢å¤§ï¼Œè¿‡æ‹Ÿåˆç°è±¡ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚</p><p>åå·®-æ–¹å·®åˆ†è§£ç»™æœºå™¨å­¦ä¹ æ¨¡å‹æä¾›äº†ä¸€ç§åˆ†æé€”å¾„ï¼Œèƒ½å¤ŸæŒ‡å¯¼æˆ‘ä»¬è§£å†³è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆçš„é—®é¢˜ï¼Œä½†æ˜¯å®é™…æ“ä½œä¸­å¾ˆéš¾ç›´æ¥è¡¡é‡ã€‚ä¸‹é¢æ˜¯ä¸€äº›é€šç”¨çš„æ–¹æ³•ã€‚</p><pre><code>æ¬ æ‹Ÿåˆç°è±¡ï¼šæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„é”™è¯¯ç‡å¾ˆé«˜ï¼Œæ­¤æ—¶è¯´æ˜æ¨¡å‹åå·®è¾ƒå¤§ã€‚æ¬ æ‹Ÿåˆè§£å†³ï¼š1. å¢åŠ æ•°æ®ç‰¹å¾2. æé«˜æ¨¡å‹å¤æ‚åº¦3. å‡å°æ­£åˆ™åŒ–ç³»æ•°</code></pre><pre><code>è¿‡æ‹Ÿåˆç°è±¡ï¼šæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„é”™è¯¯ç‡è¾ƒä½ï¼Œä½†æ˜¯åœ¨æµ‹è¯•é›†ä¸Šè¾ƒé«˜ï¼Œæ­¤æ—¶è¯´æ˜æ¨¡å‹æ–¹å·®è¾ƒå¤§ã€‚è¿‡æ‹Ÿåˆè§£å†³ï¼š1. é™ä½æ¨¡å‹å¤æ‚åº¦ï¼›2. åŠ å¤§æ­£åˆ™åŒ–ç³»æ•°ï¼›3. å¼•å…¥å…ˆéªŒçŸ¥è¯†ï¼Œæ¯”å¦‚æ•°æ®æ¸…æ´—ï¼Œå‰”é™¤æ— ç”¨ç‰¹å¾ç­‰ï¼›4. ä½¿ç”¨æ›´å¤šæ•°æ®è¿›è¡Œè®­ç»ƒï¼Œä½†è¿™ä¸ªå¾€å¾€æˆæœ¬æœ€é«˜ã€‚</code></pre><p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ç§é™ä½æ–¹å·®çš„æ–¹æ³•ï¼šé›†æˆæ¨¡å‹ï¼Œå³é€šè¿‡å¤šä¸ªé«˜æ–¹å·®æ¨¡å‹è¿›è¡Œå¹³å‡ï¼Œæ¥é™ä½æ–¹å·®ã€‚è¿™èƒŒåçš„åŸç†åœ¨ä»‹ç»é›†æˆå­¦ä¹ æ—¶ä¼šä»‹ç»ã€‚</p><h1 id="äºŒã€æ¨¡å‹é€‰æ‹©æ–¹æ³•"><a href="#äºŒã€æ¨¡å‹é€‰æ‹©æ–¹æ³•" class="headerlink" title="äºŒã€æ¨¡å‹é€‰æ‹©æ–¹æ³•"></a>äºŒã€æ¨¡å‹é€‰æ‹©æ–¹æ³•</h1><p>å‰é¢è®¨è®ºäº†æœºå™¨å­¦ä¹ çš„ä¸‰ä¸ªæ­¥éª¤ï¼Œä»¥åŠå¦‚ä½•æ”¹è¿›æ¨¡å‹çš„æ€§èƒ½ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ­£ç¡®è¯„ä¼°æ¨¡å‹å‘¢ï¼Ÿ</p><p>ä¹‹å‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠæ•°æ®é›†åˆ†æˆä¸¤éƒ¨åˆ†ï¼ŒTraining Setã€Test Setã€‚ä¸€èˆ¬æ¯”ä¾‹æ§åˆ¶åœ¨4:1å·¦å³ã€‚æˆ‘ä»¬åœ¨è®­ç»ƒç»“æŸåï¼Œä½¿ç”¨æµ‹è¯•é›†è¿›è¡Œè¯„ä¼°ï¼Œå¹¶åˆ¤æ–­è®­ç»ƒæ•ˆæœã€‚</p><p>è¿™æ ·åšå…¶å®å­˜åœ¨é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬çœŸçš„ä½¿ç”¨æµ‹è¯•é›†æ¥æŒ‡å¯¼æ¨¡å‹çš„é€‰æ‹©ã€å‚æ•°çš„æ”¹è¿›ç­‰å„ä¸ªæ­¥éª¤ï¼Œé‚£ç®—ä¸ç®—æ¨¡å‹æ­£åœ¨å­¦ä¹ æµ‹è¯•é›†çš„å†…å®¹å‘¢ï¼Ÿå°±å¥½åƒå­¦ç”Ÿåšå®Œè€ƒå·åï¼Œè€å¸ˆè™½ç„¶ä¸ä¼šç›´æ¥å‘Šè¯‰å­¦ç”Ÿæ­£ç¡®ç­”æ¡ˆï¼Œä½†æ˜¯ä¼šä¸æ–­åœ°ç»™å­¦ç”Ÿæœºä¼šï¼Œå‘Šè¯‰ä½ ï¼šä½ è¿™é‡Œé”™äº†ï¼Œé‚£é‡Œé”™äº†ã€‚è¿™ç®—ä¸ç®—æ˜¯å¦ä¸€ç§æ³„é¢˜å‘¢ï¼Ÿ</p><p>ä¸Šé¢çš„æ•°æ®æ³„éœ²ç°è±¡æ˜¯ç»å¸¸å‘ç”Ÿçš„ã€‚ä¸ºäº†é¿å…æ•°æ®æ³„éœ²ï¼Œä¸€èˆ¬å¯ä»¥é€šè¿‡æŠŠæ•°æ®åˆ†æˆä¸‰éƒ¨åˆ†ï¼šè®­ç»ƒé›† (Training Set)ã€éªŒè¯é›† (Validation Set) å’Œæµ‹è¯•é›† (Test Set)ã€‚æ¨¡å‹å‚æ•°çš„æ”¹è¿›ã€æ¨¡å‹é€‰æ‹©ç­‰è¿‡ç¨‹ï¼Œåªä½¿ç”¨éªŒè¯é›†ï¼›æœ€åè¯„ä¼°æ¨¡å‹æ—¶ä½¿ç”¨æµ‹è¯•é›†ã€‚</p><p>ä½†æ˜¯è¿™æ ·åˆä¼šå¸¦æ¥å¦ä¸€ä¸ªé—®é¢˜ï¼šæœ¬æ¥æ•°æ®å°±åŒ®ä¹ï¼Œåˆåˆ†å‰²å‡ºä¸¤å¤§éƒ¨åˆ†ä¸èƒ½ä½¿ç”¨ï¼Œå¯ä¾›å­¦ä¹ çš„æ•°æ®å°±æ›´å°‘äº†ã€‚<strong>kæŠ˜äº¤å‰éªŒè¯</strong>å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="2-1-äº¤å‰éªŒè¯"><a href="#2-1-äº¤å‰éªŒè¯" class="headerlink" title="2.1 äº¤å‰éªŒè¯"></a>2.1 äº¤å‰éªŒè¯</h2><p>äº¤å‰éªŒè¯ (Cross-Validation) æ˜¯ä¸€ç§è¯„ä¼°æ³›åŒ–æ€§èƒ½çš„ç»Ÿè®¡å­¦æ–¹æ³•ã€‚å®ƒæ¯”å•æ¬¡åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ–¹æ³•æ›´åŠ ç¨³å®šã€‚æœ€å¸¸ç”¨çš„äº¤å‰éªŒè¯æ–¹æ³•æ˜¯<strong>kæŠ˜äº¤å‰éªŒè¯</strong>ã€‚</p><p>é¦–å…ˆæŠŠæ•°æ®é›†åˆ†æˆå¤§è‡´ç›¸ç­‰çš„kä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸€éƒ¨åˆ†å«åšä¸€æŠ˜ï¼›æ¥ä¸‹æ¥è®­ç»ƒkä¸ªæ¨¡å‹ï¼Œç¬¬ä¸€ä¸ªæ¨¡å‹ä»¥ç¬¬1æŠ˜æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä»–ä½œä¸ºè®­ç»ƒé›†ï¼›ç¬¬äºŒä¸ªæ¨¡å‹ä»¥ç¬¬2æŠ˜æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä»–ä½œä¸ºè®­ç»ƒé›†â€¦â€¦æœ€åæˆ‘ä»¬å¾—åˆ°äº†kä¸ªæ¨¡å‹ï¼Œä»¥åŠå¯¹åº”çš„kä¸ªç²¾åº¦å€¼ã€‚æ¨¡å‹çš„æœ€ç»ˆç²¾åº¦å°±æ˜¯è¿™kä¸ªç²¾åº¦å€¼çš„å¹³å‡å€¼ã€‚</p><p><img src="/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/äº¤å‰éªŒè¯.png" alt></p><p>äº¤å‰éªŒè¯çš„ä¼˜ç‚¹ï¼š</p><ol><li>å¸®åŠ©æ›´å¥½è¯„ä¼°æ¨¡å‹çš„çœŸå®æ³›åŒ–æ€§èƒ½ï¼Œé˜²æ­¢æ•°æ®é›†åˆ†å‰²æ—¶çš„éšæœºæ€§å½±å“è¯„ä¼°å‡†ç¡®ç‡ï¼›</li><li>æ‰€æœ‰æ•°æ®éƒ½æœ‰æœºä¼šè¢«è®­ç»ƒï¼Œæé«˜æ•°æ®åˆ©ç”¨ç‡ï¼›</li></ol><p>äº¤å‰éªŒè¯çš„ç¼ºç‚¹ï¼š</p><ul><li>æ˜¾è‘—å¢åŠ äº†è®¡ç®—æˆæœ¬ï¼Œéœ€è¦è®­ç»ƒkä¸ªæ¨¡å‹ï¼Œæ˜¯åŸæ¥çš„kå€ã€‚</li></ul><h1 id="ä¸‰ã€æ¢¯åº¦ä¸‹é™ç®—æ³•è¯¦è§£ï¼Œä»¥åŠä¼˜åŒ–æ–¹æ³•"><a href="#ä¸‰ã€æ¢¯åº¦ä¸‹é™ç®—æ³•è¯¦è§£ï¼Œä»¥åŠä¼˜åŒ–æ–¹æ³•" class="headerlink" title="ä¸‰ã€æ¢¯åº¦ä¸‹é™ç®—æ³•è¯¦è§£ï¼Œä»¥åŠä¼˜åŒ–æ–¹æ³•"></a>ä¸‰ã€æ¢¯åº¦ä¸‹é™ç®—æ³•è¯¦è§£ï¼Œä»¥åŠä¼˜åŒ–æ–¹æ³•</h1><p>ç›®å‰ï¼Œæœºå™¨å­¦ä¹ ä¸­å‚æ•°å­¦ä¹ çš„ä¸»è¦æ–¹å¼æ˜¯é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ¥å¯»æ‰¾ä¸€ç»„æœ€å°åŒ–æŸå¤±å‡½æ•°çš„å‚æ•°ã€‚å†å…·ä½“è§†çº¿ä¸­ï¼Œæ¢¯åº¦ä¸‹é™æ³•å¯ä»¥åˆ†ä¸ºï¼šæ‰¹é‡æ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™ä»¥åŠå°æ‰¹é‡æ¢¯åº¦ä¸‹é™ä¸‰ç§å½¢å¼ã€‚</p><p>æœ¬èŠ‚è¿˜ä¼šä»‹ç»ä¸€äº›æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å˜ç§ï¼Œä»–ä»¬å¤§å¤šæ”¹å–„äº†ä»¥ä¸‹ä¸¤éƒ¨åˆ†çš„å†…å®¹ï¼š1) è°ƒæ•´å­¦ä¹ ç‡ï¼Œä½¿ä¼˜åŒ–æ›´ç¨³å®šï¼›2) æ¢¯åº¦ä¼°è®¡ä¿®æ­£ï¼Œæå‡è®­ç»ƒé€Ÿåº¦ã€‚</p><h2 id="3-1-æ¢¯åº¦ä¸‹é™ç®—æ³•çš„ç±»åˆ«"><a href="#3-1-æ¢¯åº¦ä¸‹é™ç®—æ³•çš„ç±»åˆ«" class="headerlink" title="3.1 æ¢¯åº¦ä¸‹é™ç®—æ³•çš„ç±»åˆ«"></a>3.1 æ¢¯åº¦ä¸‹é™ç®—æ³•çš„ç±»åˆ«</h2><h3 id="3-1-1-æ‰¹é‡æ¢¯åº¦ä¸‹é™"><a href="#3-1-1-æ‰¹é‡æ¢¯åº¦ä¸‹é™" class="headerlink" title="3.1.1 æ‰¹é‡æ¢¯åº¦ä¸‹é™"></a>3.1.1 æ‰¹é‡æ¢¯åº¦ä¸‹é™</h3><p>æœ€ä¼ ç»Ÿçš„æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œä¸Šç¯‡ç¬”è®°å·²ç»ä»‹ç»ã€‚</p><p>æ¢¯åº¦ä¸‹é™çš„å…·ä½“è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>é€‰æ‹©ä¸€ä¸ªåˆå§‹$\theta_0$</li><li>è®¡ç®—è¯¥ä½ç½®ä¸‹$\theta$å¯¹Lçš„å¾®åˆ†ï¼Œè¿™ä¸ªå¾®åˆ†å¯¹åº”å‡½æ•°åœ¨æ­¤å¤„ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼›</li><li>å°†$\theta_0$æœç€è¿™ä¸ªæ–¹å‘ç§»åŠ¨ä¸€å°æ­¥$ \eta$</li><li>åœ¨æ–°çš„ä½ç½®å¼€å§‹æ–°ä¸€è½®è¿­ä»£è®¡ç®—ï¼Œç›´åˆ°$w$ä¸å†å˜åŒ–ä¸ºæ­¢ã€‚</li></ol><p><img src="/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•.png" alt></p><p>å…¶ä¸­$\eta$å«åšå­¦ä¹ ç‡ï¼Œå®ƒæ§åˆ¶äº†æ¯æ¬¡æ¢¯åº¦ä¸‹é™è¿­ä»£çš„ä¼˜åŒ–å¹…åº¦ã€‚$\eta$è¶Šå¤§ï¼Œå­¦ä¹ å¾—è¶Šå¿«ã€‚ç„¶è€Œ$\eta$å¹¶ä¸æ˜¯è¶Šå¤§è¶Šå¥½ã€‚</p><p><img src="/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•çš„æ¢¯åº¦æ·±è°·.png" alt></p><p>å¦‚æœ$\eta$è¿‡å¤§ï¼Œä¼˜åŒ–è¿‡ç¨‹å¾ˆå¯èƒ½ä¼šè·¨è¶Šæœ€ä½ç‚¹ï¼Œä»è€Œæ°¸è¿œè¾¾ä¸åˆ°æœ€ä¼˜è§£ï¼›å¦‚æœ$\eta$è¿‡å°ï¼Œåˆ™ä¼šé€ æˆè®­ç»ƒç¼“æ…¢ï¼Œç”šè‡³é™·å…¥å±€éƒ¨æœ€ä¼˜è§£ã€‚å› æ­¤è°ƒæ•´å­¦ä¹ ç‡$\eta$æ˜¯ä¼˜åŒ–æ¢¯åº¦ä¸‹é™ç®—æ³•çš„ä¸€å¤§æ€è·¯ã€‚</p><p>æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå½“è®­ç»ƒæ•°æ®å¾ˆå¤§æ—¶ï¼ˆè¿™å¾ˆå¸¸è§ï¼‰ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´å»éå†æ•´ä¸ªè®­ç»ƒé›†ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¿…éå†æ‰€æœ‰è®­ç»ƒé›†ã€‚</p><h3 id="3-1-2-éšæœºæ¢¯åº¦ä¸‹é™"><a href="#3-1-2-éšæœºæ¢¯åº¦ä¸‹é™" class="headerlink" title="3.1.2 éšæœºæ¢¯åº¦ä¸‹é™"></a>3.1.2 éšæœºæ¢¯åº¦ä¸‹é™</h3><p>åœ¨è®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ï¼Œè®­ç»ƒæ•°æ®çš„è§„æ¨¡æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œæ‰¹é‡æ¢¯åº¦ä¸‹é™çš„æ¯æ¬¡æ¢¯åº¦è¿­ä»£éƒ½è¦éå†æ•´ä¸ªæ•°æ®é›†ï¼Œè¿™ä¼šé€ æˆè®¡ç®—èµ„æºçš„æµªè´¹ã€‚ä¸ºäº†è§£å†³æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•å¯¼è‡´çš„è®­ç»ƒç¼“æ…¢çš„é—®é¢˜ï¼Œéšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•åº”è¿è€Œç”Ÿã€‚å…¶æ€æƒ³æ˜¯é€šè¿‡éšæœºé€‰å–å°‘é‡è®­ç»ƒè¾“å…¥æ ·æœ¬æ¥è®¡ç®—$\nabla L_x$ï¼Œè¿›è€Œä¼°ç®—$\nabla L$ã€‚</p><p>æ›´å‡†ç¡®åœ°è¯´ï¼Œéšæœºæ¢¯åº¦ä¸‹é™é€šè¿‡éšæœºé€‰å–å°‘é‡çš„mä¸ªè®­ç»ƒæ•°æ®æ¥è®­ç»ƒã€‚ä¹Ÿå«åšå°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³• (Mini-Batch Gradient Descent)ã€‚</p><p>å‡è®¾æ ·æœ¬æ•°é‡mè¶³å¤Ÿå¤§ï¼Œæˆ‘ä»¬æœŸæœ›$\nabla L<em>{X_j}$çš„å¹³å‡å€¼å¤§è‡´ç›¸ç­‰äºæ•´ä¸ª$\nabla L</em>{x}$çš„å¹³å‡å€¼ï¼Œå³ï¼š</p><script type="math/tex; mode=display">\frac{\sum^m_{j-1}\nabla L_{X_j}}{m}\approx \frac{\sum_x \nabla L_x}{n}=\nabla L</script><p>è¿™é‡Œç¬¬äºŒä¸ªæ±‚å’Œç¬¦å·å®åœ¨æ•´ä¸ªè®­ç»ƒæ•°æ®ä¸Šè¿›è¡Œçš„ã€‚äº¤æ¢ä¸¤è¾¹æˆ‘ä»¬å¾—åˆ°ï¼š</p><script type="math/tex; mode=display">\nabla L \approx \frac{1}{m}\sum^m_{j=1}\nabla L_{X_j}</script><p>è¯å®äº†æˆ‘ä»¬å¯ä»¥è¿›é€šè¿‡è®¡ç®—éšæœºé€‰å–çš„å°æ‰¹é‡æ•°æ®çš„æ¢¯åº¦æ¥ä¼°ç®—æ•´ä½“çš„æ¢¯åº¦ã€‚</p><p>å½±å“å°æ‰¹é‡æ¢¯åº¦ä¸‹é™çš„ä¸»è¦å› ç´ æœ‰ï¼š1ï¼‰æ‰¹å¤§å°mï¼Œ2ï¼‰å­¦ä¹ ç‡$\eta$ï¼Œ3ï¼‰æ¢¯åº¦ä¼°è®¡æ–¹æ³•ã€‚</p><h2 id="3-2-æ‰¹é‡å¤§å°é€‰æ‹©"><a href="#3-2-æ‰¹é‡å¤§å°é€‰æ‹©" class="headerlink" title="3.2 æ‰¹é‡å¤§å°é€‰æ‹©"></a>3.2 æ‰¹é‡å¤§å°é€‰æ‹©</h2><p>ç›´è§‚æ¥è¯´ï¼Œæ‰¹åŒ…å«çš„æ•°æ®è¶Šå¤§ï¼Œæ–¹å·®ä¹Ÿå°±è¶Šå°ï¼Œè®­ç»ƒè¶Šç¨³å®šã€‚è¯¥ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªè¾ƒå¤§çš„å­¦ä¹ ç‡ã€‚å­¦ä¹ ç‡è¶Šå¤§ï¼Œéœ€è¦çš„æ‰¹å¤§å°å°±è¶Šå¤§ã€‚</p><p>å¦å¤–ï¼Œæ ¹æ®ç»éªŒï¼Œæ‰¹è¶Šå¤§è¶Šå¯èƒ½æ”¶æ•›åˆ°â€œå°–é”æœ€å°å€¼â€ï¼›æ‰¹è¶Šå°è¶Šèƒ½æ”¶æ•›åˆ°â€œå¹³å¦æœ€å°å€¼â€ã€‚</p><h2 id="3-3-å­¦ä¹ ç‡è°ƒæ•´"><a href="#3-3-å­¦ä¹ ç‡è°ƒæ•´" class="headerlink" title="3.3 å­¦ä¹ ç‡è°ƒæ•´"></a>3.3 å­¦ä¹ ç‡è°ƒæ•´</h2><p>å­¦ä¹ ç‡è¿‡å¤§ä¼šå¯¼è‡´æ¨¡å‹ä¸æ”¶æ•›ï¼Œå¦‚æœè¿‡å°ä¼šå¯¼è‡´æ”¶æ•›å¤ªæ…¢ã€‚ç”±æ­¤ï¼Œæœ‰ä¸€äº›å­¦è€…æ ¹æ®å­¦ä¹ çš„ä¸åŒé˜¶æ®µï¼Œåˆ¶å®šäº†å­¦ä¹ ç‡çš„ä¸åŒå˜åŒ–ç­–ç•¥ã€‚</p><p>ä»ç»éªŒä¸Šçœ‹ï¼Œå­¦ä¹ ç‡ä¸€å¼€å§‹è¦ä¿æŒå¤§ä¸€äº›ï¼Œæ¥ä¿è¯æ”¶æ•›åˆ°æœ€ä¼˜ç‚¹é™„è¿‘ï¼›ç„¶åè¦å‡å°å­¦ä¹ ç‡æ¥é¿å…éœ‡è¡ã€‚é‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶å¯ä»¥æƒ³åˆ°ï¼Œå­¦ä¹ ç‡è·Ÿéšè®­ç»ƒè½®æ¬¡å˜å¤§é€æ¸å˜å°ã€‚è¿™å°±æ˜¯<strong>å­¦ä¹ ç‡è¡°å‡</strong>ã€‚</p><p>åœ¨åˆšå¼€å§‹è®­ç»ƒæ—¶ï¼Œç”±äºå‚æ•°æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œæ¢¯åº¦ä¹Ÿå¾€å¾€æ¯”è¾ƒå¤§ï¼Œå†åŠ ä¸Šæ¯”è¾ƒå¤§çš„åˆå§‹å­¦ä¹ ç‡ï¼Œä¼šä½¿å¾—è®­ç»ƒä¸ç¨³å®šã€‚å› æ­¤æˆ‘ä»¬å¸Œæœ›åˆšå¼€å§‹å‡ è½®è¿­ä»£çš„å­¦ä¹ ç‡è¾ƒå°ï¼Œç­‰æ¢¯åº¦ä¸‹é™åˆ°ä¸€å®šç¨‹åº¦æ—¶å†æ¢å¤å­¦ä¹ ç‡ã€‚è¿™ç§æ–¹æ³•ç§°ä¹‹ä¸º<strong>å­¦ä¹ ç‡é¢„çƒ­</strong>ã€‚ç­‰é¢„çƒ­å®Œæ¯•ååœ¨è¿›è¡Œå­¦ä¹ ç‡è¡°å‡ã€‚</p><h3 id="3-3-3-AdaGrad-ç®—æ³•"><a href="#3-3-3-AdaGrad-ç®—æ³•" class="headerlink" title="3.3.3 AdaGrad ç®—æ³•"></a>3.3.3 AdaGrad ç®—æ³•</h3><p>AdaGradç®—æ³•çš„åšæ³•æ˜¯ï¼Œæ¯æ¬¡è¿­ä»£æ—¶ï¼Œæ¯ä¸ªå‚æ•°çš„å­¦ä¹ ç‡éƒ½æŠŠå®ƒé™¤ä¸Šä¹‹å‰å¾®åˆ†çš„å‡æ–¹æ ¹ã€‚</p><p>æ™®é€šçš„æ¢¯åº¦ä¸‹é™ç®—æ³•é‡‡ç”¨çš„å‚æ•°æ›´æ–°æ€è·¯ï¼š</p><script type="math/tex; mode=display">w^{t+1}\leftarrow w^t-\eta^tg^t \\\eta^t=\frac{\eta^t}{\sqrt{t + 1}}</script><p>åˆ™Adagradæ˜¯è¿™æ ·æ›´æ–°çš„ï¼š</p><script type="math/tex; mode=display">w^{t+1}\leftarrow w^t-\frac{\eta^t}{\sigma^t}g^t \\g^t =\frac{\partial L(\theta^t)}{\partial w}</script><p>å…¶ä¸­$\sigma^t$æ˜¯ä¹‹å‰å‚æ•°çš„æ‰€æœ‰å¾®åˆ†çš„å‡æ–¹æ ¹ï¼Œå¯¹äºæ¯ä¸ªå‚æ•°éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>å°†Adagradçš„å¼å­åŒ–ç®€ï¼š</p><p><img src="/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/åŒ–ç®€åçš„adagrad.png" alt></p><p>Adagradçš„è®¾è®¡æ€è·¯ä¸ºï¼Œå¦‚æœæŸä¸ªå‚æ•°çš„åå¯¼æ•°ç´¯è®¡æ¯”è¾ƒå¤§ï¼Œå…¶å­¦ä¹ ç‡å°±ä¼šç›¸å¯¹è¾ƒå°ï¼›ç›¸åï¼Œå¦‚æœåå¯¼æ•°ç´¯è®¡è¾ƒå°ï¼Œåˆ™å­¦ä¹ ç‡ç›¸å¯¹è¾ƒå¤§ã€‚ä½†æ˜¯æ•´ä½“ä¸Šè¿­ä»£æ¬¡æ•°è¶Šå¤šï¼Œå­¦ä¹ ç‡è¶Šå°ã€‚</p><p>AdaGradçš„ç¼ºç‚¹æ˜¯ï¼Œå¦‚æœåœ¨ç»è¿‡ä¸€å®šæ¬¡æ•°çš„è¿­ä»£ï¼Œä¾ç„¶æ²¡æœ‰æ‰¾åˆ°æœ€ä¼˜ç‚¹æ—¶ï¼Œç”±äºå­¦ä¹ ç‡å·²ç»éå¸¸å°ï¼Œå¾ˆéš¾å†ç»§ç»­ä¼˜åŒ–äº†ã€‚</p><h3 id="3-3-4-RMSprop-ç®—æ³•"><a href="#3-3-4-RMSprop-ç®—æ³•" class="headerlink" title="3.3.4 RMSprop ç®—æ³•"></a>3.3.4 RMSprop ç®—æ³•</h3><p>RMSPropç®—æ³•å¯ä»¥å¸®åŠ©è§£å†³æŸäº›æƒ…å†µä¸‹Adagradç®—æ³•è¿‡æ—©è¡°å‡çš„é—®é¢˜ã€‚</p><p>RMSPropç®—æ³•åœ¨AdaGradçš„åŸºç¡€ä¸Šï¼Œæ”¹è¿›äº†å‚æ•°åå¯¼æ•°çš„ç´¯è®¡æ–¹å¼ã€‚Adagradç®—æ³•æ˜¯è®¡ç®—æ¯ä¸ªå‚æ•°æ¢¯åº¦å¹³æ–¹çš„ç´¯è®¡å€¼ï¼š</p><script type="math/tex; mode=display">G_t=\sum^t_{\tau=1}\textbf{g}_{\tau}\odot\textbf{g}_{\tau}</script><p>å…¶ä¸­$\textbf{g}_{\tau}\in\mathbb{R}^{|\theta|}$æ˜¯ç¬¬$\tau$ æ¬¡è¿­ä»£æ—¶çš„æ¢¯åº¦ã€‚</p><p>RMSPropç®—æ³•é¦–å…ˆè®¡ç®—æ¯æ¬¡è¿­ä»£æ¢¯åº¦ $\textbf{g}_t$å¹³æ–¹çš„æŒ‡æ•°è¡°å‡ç§»åŠ¨å¹³å‡ï¼š</p><script type="math/tex; mode=display">G_t=\beta G_{t-1}+(1-\beta)\textbf{g}_t\odot\textbf{g}_t \\=(1-\beta)\sum^t_{\tau=1}\beta^{t-\tau}\textbf{g}_{\tau}\odot\textbf{g}_{\tau}</script><p>å…¶ä¸­$\beta$ä¸ºè¡°å‡ç‡ï¼Œä¸€èˆ¬ä¸º0.9ã€‚</p><p>RMSPropç®—æ³•çš„å‚æ•°æ›´æ–°å·®å€¼ä¸ºï¼š</p><script type="math/tex; mode=display">\Delta\theta_t=-\frac{\alpha}{\sqrt{G_t+\epsilon}}\odot\textbf{g}_t</script><p>å…¶ä¸­$\alpha$æ˜¯åˆå§‹çš„å­¦ä¹ ç‡ï¼Œæ¯”å¦‚0.001ã€‚</p><p>åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œç”±äºæ¯ä¸ªå‚æ•°çš„å­¦ä¹ ç‡å¹¶ä¸æ˜¯è¡°å‡è¶‹åŠ¿ï¼Œå› æ­¤æ—¢å¯ä»¥å˜å°ä¹Ÿå¯ä»¥å˜å¤§ã€‚</p><h2 id="3-4-æ¢¯åº¦ä¼°è®¡"><a href="#3-4-æ¢¯åº¦ä¼°è®¡" class="headerlink" title="3.4 æ¢¯åº¦ä¼°è®¡"></a>3.4 æ¢¯åº¦ä¼°è®¡</h2><p>é™¤äº†è°ƒæ•´å­¦ä¹ ç‡ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è¿›è¡Œæ¢¯åº¦ä¼°è®¡çš„ä¿®æ­£ã€‚è¿™æ ·åšçš„åŸå› æ˜¯ï¼Œå°æ‰¹é‡æ¢¯åº¦ä¸‹é™é€‰å–çš„æ ·æœ¬å…·æœ‰éšæœºæ€§ï¼Œå¦‚æœæ¯æ¬¡é€‰å–çš„æ ·æœ¬æ•°é‡æ¯”è¾ƒå°ï¼Œåˆ™æŸå¤±å¯èƒ½ä¼šå‘ˆç°éœ‡è¡çš„æ–¹å¼ä¸‹é™ã€‚ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥é‡‡å–ä½¿ç”¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…çš„å¹³å‡æ¢¯åº¦æ¥ä»£æ›¿å½“å‰æ—¶åˆ»çš„éšæœºæ¢¯åº¦çš„åšæ³•æ¥ç¼“è§£éšæœºæ€§ï¼Œæå‡ä¼˜åŒ–é€Ÿåº¦ã€‚</p><h3 id="3-4-1-åŠ¨é‡æ³•"><a href="#3-4-1-åŠ¨é‡æ³•" class="headerlink" title="3.4.1 åŠ¨é‡æ³•"></a>3.4.1 åŠ¨é‡æ³•</h3><p>è¿˜è®°å¾—ä¹‹å‰æˆ‘ä»¬è¯´è¿‡çš„ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜è§£å—ï¼Ÿæˆ‘ä»¬å°†æ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–è¿‡ç¨‹æ¯”å–»æˆå°çƒæ»šè½å±±å¡çš„è¿‡ç¨‹ã€‚ä½†æ˜¯æ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–è¿‡ç¨‹å¿½ç•¥äº†å°çƒæœ¬èº«å…·æœ‰åŠ¨é‡ï¼Œä¸ç°å®ä¸­æœ‰ä¸€å®šåŒºåˆ«ã€‚å¦‚æœæˆ‘ä»¬å°†æ¢¯åº¦ä¸‹é™ç®—æ³•æ·»åŠ ä¸ŠåŠ¨é‡çš„æ¨¡æ‹Ÿï¼Œåˆ™å°çƒåœ¨é™·å…¥å±€éƒ¨æœ€ä¼˜è§£æ—¶ï¼Œè¶³å¤Ÿé«˜çš„åŠ¨é‡èƒ½å¸®åŠ©å°çƒâ€œå†²â€å‡ºå±€éƒ¨æœ€ä¼˜è§£ã€‚</p><p><img src="/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/æ¢¯åº¦ä¸‹é™ç®—æ³•å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜.png" alt></p><p>åœ¨ç¬¬tæ¬¡è¿­ä»£æ˜¯ï¼Œè®¡ç®—è´Ÿæ¢¯åº¦çš„â€œåŠ æƒç§»åŠ¨å¹³å‡â€ä½œä¸ºå‚æ•°çš„æ›´æ–°æ–¹å‘ï¼š</p><script type="math/tex; mode=display">\Delta\theta_t=\rho\Delta\theta_{t-1}-\alpha\textbf{g}_t=-\alpha\sum^t_{\tau=1}\rho^{t-\tau}\textbf{g}_{\tau}</script><p>å…¶ä¸­$\rho$ä¸ºåŠ¨é‡å› å­ï¼Œä¸€èˆ¬ä¸º0.9ï¼Œ$\alpha$ä¸ºå­¦ä¹ ç‡ã€‚</p><p>è¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸ªå‚æ•°çš„å®é™…æ›´æ–°å·®å€¼å–å†³äºæœ€è¿‘ä¸€æ®µæ—¶é—´å†…æ¢¯åº¦çš„åŠ æƒå¹³å‡å€¼ã€‚å½“æŸä¸ªå‚æ•°åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…çš„æ¢¯åº¦æ–¹å‘éƒ½ä¸€è‡´ï¼Œå…¶çœŸæ˜¯æ›´æ–°å‚æ•°çš„å¹…åº¦ä¼šå˜å¤§ï¼Œç›¸å½“äºåŠ é€Ÿå†²åˆºï¼›å½“æŸä¸ªå‚æ•°åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…çš„æ¢¯åº¦æ–¹å‘ä¸ä¸€è‡´ï¼Œåˆ™å‚æ•°æ›´æ–°å¹…åº¦ä¼šå˜å°ï¼Œç›¸å½“äºåˆ¹è½¦ã€‚ä»æŸç§è§’åº¦æ¥è¯´ï¼Œå½“å‰æ¢¯åº¦å åŠ éƒ¨åˆ†ä¸Šæ¬¡çš„æ¢¯åº¦ï¼Œè¿™ç§åšæ³•å¯ä»¥è¿‘ä¼¼çœ‹åšäºŒé˜¶æ¢¯åº¦ã€‚</p><h3 id="3-4-3-Adam-ç®—æ³•"><a href="#3-4-3-Adam-ç®—æ³•" class="headerlink" title="3.4.3 Adam ç®—æ³•"></a>3.4.3 Adam ç®—æ³•</h3><p>Adamç®—æ³•æ˜¯å¦‚ä»Šæœ€å¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•äº†ï¼Œå®ƒæ˜¯RMSPropç®—æ³•å’ŒåŠ¨é‡æ³•çš„ç»“åˆï¼Œä¸ä½†ä½¿ç”¨åŠ¨é‡ä½œä¸ºå‚æ•°æ›´æ–°æ–¹å‘ï¼Œè€Œä¸”å¯ä»¥è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡ã€‚</p><h2 id="3-3-æ•°æ®é¢„å¤„ç†"><a href="#3-3-æ•°æ®é¢„å¤„ç†" class="headerlink" title="3.3 æ•°æ®é¢„å¤„ç†"></a>3.3 æ•°æ®é¢„å¤„ç†</h2><p>ä¸€èˆ¬è€Œè¨€ï¼Œæ ·æœ¬ç‰¹å¾ç”±äºæ¥æºä»¥åŠåº¦é‡å•ä½ä¸åŒï¼Œä»–ä»¬çš„å°ºåº¦ (Scale) å³å–å€¼èŒƒå›´ä¹Ÿä¸åŒã€‚å¯¹äºæŸäº›æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä¼šå¯¹é‚£äº›å°ºåº¦æ›´å¤§çš„æ•°æ®æ›´æ•æ„Ÿã€‚å› æ­¤å¯¹äºå°ºåº¦æ•æ„Ÿçš„æ¨¡å‹ï¼Œå¿…é¡»å…ˆå¯¹æ ·æœ¬è¿›è¡Œé¢„å¤„ç†ï¼Œå°†å„ä¸ªç»´åº¦çš„ç‰¹å¾è½¬æ¢åˆ°ç›¸åŒçš„å–å€¼åŒºé—´å†…ï¼Œå¹¶ä¸”æ¶ˆé™¤ä¸åŒç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œæ‰èƒ½å–å¾—ç†æƒ³çš„æ•ˆæœã€‚</p><p>å½’ä¸€åŒ– (Normalization) æ–¹æ³•æ³›æŒ‡æŠŠæ•°æ®ç‰¹å¾è½¬æ¢ä¸ºç›¸åŒå°ºåº¦çš„æ–¹æ³•ï¼Œæ¯”å¦‚æŠŠæ•°æ®ç‰¹å¾æ˜ å°„åˆ° [0,1] åŒºé—´å†…ï¼Œæˆ–è€…ç›´æ¥æ˜ å°„ä¸ºå‡å€¼ä¸º0ã€æ–¹å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒã€‚</p><p><strong>æœ€å°æœ€å¤§å€¼å½’ä¸€åŒ–</strong>ï¼šå°†æ¯ä¸ªç‰¹å¾ç¼©æ”¾åˆ° [0,1] æˆ–è€… [-1,1] ä¹‹é—´ã€‚å‡è®¾æˆ‘ä»¬æœ‰ N å“¥æ ·æœ¬ ${x^{(n)}}^{N}_{n=1}$ï¼Œå¯¹æ¯ä¸€ç»´ç‰¹å¾xï¼Œå½’ä¸€åŒ–åçš„ç‰¹å¾ä¸ºï¼š</p><script type="math/tex; mode=display">\hat{x}^{(n)}=\frac{x^{(n)}-\min_n(x^{(n)})}{\max_n(x^{(n)})-\min_n(x^{(n)})}</script><p><strong>æ ‡å‡†åŒ–</strong>ï¼šå°†æ¯ç»´ç‰¹å¾éƒ½è°ƒæ•´åˆ°æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼š</p><script type="math/tex; mode=display">\hat{x}^{(n)}=\frac{x^{(n)}-\mu}{\sigma}</script><h2 id="3-4-æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å±€é™æ€§"><a href="#3-4-æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å±€é™æ€§" class="headerlink" title="3.4 æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å±€é™æ€§"></a>3.4 æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å±€é™æ€§</h2><p>ä¸Šä¸€ç¯‡ç¬”è®°å·²ç»æœ‰æåˆ°è¯¥éƒ¨åˆ†å†…å®¹ï¼š</p><p>é¦–å…ˆï¼Œ<strong>æ¢¯åº¦ä¸‹é™ç®—æ³•å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼Œæ‰¾ä¸åˆ°å…¨å±€æœ€ä¼˜è§£</strong>ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå½“æ¢¯åº¦ä¸‹é™ç®—æ³•ä¼˜åŒ–åˆ°local minima æ—¶ï¼Œå‰é¢æœ‰åº§é«˜å±±ï¼Œå®ƒçš„æ¢¯åº¦æ˜¯æ­£çš„ï¼Œä¼˜åŒ–ç®—æ³•ä¼šå¼ºè¿«æˆ‘ä»¬å¾€å›èµ°ã€‚</p><p><img src="/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/æ¢¯åº¦ä¸‹é™ç®—æ³•å±€éƒ¨æœ€ä¼˜.png" alt></p><p><img src="/2022/10/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-Note2/æ¢¯åº¦ä¸‹é™å±€éƒ¨æœ€ä¼˜2.png" alt></p><p>è¿™ä¸ªé—®é¢˜åœ¨æˆ‘ä»¬çš„çº¿æ€§å›å½’æ¨¡å‹é‡Œæš‚æ—¶é‡ä¸åˆ°ï¼Œå› ä¸ºçº¿æ€§æ¨¡å‹éå¸¸ç®€å•ï¼Œæ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ã€‚ä½†å½“æˆ‘ä»¬è¯•å›¾åˆ©ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•è®­ç»ƒå¤æ‚æ¨¡å‹ï¼Œæ¯”å¦‚ç¥ç»ç½‘ç»œæ—¶ï¼Œå°±å¾ˆæœ‰å¯èƒ½é­é‡è¯¥é—®é¢˜ã€‚</p><p>æœ‰å¾ˆå¤šæ–¹æ³•èƒ½å¤Ÿè§£å†³æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å…¨å±€æœ€ä¼˜è§£é—®é¢˜ï¼ŒåŒ…æ‹¬è°ƒæ•´æ¯æ¬¡è¡Œè¿›çš„æ­¥é•¿$\eta$ï¼Œä½¿å…¶æ›´æœ‰å¸Œæœ›è·¨è¶Šâ€œå¤§å±±â€ç­‰æ‰‹æ®µç­‰ç­‰ã€‚</p><p>å…¶æ¬¡ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•è¦æ±‚ç›®æ ‡å‡½æ•°æ˜¯å¯å¾®çš„ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹ä¼š<strong>äº§ç”Ÿç›¸å½“å¤§çš„è®¡ç®—ä»£ä»·</strong>ã€‚å‡è®¾æˆ‘ä»¬çš„é—®é¢˜æœ‰ä¸Šç™¾ä¸‡ç»´ï¼Œè®¡ç®—äºŒé˜¶åå¯¼æ•°å°±éœ€è¦ä¸Šä¸‡äº¿ï¼ˆç™¾ä¸‡çš„å¹³æ–¹ï¼‰æ¬¡ï¼</p><p>å†æ¬¡ï¼Œ<strong>å½“è®­ç»ƒæ•°æ®ç›¸å½“å¤šæ—¶ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•ä¼šå˜å¾—å¾ˆæ…¢</strong>ã€‚åœ¨å®è·µä¸­ï¼Œä¸ºäº†è®¡ç®—æ¢¯åº¦$\nabla L$ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºäº†æ¯ä¸ªè®­ç»ƒæ ·æœ¬xå•ç‹¬è®¡ç®—æ¢¯åº¦$\nabla L_x$ï¼Œç„¶åæ±‚å¹³å‡å€¼ã€‚è¿™ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šåå·®å’Œæ–¹å·®ã€æ¨¡å‹é€‰æ‹©ã€æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚&lt;br&gt;&lt;!--more---&gt;&lt;/p&gt;
&lt;h1 id=&quot;ä¸€ã€è¯¯å·®çš„æ¥æºï¼šåå·®ä¸æ–¹å·®&quot;&gt;&lt;a href=&quot;#ä¸€ã€è¯¯å·®çš„æ¥æºï¼šåå·®ä¸æ–¹å·®&quot; class=&quot;headerlink&quot;</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="MOOC" scheme="https://superlova.github.io/tags/MOOC/"/>
    
    <category term="Gradient Descent" scheme="https://superlova.github.io/tags/Gradient-Descent/"/>
    
    <category term="Bias and Variance" scheme="https://superlova.github.io/tags/Bias-and-Variance/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æå®æ¯…2019MLè¯¾ç¨‹-Note1</title>
    <link href="https://superlova.github.io/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/"/>
    <id>https://superlova.github.io/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/</id>
    <published>2022-10-10T12:57:00.000Z</published>
    <updated>2022-10-12T13:44:37.134Z</updated>
    
    <content type="html"><![CDATA[<p>æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šæœºå™¨å­¦ä¹ çš„æ¦‚å¿µå’Œåˆ†ç±»ã€åˆ©ç”¨çº¿æ€§æ¨¡å‹è§£å†³å›å½’é—®é¢˜ä»¥åŠæ¢¯åº¦ä¸‹é™ã€‚<br><!--more---></p><h3 id="ä¸€ã€æœºå™¨å­¦ä¹ ä»‹ç»"><a href="#ä¸€ã€æœºå™¨å­¦ä¹ ä»‹ç»" class="headerlink" title="ä¸€ã€æœºå™¨å­¦ä¹ ä»‹ç»"></a>ä¸€ã€<a href="https://www.bilibili.com/video/av59538266">æœºå™¨å­¦ä¹ ä»‹ç»</a></h3><p>è¯´ä¸€ä¸‹æˆ‘å­¦è¿™é—¨è¯¾çš„åˆè¡·å§ã€‚å…¶å®æœºå™¨å­¦ä¹ çš„è¯¾ç¨‹åœ¨ç ”ç©¶ç”Ÿé˜¶æ®µå°±å·²ç»ä¸Šè¿‡äº†ï¼Œä½†æ˜¯å·¥ä½œä¹‹åæ‰å‘ç°æœ‰ä¸€äº›åŸºç¡€æ²¡ææ‡‚æˆ–è€…å·²ç»é—å¿˜ï¼Œå› æ­¤åœ¨å­¦ä¹ æ–°çŸ¥è¯†æ—¶å­˜åœ¨éšœç¢ã€‚æ°é€¢Datawhaleç»™äº†è¿™æ¬¡ç»„é˜Ÿå­¦ä¹ çš„æœºä¼šï¼Œæˆ‘ä¾¿æƒ³ä¸ç¾¤å‹ä»¬ä¸€èµ·æŠŠè¿™é—¨åŸºç¡€è¯¾ç¨‹æå®šã€‚</p><h4 id="1-æ¦‚è¦"><a href="#1-æ¦‚è¦" class="headerlink" title="1. æ¦‚è¦"></a>1. æ¦‚è¦</h4><p>æœ¬èŠ‚é€šä¿—æ˜“æ‡‚åœ°ä»‹ç»äº†æœºå™¨å­¦ä¹ çš„æ¦‚å¿µï¼Œä»‹ç»äº†AIçš„å‘å±•å†å²ï¼Œä»¥åŠä¸ä¼ ç»Ÿè§„åˆ™çš„åŒºåˆ«ã€‚ç®€å•æ¥è¯´ï¼Œ<strong>æœºå™¨å­¦ä¹ </strong>æ˜¯ä¸€ç§ä»æœ‰é™æ•°æ®ä¸­å­¦ä¹ è§„å¾‹å¹¶å¯¹æœªçŸ¥æ•°æ®è¿›è¡Œé¢„æµ‹çš„æ–¹æ³•ã€‚</p><p>åˆšå¼€å§‹è®²äº†æ¯”è¾ƒå¤šçš„åè¯å’Œæ¦‚å¿µã€‚è€å¸ˆæœ€åçš„å›¾é‡Œå¾ˆå¥½åœ°æ€»ç»“äº†æœ¬æ¬¡è¯¾çš„å†…å®¹ï¼š</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/æœºå™¨å­¦ä¹ ä»‹ç»01.png" alt></p><h4 id="é¦–å…ˆï¼Œæœºå™¨å­¦ä¹ çš„è¿‡ç¨‹åˆ†æˆä¸‰ä¸ªæ­¥éª¤ï¼š"><a href="#é¦–å…ˆï¼Œæœºå™¨å­¦ä¹ çš„è¿‡ç¨‹åˆ†æˆä¸‰ä¸ªæ­¥éª¤ï¼š" class="headerlink" title="é¦–å…ˆï¼Œæœºå™¨å­¦ä¹ çš„è¿‡ç¨‹åˆ†æˆä¸‰ä¸ªæ­¥éª¤ï¼š"></a>é¦–å…ˆï¼Œæœºå™¨å­¦ä¹ çš„è¿‡ç¨‹åˆ†æˆä¸‰ä¸ªæ­¥éª¤ï¼š</h4><ol><li>æ ¹æ®é—®é¢˜çš„ä¸åŒï¼Œé€‰æ‹©æ¨¡å‹ï¼ˆfunctionï¼‰ï¼›</li><li>æ ¹æ®æ¨¡å‹çš„ä¸åŒï¼Œå®šä¹‰èƒ½å¤Ÿåº¦é‡å­¦ä¹ æ•ˆæœçš„æŸå¤±å‡½æ•°ï¼›</li><li>ä»æœ‰é™æ•°æ®ä¸­æŒç»­è®­ç»ƒæ¨¡å‹ï¼Œä½¿å¾—æŸå¤±å‡½æ•°æœ€å°ã€‚</li></ol><h4 id="å…¶æ¬¡ï¼Œæ ¹æ®å­¦ä¹ æ‰€éœ€çš„æ•°æ®æ˜¯å¦å­˜åœ¨æ ‡ç­¾ï¼Œæœºå™¨å­¦ä¹ å¯ä»¥åˆ†æˆå¦‚ä¸‹å‡ ç±»ï¼ˆå›¾ä¸­è“è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š"><a href="#å…¶æ¬¡ï¼Œæ ¹æ®å­¦ä¹ æ‰€éœ€çš„æ•°æ®æ˜¯å¦å­˜åœ¨æ ‡ç­¾ï¼Œæœºå™¨å­¦ä¹ å¯ä»¥åˆ†æˆå¦‚ä¸‹å‡ ç±»ï¼ˆå›¾ä¸­è“è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š" class="headerlink" title="å…¶æ¬¡ï¼Œæ ¹æ®å­¦ä¹ æ‰€éœ€çš„æ•°æ®æ˜¯å¦å­˜åœ¨æ ‡ç­¾ï¼Œæœºå™¨å­¦ä¹ å¯ä»¥åˆ†æˆå¦‚ä¸‹å‡ ç±»ï¼ˆå›¾ä¸­è“è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š"></a>å…¶æ¬¡ï¼Œæ ¹æ®å­¦ä¹ æ‰€éœ€çš„æ•°æ®æ˜¯å¦å­˜åœ¨æ ‡ç­¾ï¼Œæœºå™¨å­¦ä¹ å¯ä»¥åˆ†æˆå¦‚ä¸‹å‡ ç±»ï¼ˆå›¾ä¸­è“è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š</h4><ol><li>ç›‘ç£å­¦ä¹ ï¼ŒæŒ‡å­¦ä¹ æ‰€éœ€çš„æ•°æ®æ˜¯ç»è¿‡äººå·¥æ ‡æ³¨çš„ï¼›</li><li>æ— ç›‘ç£å­¦ä¹ ï¼ŒæŒ‡å­¦ä¹ æ‰€éœ€çš„æ•°æ®ä¸éœ€äººå·¥æ ‡æ³¨ï¼›</li><li>å…¶ä»–å­¦ä¹ æ–¹æ³•ï¼Œæ¯”å¦‚åŠç›‘ç£å­¦ä¹ ã€è¿ç§»å­¦ä¹ ã€å¼ºåŒ–å­¦ä¹ ç­‰ã€‚</li></ol><h4 id="åœ¨ç›‘ç£å­¦ä¹ é‡Œï¼Œæ ¹æ®æƒ³è¦è§£å†³çš„é—®é¢˜ä¸åŒï¼Œå¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼ˆå›¾ä¸­é»„è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š"><a href="#åœ¨ç›‘ç£å­¦ä¹ é‡Œï¼Œæ ¹æ®æƒ³è¦è§£å†³çš„é—®é¢˜ä¸åŒï¼Œå¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼ˆå›¾ä¸­é»„è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š" class="headerlink" title="åœ¨ç›‘ç£å­¦ä¹ é‡Œï¼Œæ ¹æ®æƒ³è¦è§£å†³çš„é—®é¢˜ä¸åŒï¼Œå¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼ˆå›¾ä¸­é»„è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š"></a>åœ¨ç›‘ç£å­¦ä¹ é‡Œï¼Œæ ¹æ®æƒ³è¦è§£å†³çš„é—®é¢˜ä¸åŒï¼Œå¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼ˆå›¾ä¸­é»„è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š</h4><ol><li>åˆ†ç±»é—®é¢˜ï¼ŒæŒ‡æˆ‘ä»¬å¸Œæœ›æ¨¡å‹ç»™å‡ºyesæˆ–noè¿™æ ·å…·ä½“çš„è¯„ä»·ï¼›</li><li>å›å½’é—®é¢˜ï¼ŒæŒ‡æˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿç»™å‡ºä¸€ä¸ªæ•°å€¼ï¼Œè¿™ä¸ªæ•°å€¼çš„å¤§å°æœ‰ç°å®æ„ä¹‰ï¼›</li><li>ç»“æ„åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬å¸Œæœ›æ¨¡å‹ç›´æ¥è¾“å‡ºç»“æ„åŒ–ç»“æœï¼Œæ¯”å¦‚è¯­è¨€ç¿»è¯‘æ¨¡å‹èƒ½å¤Ÿäº§å‡ºä¸€æ®µæ–‡æœ¬ï¼Œdall-eèƒ½å¤Ÿç”Ÿæˆå›¾åƒï¼Œç­‰ç­‰ã€‚</li></ol><h4 id="åˆ†ç±»é—®é¢˜æ˜¯æ¯”è¾ƒç®€å•çš„é—®é¢˜ï¼Œæœ‰å¾ˆå¤šæ¨¡å‹å¯ä»¥è§£å†³åˆ†ç±»é—®é¢˜ï¼ˆå›¾ä¸­ç»¿è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š"><a href="#åˆ†ç±»é—®é¢˜æ˜¯æ¯”è¾ƒç®€å•çš„é—®é¢˜ï¼Œæœ‰å¾ˆå¤šæ¨¡å‹å¯ä»¥è§£å†³åˆ†ç±»é—®é¢˜ï¼ˆå›¾ä¸­ç»¿è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š" class="headerlink" title="åˆ†ç±»é—®é¢˜æ˜¯æ¯”è¾ƒç®€å•çš„é—®é¢˜ï¼Œæœ‰å¾ˆå¤šæ¨¡å‹å¯ä»¥è§£å†³åˆ†ç±»é—®é¢˜ï¼ˆå›¾ä¸­ç»¿è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š"></a>åˆ†ç±»é—®é¢˜æ˜¯æ¯”è¾ƒç®€å•çš„é—®é¢˜ï¼Œæœ‰å¾ˆå¤šæ¨¡å‹å¯ä»¥è§£å†³åˆ†ç±»é—®é¢˜ï¼ˆå›¾ä¸­ç»¿è‰²æ¡†æ¡†çš„éƒ¨åˆ†ï¼‰ï¼š</h4><ol><li>çº¿æ€§æ¨¡å‹ï¼›</li><li>éçº¿æ€§æ¨¡å‹ï¼Œæ¯”å¦‚æ·±åº¦å­¦ä¹ ã€SVMã€å†³ç­–æ ‘ç­‰æ–¹æ³•ã€‚</li></ol><p>åç»­æˆ‘ä»¬ä¼šå­¦åˆ°ä»€ä¹ˆæ˜¯çº¿æ€§æ¨¡å‹ã€ä»€ä¹ˆæ˜¯éçº¿æ€§æ¨¡å‹ï¼Œä»¥åŠä¸Šé¢çš„å…·ä½“æ¨¡å‹çš„è®¾è®¡ç»†èŠ‚ã€‚</p><h4 id="ä¸ºä»€ä¹ˆè¦å­¦ä¹ æœºå™¨å­¦ä¹ è¿™é—¨è¯¾ç¨‹ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦å­¦ä¹ æœºå™¨å­¦ä¹ è¿™é—¨è¯¾ç¨‹ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å­¦ä¹ æœºå™¨å­¦ä¹ è¿™é—¨è¯¾ç¨‹ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦å­¦ä¹ æœºå™¨å­¦ä¹ è¿™é—¨è¯¾ç¨‹ï¼Ÿ</h4><p><del>å½“ç„¶æ˜¯ä¸ºäº†æŒ£é’±äº†</del></p><p>ç”±äºç›®å‰è¿˜æ²¡æœ‰ä¸€ä¸ªæ™®é€‚çš„å­¦ä¹ æ¨¡å‹ï¼Œèƒ½å¤Ÿè§£å†³ä¸–ç•Œä¸€åˆ‡å¯ä»¥ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•è§£å†³çš„é—®é¢˜ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¾èµ–ç»éªŒå’ŒçŸ¥è¯†ï¼Œæ¥æ ¹æ®ä¸åŒçš„é—®é¢˜ï¼Œé€‰æ‹©ä¸åŒçš„å­¦ä¹ æ¨¡å‹å’Œå’ŒæŸå¤±å‡½æ•°ã€‚è¿˜è®°å¾—æœºå™¨å­¦ä¹ çš„ä¸‰ä¸ªæ­¥éª¤å—ï¼Ÿé€‰æ‹©æ¨¡å‹ã€å®šä¹‰æŸå¤±å‡½æ•°ã€è®­ç»ƒæ¨¡å‹è¿‡ç¨‹çš„çŸ¥è¯†ï¼Œéƒ½æ˜¯èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¾—åˆ°æ›´åŠ å¯é çš„æœºå™¨å­¦ä¹ ç³»ç»Ÿçš„æŠ€èƒ½ã€‚å­¦ä¹ è¿™é—¨è¯¾ç¨‹ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æˆä¸ºä¸€åæ›´å¥½çš„æœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆã€‚</p><h3 id="äºŒã€æœºå™¨å­¦ä¹ æ¡ˆä¾‹â€”â€”å›å½’é—®é¢˜"><a href="#äºŒã€æœºå™¨å­¦ä¹ æ¡ˆä¾‹â€”â€”å›å½’é—®é¢˜" class="headerlink" title="äºŒã€æœºå™¨å­¦ä¹ æ¡ˆä¾‹â€”â€”å›å½’é—®é¢˜"></a>äºŒã€<a href="https://www.bilibili.com/video/BV1Ht411g7Ef?p=3">æœºå™¨å­¦ä¹ æ¡ˆä¾‹â€”â€”å›å½’é—®é¢˜</a></h3><p>è¿™éƒ¨åˆ†ä»¥ä¸€ä¸ªå›å½’é—®é¢˜ä¸ºå¼•å­ï¼Œå¼•å¯¼æˆ‘ä»¬æ¢ç´¢æœºå™¨å­¦ä¹ çš„ä¸‰å¤§æ­¥éª¤ã€‚å›å½’é—®é¢˜æ¯”è¾ƒæ™®éï¼Œåƒè‚¡ç¥¨é¢„æµ‹ã€æ¸©åº¦é¢„æµ‹ã€æˆ¿ä»·é¢„æµ‹ç­‰ï¼Œéƒ½æ˜¯å›å½’é—®é¢˜ã€‚</p><p>æœºå™¨å­¦ä¹ çš„ä¸‰å¤§æ­¥éª¤åˆ†åˆ«ä¸ºï¼š</p><ol><li>æ ¹æ®é—®é¢˜çš„ä¸åŒï¼Œé€‰æ‹©æ¨¡å‹ï¼ˆfunctionï¼‰ï¼›</li><li>æ ¹æ®æ¨¡å‹çš„ä¸åŒï¼Œå®šä¹‰èƒ½å¤Ÿåº¦é‡å­¦ä¹ æ•ˆæœçš„æŸå¤±å‡½æ•°ï¼›</li><li>ä»æœ‰é™æ•°æ®ä¸­æŒç»­è®­ç»ƒæ¨¡å‹ï¼Œä½¿å¾—æŸå¤±å‡½æ•°æœ€å°ã€‚</li></ol><h4 id="ç¬¬ä¸€æ­¥ï¼Œä¸ºå›å½’é—®é¢˜é€‰æ‹©åˆé€‚çš„æ¨¡å‹"><a href="#ç¬¬ä¸€æ­¥ï¼Œä¸ºå›å½’é—®é¢˜é€‰æ‹©åˆé€‚çš„æ¨¡å‹" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼Œä¸ºå›å½’é—®é¢˜é€‰æ‹©åˆé€‚çš„æ¨¡å‹"></a>ç¬¬ä¸€æ­¥ï¼Œä¸ºå›å½’é—®é¢˜é€‰æ‹©åˆé€‚çš„æ¨¡å‹</h4><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çº¿æ€§æ¨¡å‹è¯•è¯•æ°´ã€‚æ‰€è°“<strong>çº¿æ€§æ¨¡å‹</strong> (Linear Model) æ˜¯æŠŠè¾“å…¥æ•°æ®çš„å„ç§ç‰¹å¾ï¼Œé€šè¿‡çº¿æ€§ç»„åˆçš„æ–¹å¼è¿›è¡Œé¢„æµ‹ã€‚</p><script type="math/tex; mode=display">y=b+\Sigma\omega_{i}x_{i}</script><p>å…¶ä¸­yæ˜¯é¢„æµ‹å€¼ï¼Œxæ˜¯ç‰¹å¾æœ¬èº«ï¼Œwæ˜¯ç‰¹å¾å¯¹åº”çš„å‚æ•°ã€‚æˆ‘ä»¬çš„å­¦ä¹ ç›®æ ‡å°±æ˜¯æ‰¾åˆ°æ­£ç¡®çš„wï¼Œä»¤é¢„æµ‹å€¼yå°½å¯èƒ½é è°±ã€‚</p><h4 id="ç¬¬äºŒæ­¥ï¼Œä¸ºçº¿æ€§æ¨¡å‹é€‰æ‹©åˆé€‚çš„è¯„ä¼°å‡½æ•°"><a href="#ç¬¬äºŒæ­¥ï¼Œä¸ºçº¿æ€§æ¨¡å‹é€‰æ‹©åˆé€‚çš„è¯„ä¼°å‡½æ•°" class="headerlink" title="ç¬¬äºŒæ­¥ï¼Œä¸ºçº¿æ€§æ¨¡å‹é€‰æ‹©åˆé€‚çš„è¯„ä¼°å‡½æ•°"></a>ç¬¬äºŒæ­¥ï¼Œä¸ºçº¿æ€§æ¨¡å‹é€‰æ‹©åˆé€‚çš„è¯„ä¼°å‡½æ•°</h4><p>çŸ¥é”™èƒ½æ”¹ï¼Œå–„è«å¤§ç„‰ã€‚æ¯å½“æ¨¡å‹é¢„æµ‹å¾—åˆ°ä¸€ä¸ªå€¼ï¼Œä¸ºäº†è®©æ¨¡å‹è®¤è¯†åˆ°è‡ªå·±çš„é¢„æµ‹å€¼yä¸çœŸå®å€¼$\hat{y}$çš„å·®è·ï¼Œæˆ‘ä»¬ä¸å¦¨ç›´æ¥å–äºŒè€…ä¹‹å·®ï¼Œä½œä¸ºè®¡ç®—å·®è·çš„<strong>æŸå¤±å‡½æ•°</strong> (Loss Function)ã€‚</p><script type="math/tex; mode=display">L(f)=\sum (y-\hat{y})</script><p>è¿™æ ·è‚¯å®šæ˜¯æœ‰é—®é¢˜çš„ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸¤ç»„æ•°æ®ï¼Œä¸€ç»„è¶…è¿‡çœŸå®å€¼0.5ï¼Œå¦ä¸€ç»„ä½äºé¢„æµ‹å€¼0.5ï¼Œå®ƒä»¬ä¸çœŸå®å€¼çš„å·®å€¼åˆ†åˆ«æ˜¯0.5ä¸-0.5ã€‚ç»“æœç»è¿‡æˆ‘ä»¬çš„è®¡ç®—ï¼ŒæŸå¤±å‡½æ•°å±…ç„¶ä¸º0ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æŸå¤±ï¼Ÿ</p><p>ä¸ºäº†é¿å…ä¸Šè¿°æƒ…å†µçš„å‡ºç°ï¼Œæˆ‘ä»¬é€‰æ‹©å¹³æ–¹æŸå¤±å‡½æ•°ä½œä¸ºè¡¡é‡å·®è·çš„æ‰‹æ®µï¼š</p><script type="math/tex; mode=display">L(f)=\sum (y-\hat{y})^2</script><p>å…¶å®ä¹Ÿæœ‰å…¶ä»–çš„æŸå¤±å‡½æ•°å®šä¹‰æ–¹æ³•å¯ä»¥è§„é¿ç¬¬ä¸€ä¸ªæŸå¤±å‡½æ•°çš„é—®é¢˜ï¼Œæ¯”å¦‚ä½¿ç”¨ç»å¯¹å€¼ã€‚ä½†è¿™é‡Œæˆ‘ä»¬å°±é’¦å®šå¹³æ–¹æŸå¤±å‡½æ•°äº†ï¼Œå®ƒæœ‰å¾ˆå¤šå¥½å¤„ï¼Œä½†æ˜¯æˆ‘ä»¬å…ˆæŒ‰ä¸‹ä¸è¡¨ã€‚</p><h4 id="ç¬¬ä¸‰æ­¥ï¼Œè¿›è¡Œè®­ç»ƒï¼Œå¹¶åˆ©ç”¨æŸå¤±å‡½æ•°æŒ‡å¯¼è®­ç»ƒè¿‡ç¨‹"><a href="#ç¬¬ä¸‰æ­¥ï¼Œè¿›è¡Œè®­ç»ƒï¼Œå¹¶åˆ©ç”¨æŸå¤±å‡½æ•°æŒ‡å¯¼è®­ç»ƒè¿‡ç¨‹" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼Œè¿›è¡Œè®­ç»ƒï¼Œå¹¶åˆ©ç”¨æŸå¤±å‡½æ•°æŒ‡å¯¼è®­ç»ƒè¿‡ç¨‹"></a>ç¬¬ä¸‰æ­¥ï¼Œè¿›è¡Œè®­ç»ƒï¼Œå¹¶åˆ©ç”¨æŸå¤±å‡½æ•°æŒ‡å¯¼è®­ç»ƒè¿‡ç¨‹</h4><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šå¸¦æ ‡ç­¾çš„æ•°æ® $(x,\hat{y})$ï¼Œæœ‰çº¿æ€§æ¨¡å‹ï¼Œæœ‰æŸå¤±å‡½æ•°ã€‚é‚£æˆ‘è¯¥æ€ä¹ˆå¾—åˆ°è®­ç»ƒå¥½çš„æ¨¡å‹å‘¢ï¼Ÿ</p><p><strong>æœ€å¥½çš„æ¨¡å‹</strong>åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå¯¹äºçº¿æ€§æ¨¡å‹æ¥è¯´ï¼Œå…¶å®æ±‚è§£æœ€ä¼˜çš„$w$å’Œ$b$ï¼Œä»è€Œå¯ä»¥è®©æˆ‘ä»¬çš„æ¨¡å‹æ— è®ºè¾“å…¥ä»€ä¹ˆ$x$ï¼Œéƒ½èƒ½å‡†ç¡®å¾—åˆ°ä¸çœŸå®å€¼ç›¸å·®æ— å‡ çš„$y$ã€‚</p><p>è®©æˆ‘ä»¬å¿˜æ‰wå’Œbçš„å…·ä½“å«ä¹‰ã€æ™¦æ¶©ä¸æ¸…çš„Lå‡½æ•°ï¼Œä¸“å¿ƒè§£å†³è¿™ä¸ªé—®é¢˜ï¼šå¦‚ä½•ä¼˜åŒ–$w$å’Œ$b$ï¼Œä»¥ä¾¿Lè¾¾åˆ°æœ€å°ï¼Ÿ</p><script type="math/tex; mode=display">w^*=arg\min_{w}L(w) \\b^*=arg\min_{b}L(b)</script><p>ä¸€ç§è§£å†³é—®é¢˜çš„æ–¹æ³•ä½¿ç”¨å¾®ç§¯åˆ†æ¥å—¯ç®—ï¼Œé€šè¿‡è®¡ç®—å¯¼æ•°å»å¯»æ‰¾Lçš„æå€¼ç‚¹ã€‚è¿æ°”å¥½çš„è¯ï¼ŒLçš„å˜é‡ä¸å¤šï¼Œè¯¥æ–¹æ³•çœ‹ä¼¼å¯è¡Œï¼›è¿æ°”ä¸å¥½çš„è¯ï¼Œæˆ‘ä»¬é¢å¯¹çš„é—®é¢˜è¿‡äºå¤æ‚ã€å‚æ•°è¿‡å¤šï¼Œé—®é¢˜å°±ä¸å¥½è§£å†³äº†ã€‚</p><p>è¿˜æœ‰ä¸€ç§ç¬¨åŠæ³•æ˜¯ç©·ä¸¾æ‰€æœ‰å¯èƒ½çš„$w$ï¼Œé€‰æ‹©èƒ½ä½¿Læœ€å°çš„$w^*$å³å¯ã€‚è¿™ç§æ–¹æ³•è™½ç„¶å¯è¡Œï¼Œä½†æ˜¯æ²¡æœ‰æ•ˆç‡ã€‚</p><p>æœ‰ä¸€ç§é€šç”¨çš„æœ€ä¼˜åŒ–æ–¹æ³•ï¼Œå«åš<strong>æ¢¯åº¦ä¸‹é™</strong> (Gradient Descent) æ–¹æ³•ï¼Œä¸“é—¨ç”¨äºè§£å†³è¿™ç§å‡¸ä¼˜åŒ–é—®é¢˜ã€‚ä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å‰ææ˜¯ä¼˜åŒ–ç›®æ ‡æ˜¯å¯å¾®çš„ã€‚</p><h5 id="1-æ¢¯åº¦ä¸‹é™ç®—æ³•ç®€ä»‹"><a href="#1-æ¢¯åº¦ä¸‹é™ç®—æ³•ç®€ä»‹" class="headerlink" title="1. æ¢¯åº¦ä¸‹é™ç®—æ³•ç®€ä»‹"></a>1. æ¢¯åº¦ä¸‹é™ç®—æ³•ç®€ä»‹</h5><p>æ°å¥½ï¼Œæˆ‘ä»¬çš„æŸå¤±å‡½æ•°Læ˜¯å¯å¾®çš„ï¼Œä¹Ÿå°±æ˜¯äºŒé˜¶å¯å¯¼çš„ã€‚å¦‚æœæˆ‘ä»¬å½“åˆé€‰å–æŸå¤±å‡½æ•°æ—¶ï¼Œä½¿ç”¨ç»å¯¹å€¼ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œå¤„ç†èµ·æ¥ä¾¿æ²¡æœ‰è¿™ä¹ˆä¾¿åˆ©äº†ã€‚</p><p>æ¢¯åº¦ä¸‹é™çš„å…·ä½“è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>é€‰æ‹©ä¸€ä¸ªåˆå§‹$w_0$</li><li>è®¡ç®—è¯¥ä½ç½®ä¸‹wå¯¹Lçš„å¾®åˆ†ï¼Œè¿™ä¸ªå¾®åˆ†å¯¹åº”å‡½æ•°åœ¨æ­¤å¤„ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼›</li><li>å°†$w_0$æœç€è¿™ä¸ªæ–¹å‘ç§»åŠ¨ä¸€å°æ­¥$ \eta$<script type="math/tex; mode=display">w\prime=w_0-\eta\frac{\mathrm{d}L}{\mathrm{d}w}</script></li><li>åœ¨æ–°çš„ä½ç½®å¼€å§‹æ–°ä¸€è½®è¿­ä»£è®¡ç®—ï¼Œç›´åˆ°$w$ä¸å†å˜åŒ–ä¸ºæ­¢ã€‚</li></ol><p>ä¸å¦¨å°†æ¢¯åº¦ä¸‹é™ç®—æ³•çš„æ±‚è§£è¿‡ç¨‹æƒ³è±¡ä¸ºäººä¸‹å±±çš„è¿‡ç¨‹ï¼Œäººä¼šå…ˆæ‰¾åˆ°ä¸‹å±±æœ€å¿«çš„æ–¹å‘ï¼Œç„¶åæœç€é‚£ä¸ªæ–¹å‘èµ°ä¸€æ­¥ï¼Œç›´åˆ°æŠµè¾¾æœ€ä½ç‚¹ã€‚</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/æ¨¡æ‹Ÿæ¢¯åº¦ä¸‹é™.png" alt></p><p>åœ¨ä¸Šå›¾ä¸­ï¼Œæ¯ä¸€æ¡çº¿å›´æˆçš„åœˆå°±æ˜¯ç­‰é«˜çº¿ï¼Œä»£è¡¨æŸå¤±å‡½æ•°çš„å€¼ï¼Œé¢œè‰²çº¦æ·±çš„åŒºåŸŸä»£è¡¨çš„æŸå¤±å‡½æ•°è¶Šå°ï¼›çº¢è‰²çš„ç®­å¤´ä»£è¡¨ç­‰é«˜çº¿çš„æ³•çº¿æ–¹å‘ã€‚</p><p>ä¸Šè¿°è¿‡ç¨‹æ˜¯æ±‚è§£Låœ¨å˜é‡wä¸‹çš„æœ€ä¼˜è§£çš„æ¢¯åº¦ä¸‹é™è¿‡ç¨‹ï¼Œä½†æ˜¯Lè¿˜ä¸åç§»é‡bå­˜åœ¨å¯¹åº”å…³ç³»ï¼Œæ‰€ä»¥å®é™…ä¸Šæ¢¯åº¦ä¸‹é™åœ¨çº¿æ€§æ¨¡å‹çš„å…·ä½“å…¬å¼å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">w_k\rightarrow w'_k=w_k-\eta\frac{\partial C}{\partial w_k} \\b_l\rightarrow b'_l=b_l-\eta\frac{\partial C}{\partial b_l}</script><p>å…¶ä¸­ï¼Œåå¾®åˆ†çš„å…·ä½“å…¬å¼å¦‚ä¸‹ï¼š</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/çº¿æ€§å›å½’åå¾®åˆ†æ–¹ç¨‹.png" alt></p><h5 id="2-æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å±€é™æ€§"><a href="#2-æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å±€é™æ€§" class="headerlink" title="2. æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å±€é™æ€§"></a>2. æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å±€é™æ€§</h5><p>é¦–å…ˆï¼Œ<strong>æ¢¯åº¦ä¸‹é™ç®—æ³•å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼Œæ‰¾ä¸åˆ°å…¨å±€æœ€ä¼˜è§£</strong>ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå½“æ¢¯åº¦ä¸‹é™ç®—æ³•ä¼˜åŒ–åˆ°local minima æ—¶ï¼Œå‰é¢æœ‰åº§é«˜å±±ï¼Œå®ƒçš„æ¢¯åº¦æ˜¯æ­£çš„ï¼Œä¼˜åŒ–ç®—æ³•ä¼šå¼ºè¿«æˆ‘ä»¬å¾€å›èµ°ã€‚</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/æ¢¯åº¦ä¸‹é™ç®—æ³•å±€éƒ¨æœ€ä¼˜.png" alt></p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/æ¢¯åº¦ä¸‹é™å±€éƒ¨æœ€ä¼˜2.png" alt></p><p>è¿™ä¸ªé—®é¢˜åœ¨æˆ‘ä»¬çš„çº¿æ€§å›å½’æ¨¡å‹é‡Œæš‚æ—¶é‡ä¸åˆ°ï¼Œå› ä¸ºçº¿æ€§æ¨¡å‹éå¸¸ç®€å•ï¼Œæ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ã€‚ä½†å½“æˆ‘ä»¬è¯•å›¾åˆ©ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•è®­ç»ƒå¤æ‚æ¨¡å‹ï¼Œæ¯”å¦‚ç¥ç»ç½‘ç»œæ—¶ï¼Œå°±å¾ˆæœ‰å¯èƒ½é­é‡è¯¥é—®é¢˜ã€‚</p><p>æœ‰å¾ˆå¤šæ–¹æ³•èƒ½å¤Ÿè§£å†³æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å…¨å±€æœ€ä¼˜è§£é—®é¢˜ï¼ŒåŒ…æ‹¬è°ƒæ•´æ¯æ¬¡è¡Œè¿›çš„æ­¥é•¿$\eta$ï¼Œä½¿å…¶æ›´æœ‰å¸Œæœ›è·¨è¶Šâ€œå¤§å±±â€ç­‰æ‰‹æ®µç­‰ç­‰ã€‚</p><p>å…¶æ¬¡ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•è¦æ±‚ç›®æ ‡å‡½æ•°æ˜¯å¯å¾®çš„ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹ä¼š<strong>äº§ç”Ÿç›¸å½“å¤§çš„è®¡ç®—ä»£ä»·</strong>ã€‚å‡è®¾æˆ‘ä»¬çš„é—®é¢˜æœ‰ä¸Šç™¾ä¸‡ç»´ï¼Œè®¡ç®—äºŒé˜¶åå¯¼æ•°å°±éœ€è¦ä¸Šä¸‡äº¿ï¼ˆç™¾ä¸‡çš„å¹³æ–¹ï¼‰æ¬¡ï¼</p><p>å†æ¬¡ï¼Œ<strong>å½“è®­ç»ƒæ•°æ®ç›¸å½“å¤šæ—¶ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•ä¼šå˜å¾—å¾ˆæ…¢</strong>ã€‚åœ¨å®è·µä¸­ï¼Œä¸ºäº†è®¡ç®—æ¢¯åº¦$\nabla L$ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºäº†æ¯ä¸ªè®­ç»ƒæ ·æœ¬xå•ç‹¬è®¡ç®—æ¢¯åº¦$\nabla L_x$ï¼Œç„¶åæ±‚å¹³å‡å€¼ã€‚è¿™ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ã€‚</p><h4 id="æ£€éªŒï¼šå¦‚ä½•æ£€éªŒæ¨¡å‹æ˜¯å¦è®­ç»ƒæˆåŠŸï¼Ÿæ›´åŠ å¤æ‚çš„æ¨¡å‹ä»¥åŠå¯¹åº”çš„é£é™©ã€‚"><a href="#æ£€éªŒï¼šå¦‚ä½•æ£€éªŒæ¨¡å‹æ˜¯å¦è®­ç»ƒæˆåŠŸï¼Ÿæ›´åŠ å¤æ‚çš„æ¨¡å‹ä»¥åŠå¯¹åº”çš„é£é™©ã€‚" class="headerlink" title="æ£€éªŒï¼šå¦‚ä½•æ£€éªŒæ¨¡å‹æ˜¯å¦è®­ç»ƒæˆåŠŸï¼Ÿæ›´åŠ å¤æ‚çš„æ¨¡å‹ä»¥åŠå¯¹åº”çš„é£é™©ã€‚"></a>æ£€éªŒï¼šå¦‚ä½•æ£€éªŒæ¨¡å‹æ˜¯å¦è®­ç»ƒæˆåŠŸï¼Ÿæ›´åŠ å¤æ‚çš„æ¨¡å‹ä»¥åŠå¯¹åº”çš„é£é™©ã€‚</h4><p>ç»è¿‡ä¸€è½®åˆä¸€è½®çš„ä¼˜åŒ–ï¼Œæˆ‘ä»¬ç»ˆäºæ±‚å¾—äº†è¯¥é—®é¢˜ä¸‹çº¿æ€§å›å½’æ¨¡å‹çš„æœ€ä¼˜å‚æ•°$w$å’Œ$b$ã€‚æ¥ä¸‹æ¥è¯¥å¦‚ä½•æ£€éªŒæ¨¡å‹åœ¨æœªçŸ¥æ•°æ®ä¸Šçš„æ³›åŒ–èƒ½åŠ›å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥åœ¨è®­ç»ƒä¹‹å‰ï¼ŒæŠŠæ•°æ®é›†åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†ç”¨ä½œåç»­çš„è®­ç»ƒï¼Œå¦ä¸€éƒ¨åˆ†ç”¨ä½œæœ€åçš„éªŒæ”¶ã€‚å¦‚æœåœ¨è¿™éƒ¨åˆ†æµ‹è¯•æ•°æ®ä¸Šçš„è¡¨ç°ä¸è®­ç»ƒè¿‡ç¨‹ä¸­çš„è¡¨ç°ä¸€è‡´ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥éªŒæ”¶ã€‚</p><p>è¿™ç§é€šè¿‡åˆ’åˆ†æ•°æ®é›†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ–¹æ³•ï¼Œä¸å…¶è¯´æ˜¯ä¸€ç§æŠ€æœ¯ç»†èŠ‚ï¼Œä¸å¦‚è¯´æ˜¯ä¸€ç§å·¥ç¨‹å®è·µä¸Šçš„ç»éªŒã€‚é€šè¿‡è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ€§èƒ½æ¯”è¾ƒï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ¨¡å‹å­˜åœ¨çš„æ½œåœ¨é—®é¢˜ï¼š</p><p><strong>1. è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šçš„è¡¨ç°éƒ½ä¸å¤ªé«˜ï¼›</strong></p><p>è¿™ç§æƒ…å†µæˆ‘ä»¬ç§°ä¹‹ä¸ºæ¬ æ‹Ÿåˆã€‚çº¿æ€§æ¨¡å‹ç”±äºè¿‡äºç®€å•ï¼Œå½“é¢å¯¹ä¸€äº›è¾ƒå¤æ‚çš„ç°å®é—®é¢˜æ—¶ï¼Œæ¬ æ‹Ÿåˆä¾¿å‡ºç°äº†ã€‚ä½ ä¼šå‘ç°æ— è®ºå¦‚ä½•è®­ç»ƒï¼Œæ— è®ºæŠ•å…¥å¤šå°‘æ•°æ®éƒ½å¾ˆéš¾æå‡æ¨¡å‹çš„æ€§èƒ½äº†ã€‚æˆ‘ä»¬éœ€è¦æ›´åŠ å¤æ‚çš„æ¨¡å‹ï¼Œç„¶åè¿›è¡Œä¸Šé¢æ‰€è¯´çš„æœºå™¨å­¦ä¹ ä¸‰ä¸ªæ­¥éª¤ï¼šé€‰æ‹©æ–°æ¨¡å‹ï¼Œé€‰æ‹©åˆé€‚çš„æŸå¤±å‡½æ•°ï¼Œé€‰æ‹©ä¼˜åŒ–æ–¹æ³•è¿›è¡Œè®­ç»ƒã€‚</p><p>å¯¹äºä¸€äº›ç°å®é—®é¢˜ï¼Œç±»ä¼¼$y=wx+b$è¿™ç§ä¸€æ¬¡æ¨¡å‹ç¡®å®è¿‡äºç®€å•äº†ã€‚æ¯”å¦‚é¢„æµ‹æˆ¿ä»·ï¼Œå¯èƒ½ä¸æˆ¿å±‹é¢ç§¯æœ‰å…³ï¼Œä¹Ÿå¯ä»¥ä¸æˆ¿å±‹é¢ç§¯çš„å¹³æ–¹æœ‰å…³ï¼Œç”šè‡³æ˜¯ä¸‰æ¬¡æ–¹ã€å››æ¬¡æ–¹ã€‚</p><p>è¯¾å ‚ä¸Šè€å¸ˆä¸¾äº†ä¸€ä¸ªä¾‹å­ï¼Œç”¨ä¸€æ¬¡å‡½æ•°æ¨¡å‹é¢„æµ‹å®å¯æ¢¦æ•°æ®é›†ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/å®å¯æ¢¦1.png" alt></p><p>æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„è¯¯å·®å¹³å‡å€¼ä¸º 35.0</p><p>å½“æˆ‘ä»¬ä½¿ç”¨æ›´å¤æ‚çš„2æ¬¡æ¨¡å‹æ—¶ï¼Œæ¨¡å‹æ€§èƒ½æœ‰æ˜æ˜¾å¥½è½¬ï¼š</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/å®å¯æ¢¦2.png" alt></p><p>æ¨¡å‹çš„å›¾åƒä»ä¸€æ¬¡å‡½æ•°å˜ä¸ºäºŒæ¬¡å‡½æ•°äº†ï¼Œæ›´å¥½æ‹Ÿåˆäº†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚æµ‹è¯•é›†å¹³å‡è¯¯å·®é™è‡³ 18.4 äº†ã€‚é‚£æ˜¯ä¸æ˜¯æ¨¡å‹è¶Šå¤æ‚ï¼Œæ€§èƒ½è¶Šå¥½å‘¢ï¼Ÿ</p><p><strong>2. è®­ç»ƒé›†ä¸Šçš„è¡¨ç°è‰¯å¥½ï¼Œæµ‹è¯•é›†ä¸Šçš„è¡¨ç°å¾ˆå·®</strong></p><p>å½“æˆ‘ä»¬æŒç»­ä¼˜åŒ–æ¨¡å‹å¤æ‚åº¦åˆ°3æ¬¡æ–¹å‡½æ•°ã€4æ¬¡æ–¹å‡½æ•°æ—¶ï¼Œæµ‹è¯•é›†å¹³å‡è¯¯å·®å¼€å§‹åœæ»ï¼Œ4æ¬¡æ–¹å‡½æ•°çš„å¹³å‡è¯¯å·®ä¸é™åå¢ï¼š</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/å®å¯æ¢¦3.png" alt></p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/å®å¯æ¢¦4.png" alt></p><p>è®­ç»ƒé›†å¹³å‡è¯¯å·®ã€15.4ã€‘ã€15.3ã€‘ã€14.9ã€‘ã€12.8ã€‘<br>æµ‹è¯•é›†å¹³å‡è¯¯å·®ã€18.4ã€‘ã€18.1ã€‘ã€28.8ã€‘ã€232.1ã€‘</p><p>è¿™ç§æƒ…å†µç§°ä¹‹ä¸ºè¿‡æ‹Ÿåˆã€‚æ‰€è°“â€œè¿‡çŠ¹ä¸åŠâ€ï¼Œé‚£æˆ‘ä»¬åº”è¯¥æ€æ ·é€‰æ‹©æ¨¡å‹çš„å¤æ‚åº¦ï¼Œé¿å…è¿‡æ‹Ÿåˆå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å°†æ¨¡å‹å¤æ‚åº¦ä¸æµ‹è¯•é›†æ€§èƒ½ä¹‹é—´çš„å…³ç³»ç»˜åˆ¶æˆå›¾åƒï¼Œé€šè¿‡å¯»æ‰¾å›¾åƒçš„â€œæ‹ç‚¹â€æ¥å†³å®šæ¨¡å‹çš„å¤æ‚åº¦ã€‚</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/å®å¯æ¢¦æ€§èƒ½å˜åŒ–.png" alt></p><h4 id="åæ€ï¼šæ”¹è¿›æ¨¡å‹æ€§èƒ½çš„å…¶ä»–æ–¹æ³•"><a href="#åæ€ï¼šæ”¹è¿›æ¨¡å‹æ€§èƒ½çš„å…¶ä»–æ–¹æ³•" class="headerlink" title="åæ€ï¼šæ”¹è¿›æ¨¡å‹æ€§èƒ½çš„å…¶ä»–æ–¹æ³•"></a>åæ€ï¼šæ”¹è¿›æ¨¡å‹æ€§èƒ½çš„å…¶ä»–æ–¹æ³•</h4><p>ä¸Šé¢çš„å®å¯æ¢¦CPå€¼é¢„æµ‹é—®é¢˜ï¼Œè€å¸ˆä¹‹åç»™å‡ºäº†æ›´å¤šçš„æ•°æ®ï¼Œç»˜åˆ¶åœ¨åæ ‡å›¾ä¸Šï¼š</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/å®å¯æ¢¦5.png" alt></p><p>å¾ˆæ˜¾ç„¶ï¼Œä»»ä½•æ›²çº¿çš„çº¿æ€§æ¨¡å‹éƒ½æ²¡åŠæ³•æ‹Ÿåˆè¿™ç§æ•°æ®ç‚¹ã€‚è¿™æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Ÿç­”æ¡ˆæ˜¯æˆ‘ä»¬å¿½ç•¥äº†æ•°æ®ç‚¹çš„å…¶ä»–ç‰¹å¾ã€‚å½“æˆ‘ä»¬å¼•å…¥å…¶ä»–ç‰¹å¾åˆ°æ¨¡å‹åï¼Œçº¿æ€§æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›å°±å¢å¼ºäº†ã€‚ä¸‹é¢å°±æ˜¯å¼•å…¥äº†å®å¯æ¢¦ç§ç±»çš„ç‰¹å¾ï¼š</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/å®å¯æ¢¦6.png" alt></p><p>ä½†æ˜¯å½“æˆ‘ä»¬ç»§ç»­å¼•å…¥ä¸€äº›æ— å…³ç‰¹å¾ï¼Œæ¯”å¦‚å®å¯æ¢¦çš„æ€§åˆ«ã€å¹´é¾„ç­‰ï¼Œè¿‡æ‹Ÿåˆç°è±¡å†æ¬¡å‡ºç°ï¼š</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/å®å¯æ¢¦7.png" alt></p><p>è¿™æ˜¯ç”±äºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒæŸäº›ç‰¹å¾çš„æƒé‡è¿‡å¤§å¯¼è‡´çš„ã€‚ä¸€ç§ç›´è§‚çš„è§£é‡Šæ˜¯ï¼Œæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¹Ÿä¼šå·æ‡’ï¼å¦‚æœæ•°æ®é‡ä¸è¶³ï¼Œæ¨¡å‹ä¼šè‡ªåŠ¨é€‰å–æŸå‡ ä¸ªå½±å“åŠ›å¤§çš„ç‰¹å¾ï¼Œèµ‹äºˆè¾ƒé«˜çš„æƒå€¼ï¼Œç„¶åå¿½ç•¥å…¶ä»–ç‰¹å¾ï¼Œé‚£äº›è¢«å¿½ç•¥çš„ç‰¹å¾ä¸­å¯èƒ½åŒ…å«æ›´åŠ æœ‰ç”¨çš„ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬å¸Œæœ›æœ€ç»ˆå¾—åˆ°çš„æ¨¡å‹ä¸è¦å‡ºç°å¤ªå¤§çš„æƒé‡ï¼Œä¸ºäº†é˜²æ­¢æŸäº›ç‰¹å¾çš„æƒå€¼è¿‡å¤§ï¼Œé™åˆ¶æƒé‡çš„å¢é•¿é€Ÿåº¦ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™åŒ–æ–¹æ³•ã€‚</p><p><img src="/2022/10/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9D%8E%E5%AE%8F%E6%AF%852019ML%E8%AF%BE%E7%A8%8B-P1/æ­£åˆ™åŒ–1.png" alt></p><p>æ”¹é€ åçš„æŸå¤±å‡½æ•°ï¼Œæœ«å°¾æ·»åŠ ä¸Šäº†ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼Œè¿™ä¸ªæ­£åˆ™åŒ–é¡¹çš„å¤§å°ä»…ä¸æ¨¡å‹çš„å‚æ•°å¤§å°æœ‰å…³ã€‚å‚æ•°è¶Šå¤§ï¼Œæ­£åˆ™åŒ–é¡¹è¶Šå¤§ã€‚æœ‰äº†æ­£åˆ™åŒ–é¡¹ï¼Œæ¨¡å‹åœ¨ä¼˜åŒ–è¿‡ç¨‹å°±ä¼šæ›´å€¾å‘äºé€‰æ‹©å‚æ•°å€¼æ›´å°çš„æ¨¡å‹äº†ã€‚</p><p>åœ¨å¾ˆå¤šåº”ç”¨åœºæ™¯ä¸­ï¼Œå¹¶ä¸æ˜¯ $w$ è¶Šå°æ¨¡å‹è¶Šå¹³æ»‘è¶Šå¥½ï¼Œä½†æ˜¯ç»éªŒå€¼å‘Šè¯‰æˆ‘ä»¬ $w$ è¶Šå°å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯å¥½çš„ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ol><li>æœºå™¨å­¦ä¹ çš„æ¦‚å¿µã€åˆ†ç±»å’Œä¸‰ä¸ªæ­¥éª¤ï¼šé€‰æ‹©æ¨¡å‹ã€é€‰æ‹©æŸå¤±å‡½æ•°ã€é€‰æ‹©ä¼˜åŒ–æ–¹æ³•ï¼›</li><li>æ ¹æ®ä¸‰ä¸ªæ­¥éª¤ï¼Œå®è·µè§£å†³å›å½’é—®é¢˜ï¼šä½¿ç”¨çº¿æ€§æ¨¡å‹ï¼Œè§£å†³å®å¯æ¢¦CPå€¼é¢„æµ‹é—®é¢˜ï¼›</li></ol><p>è¿™é‡Œçš„é‡ç‚¹æ˜¯æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œåé¢è¿˜ä¼šç»§ç»­å­¦ä¹ è¯¥ç®—æ³•ã€‚</p><ol><li>é€šè¿‡åˆ†æä¾‹å­çš„ä¼˜åŒ–ç‚¹ï¼Œå¼•å‡ºæ¨¡å‹å¸¸ç”¨çš„ä¼˜åŒ–æ–¹æ³•ä»¥åŠé£é™©ï¼šè¿‡æ‹Ÿåˆã€æ¬ æ‹Ÿåˆï¼Œä»¥åŠä»–ä»¬çš„è§£å†³æ–¹æ¡ˆã€‚</li></ol><p>è¿‡æ‹Ÿåˆé—®é¢˜çš„è§£å†³æ–¹æ³•æœ‰ï¼šé™ä½æ¨¡å‹å¤æ‚åº¦ã€å¢åŠ è®­ç»ƒæ ·æœ¬ã€å¢åŠ è®­ç»ƒæ ·æœ¬çš„ç‰¹å¾ã€æ·»åŠ æ­£åˆ™åŒ–é¡¹ç­‰ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æå®æ¯…è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ MOOCè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬ç¯‡è®°å½•çš„çŸ¥è¯†ç‚¹æœ‰ï¼šæœºå™¨å­¦ä¹ çš„æ¦‚å¿µå’Œåˆ†ç±»ã€åˆ©ç”¨çº¿æ€§æ¨¡å‹è§£å†³å›å½’é—®é¢˜ä»¥åŠæ¢¯åº¦ä¸‹é™ã€‚&lt;br&gt;&lt;!--more---&gt;&lt;/p&gt;
&lt;h3 id=&quot;ä¸€ã€æœºå™¨å­¦ä¹ ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä¸€ã€æœºå™¨å­¦ä¹ ä»‹ç»&quot; class=&quot;headerlin</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="MOOC" scheme="https://superlova.github.io/tags/MOOC/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æœºå™¨å­¦ä¹ ç¼–è¯‘â€”â€”Note2</title>
    <link href="https://superlova.github.io/2022/09/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%BC%96%E8%AF%91%E2%80%94%E2%80%94Note2/"/>
    <id>https://superlova.github.io/2022/09/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%BC%96%E8%AF%91%E2%80%94%E2%80%94Note2/</id>
    <published>2022-09-13T08:13:40.000Z</published>
    <updated>2022-09-14T06:48:32.068Z</updated>
    
    <content type="html"><![CDATA[<p>é™ˆå¤©å¥‡è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ ç¼–è¯‘ç›¸å…³çš„è¯¾ç¨‹ï¼Œæœ¬èŠ‚è¯¾è®¨è®ºå¼ é‡ç¨‹åºæŠ½è±¡ä»¥åŠç›¸å…³å®ç°ã€‚<br><!--more---></p><p>æœºå™¨å­¦ä¹ ç¼–è¯‘çš„è¿‡ç¨‹å¯ä»¥çœ‹åšæ˜¯å¯¹å¼ é‡å‡½æ•°çš„å˜æ¢è¿‡ç¨‹ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;é™ˆå¤©å¥‡è€å¸ˆä¸»è®²çš„æœºå™¨å­¦ä¹ ç¼–è¯‘ç›¸å…³çš„è¯¾ç¨‹ï¼Œæœ¬èŠ‚è¯¾è®¨è®ºå¼ é‡ç¨‹åºæŠ½è±¡ä»¥åŠç›¸å…³å®ç°ã€‚&lt;br&gt;&lt;!--more---&gt;&lt;/p&gt;
&lt;p&gt;æœºå™¨å­¦ä¹ ç¼–è¯‘çš„è¿‡ç¨‹å¯ä»¥çœ‹åšæ˜¯å¯¹å¼ é‡å‡½æ•°çš„å˜æ¢è¿‡ç¨‹ã€‚&lt;/p&gt;
</summary>
      
    
    
    
    <category term="notes" scheme="https://superlova.github.io/categories/notes/"/>
    
    
    <category term="Machine Learning" scheme="https://superlova.github.io/tags/Machine-Learning/"/>
    
    <category term="Compilation" scheme="https://superlova.github.io/tags/Compilation/"/>
    
  </entry>
  
</feed>
